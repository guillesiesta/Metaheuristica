define("modules/clean/browse/browse_bolt_client",["require","exports","modules/clean/ajax","modules/clean/bolt","modules/clean/react/browse/constants"],function(e,t,r,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(){function e(e){var t=this;this.startLiveUpdate=function(e){void 0===e&&(e=null),e&&(t.handleUpdate=e),t.updateBoltClient(),t.status=s.BrowseBoltClientStatus.Live},this.onBoltRefresh=function(){t.updateBoltClient(),t.status=s.BrowseBoltClientStatus.Live},this.onBoltUpdate=function(){t.handleUpdate&&t.handleUpdate()},this.updateBoltClient=function(){var e=t.boltData.map(function(e){return new o.SignedChannelState("sfj",e.bolt_unique_id,e.latest_sjid.toString(),e.bolt_token)});t.boltClient?t.boltClient.update_states(e):(t.boltClient=new o.BoltClient(e,t.onBoltUpdate,t.onBoltRefresh),t.boltClient.start())},this.userId=e,this.status=s.BrowseBoltClientStatus.NotReady,this.boltData=[]}return e.prototype.isReady=function(){return this.status!==s.BrowseBoltClientStatus.NotReady},e.prototype.setInitialBoltData=function(e){this.boltData=e,this.status=s.BrowseBoltClientStatus.NotLive},e.prototype.fetchInitialBoltData=function(e){var t=this;this.initialBoltDataRequest&&this.initialBoltDataRequest.abort(),this.initialBoltDataRequest=r.WebRequest({url:"/get_browse_bolt_data",dataType:"json",subject_user:this.userId,success:function(r,o,s){t.setInitialBoltData(r),e()},error:function(e,r,o){t.status=s.BrowseBoltClientStatus.NotReady},complete:function(){delete t.initialBoltDataRequest}})},e.prototype.handleUpdateBoltClient=function(e){this.boltData=e,this.updateBoltClient()},e.prototype.getNsMap=function(){var e={};return this.boltData.forEach(function(t){e[t.bolt_unique_id]=parseInt(t.latest_sjid,10)}),e},e.prototype.stopLiveUpdate=function(){this.status=s.BrowseBoltClientStatus.NotLive,this.boltClient&&this.boltClient.unsubscribe()},e})();t.BrowseBoltClient=a}),define("modules/clean/file_operations/notifications",["require","exports","external/lodash","modules/clean/browse_interface","modules/clean/em_string","modules/clean/filepath","modules/clean/react/browse/api","modules/clean/undo","modules/core/html","modules/core/i18n","modules/core/notify"],function(e,t,r,o,s,a,n,i,l,c,d){"use strict";function u(e,t,r,o,s){var a=function(){return n.rollbackChangeSets({changesets:r,userId:t.id,progressText:c._("Undoing…"),rollbackHints:o?o:void 0,onSuccess:function(){d.Notify.success(c._("Undo complete.")),s&&s()}})};i.notifyWithUndo(e,r,a)}function p(e,t){var n=o.browse_uri_for_fq_path(t,e),i=s.Emstring.em_snippet(a.filename(e),40);return{href:n,text:r.escape(i)}}function h(e,t,r,o,s,a){var n;if(o){var i=p(o,t);n=c.ungettext('Copied %(num_items)d item to <a href="%(dest_href)s">%(dest_name)s</a>.','Copied %(num_items)d items to <a href="%(dest_href)s">%(dest_name)s</a>.',e).format({num_items:e,dest_href:i.href,dest_name:i.text}),n=new l.HTML(n)}else n=c.ungettext("Copied %(num_items)d item.","Copied %(num_items)d items.",e).format({num_items:e});u(n,t,r,s,a)}function m(e,t,r,o,s,a){var n;if(o){var i=p(o,t);n=c.ungettext('Moved %(num_items)d item to <a href="%(dest_href)s">%(dest_name)s</a>.','Moved %(num_items)d items to <a href="%(dest_href)s">%(dest_name)s</a>.',e).format({num_items:e,dest_href:i.href,dest_name:i.text}),n=new l.HTML(n)}else n=c.ungettext("Moved %(num_items)d item.","Moved %(num_items)d items.",e).format({num_items:e});u(n,t,r,s,a)}function f(e,t,r,o,s){u(c.ungettext("Deleted %(num_items)d item.","Deleted %(num_items)d items.",e).format({num_items:e}),t,r,o,s)}function _(e,t,r,o){u(c._("Rename complete."),e,t,r,o)}function S(e,t,r){u(c._("Created folder %(folder_name)s.").format({folder_name:e}),t,r)}function g(e){var t=c.ungettext("Permanently deleted %(num)s item.","Permanently deleted %(num)s items.",e).format({num:e});d.Notify.success(t)}function w(e){var t,o=e.length;if(1===o){var s=r.escape(a.filename(e[0].fq_path));t=c._("Restored <strong>%(filename)s</strong>.").format({filename:s}),t=new l.HTML(t)}else t=c.ungettext("Restored %(num)s file.","Restored %(num)s files.",o).format({num:o});d.Notify.success(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.notifyCopySuccess=h,t.notifyMoveSuccess=m,t.notifyDeleteSuccess=f,t.notifyRenameSuccess=_,t.notifyFolderCreationSuccess=S,t.notifyPurgeSuccess=g,t.notifyRestoreSuccess=w}),define("modules/clean/illustration_helper",["require","exports","modules/clean/static_urls"],function(e,t,r){"use strict";function o(e){return r.static_url("/static/images/empty_states/"+e+".png")}Object.defineProperty(t,"__esModule",{value:!0}),t.empty_state_url=o}),define("modules/clean/pagination_manager",["require","exports","tslib","modules/clean/ajax","modules/core/i18n","modules/core/notify"],function(e,t,r,o,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(e){this.hasMoreItems=e}return e.prototype.areAllItemsReady=function(){return!this.hasMoreItems},e.prototype.invalidateHasMore=function(){this.hasMoreItems=!0},e.prototype.addDataToAjax=function(e){},e})(),i=(function(){function e(e){this.ajaxURL=e.ajaxURL,this.newDataCallback=e.newDataAvailableCallback,this.autoFetching=!1,this.mode=e.mode,this.keyName=e.keyName,this.items={},this.pages=[],this.nextRequestVoucher=e.firstPage.next_request_voucher,this.userID=e.userID,this.fqPathPrefix=e.fqPathPrefix?"/"+e.fqPathPrefix:"",this.addPage(e.firstPage.items)}return e.prototype.areAllItemsReady=function(){return this.mode.areAllItemsReady()},e.prototype.addPage=function(e){for(var t=[],r=[],o=0,n=e;o<n.length;o++){var i=n[o],l=i[this.keyName];if(null==l)return void a.Notify.warning(s._("Invalid server response"));null==this.items[l]&&(this.items[l]=i,r.push(i),t.push(l))}this.pages.push(t),this.newDataCallback(this,r)},e.prototype.startAutoFetching=function(){this.autoFetching=!0,this.fetchNext()},e.prototype.stopAutoFetching=function(){this.autoFetching=!1},e.prototype.reSync=function(e){void 0===e&&(e=!1),e&&(this.nextRequestVoucher=null,this.items={},this.pages=[]);var t=this.autoFetching&&this.mode.areAllItemsReady();this.mode.invalidateHasMore(),t&&this.startAutoFetching()},e.prototype.fetchNext=function(){var e=this;if(!this.mode.areAllItemsReady()){var t={};this.nextRequestVoucher&&(t.voucher=this.nextRequestVoucher),this.mode.addDataToAjax(t),o.WebRequest({url:this.ajaxURL,data:t,subject_user:this.userID,success:function(t){var r=JSON.parse(t);e.nextRequestVoucher=r.next_request_voucher,e.mode.hasMoreItems=r.has_more_items,e.autoFetching&&e.fetchNext();for(var o=0,s=r.items;o<s.length;o++){var a=s[o];a.fq_path=e.fqPathPrefix+a.fq_path}e.addPage(r.items)},error:function(){a.Notify.error(s._("There was a problem completing this request."))}})}},e.prototype.loadedPageCount=function(){return this.pages.length},e.prototype.getLoadedPage=function(e){var t=this,r=this.pages[e];return null==r?null:r.map(function(e){return t.items[e]})},e.prototype.getLastLoadedPage=function(){return this.getLoadedPage(this.loadedPageCount()-1)},e})();t.BasePaginationManager=i;var l=(function(e){function t(t){return e.call(this,r.__assign({},t,{mode:new n(t.firstPage.has_more_items)}))||this}return r.__extends(t,e),t.create=function(e){return new t(e)},t})(i);t.PaginationManager=l}),define("modules/clean/react/async_folder_selector_modal",["require","exports"],function(e,t){"use strict";function r(t){e(["modules/clean/react/folder_selector_modal"],function(e){e.FolderSelectorModal.show(t)})}Object.defineProperty(t,"__esModule",{value:!0}),t.show=r}),define("modules/clean/react/browse/actions",["require","exports","tslib","external/lodash","modules/clean/browse_interface","modules/clean/downloads","modules/clean/file_operations/notifications","modules/clean/filepath","modules/clean/history","modules/clean/react/fileops_actions","modules/clean/react/async_file_modal_controller","modules/clean/react/browse/api","modules/clean/react/browse/constants","modules/clean/react/browse/dispatcher","modules/clean/react/browse/models","modules/clean/react/browse/nav_actions","modules/clean/react/browse/store","modules/constants/python","modules/core/browser","modules/core/html","modules/core/i18n","modules/core/notify","modules/clean/search/constants","modules/clean/react/file_viewer/async_controller","modules/clean/search/search_results/dispatcher","modules/clean/react/files_view/types","modules/clean/react/snackbar","modules/clean/user_education/user_education_client","modules/clean/sharing/browse_exports"],function(e,t,r,o,s,a,n,i,l,c,d,u,p,h,m,f,_,S,g,w,v,b,T,F,E,y,R,C,A){"use strict";function I(){return e("modules/clean/react/file_viewer/controller")}function P(){return e.defined("modules/clean/react/file_viewer/controller")}Object.defineProperty(t,"__esModule",{value:!0});var N=(function(){function e(e){var o=this;this.nameNewFolder=function(){h.BrowseDispatcher.dispatch({type:p.BrowseActionType.REQUEST_FOLDER_NAME})},this.createFolderPending=function(){h.BrowseDispatcher.dispatch({type:p.BrowseActionType.CREATE_FOLDER_PENDING})},this.cancelCreateFolder=function(){h.BrowseDispatcher.dispatch({type:p.BrowseActionType.CANCEL_CREATE_FOLDER}),window.setTimeout(function(){C.UEClient.sendEvent("CdmNewFolderModal","maybeFinished")},2500)},this.createFolderComplete=function(e){var t=e.folderName,r=e.user,o=e.changesets;h.BrowseDispatcher.dispatch({type:p.BrowseActionType.CREATE_FOLDER_COMPLETE}),n.notifyFolderCreationSuccess(t,r,o),window.setTimeout(function(){C.UEClient.sendEvent("CdmNewFolderModal","maybeFinished")},2500)},this.createFolder=function(e){var t=e.folderName,s=e.pathName,a=e.nsId,n=void 0===a?null:a,i=e.checkFSWs,l=_.getBrowseStore().user();o.createFolderPending(),o.dataApi.createNewFolder({pathName:s,folderName:t,nsId:n,checkFSWs:i,userId:l.id,onSuccess:function(s){var a=s.changesets,n=s.createdFolder,i=s.failureDetails;if(i){var c=function(){o.createFolder(r.__assign({},e,{checkFSWs:!1}))};d.showFileSystemWarningsModal({fsws:i,onFinalAccept:c,confirmText:v._("Create folder"),onAbortAction:o.cancelCreateFolder})}else o.createFolderComplete({user:l,folderName:t,changesets:a}),n&&o.selectRowsFromBoltClient([n])},onError:o.cancelCreateFolder})},this.doDeleteFilesWithModal=function(e){var t=e.files,r=e.expSubgrowthBizWebClientOQDelete,s=_.getBrowseStore(),a=s.user(),l=s.context();d.showDelete(a,t,l,i.filename(l.currentFQPath),function(){o.dataApi.deleteFiles({files:t,userId:a.id,onSuccess:function(e){var r=e.changesets,s=e.rollbackHints;n.notifyDeleteSuccess(t.length,a,r,s,function(){o.selectRowsFromBoltClient(t)})}})},r)},this.doPermanentDeleteWithModal=function(e){var r=e.files,s=_.getBrowseStore(),a=s.user();d.showPermanentlyDelete(a,r,function(){return o.dataApi.purgeFiles({files:r,userId:a.id,onSuccess:function(){n.notifyPurgeSuccess(r.length),t.browseActions.reloadCurrentPath()}})})},this.onRestore=function(e,t){o.dataApi.restoreFiles({files:t,userId:e,onSuccess:function(){n.notifyRestoreSuccess(t)}})},this.doRestoreFilesWithModal=function(e){var t=e.files,r=e.isSearchMode;if(e.expShouldShowUnifiedTrashModal&&!r)o.doRestoreFilesWithUnifiedTrashModal({files:t});else{var s=_.getBrowseStore(),a=s.user(),n=s.context();d.showRestore(a,t,n,o.onRestore)}},this.doRestoreFilesWithUnifiedTrashModal=function(e){var t=e.files,r=_.getBrowseStore(),s=r.user(),a=r.context();d.showUnifiedTrashModal({userId:s.id,context:a,files:t,onRestore:o.onRestore})},this.dataApi=e}return e.prototype.initializeEverything=function(e){var t=e.user,r=e.path,o=e.files,s=e.paginatedTotalNumFiles,a=e.urlPrefix,n=e.context,i=e.mountPoints,l=e.shouldShowDeletedFiles,c=e.fqPathsToSelect,d=e.loadingState,u=e.teamFolders;h.BrowseDispatcher.dispatch({type:p.BrowseActionType.INITIALIZE_EVERYTHING,data:{user:t,path:r,files:o,paginatedTotalNumFiles:s,urlPrefix:a,context:n,mountPoints:i,shouldShowDeletedFiles:l,fqPathsToSelect:c,loadingState:d,teamFolders:u}})},e.prototype.load=function(e){var t=e.path,r=e.files,o=e.paginatedTotalNumFiles,s=e.context;f.browseNavActions.load({path:t,files:r,paginatedTotalNumFiles:o,context:s})},e.prototype.add=function(e){var t=e.path,r=e.files,o=e.paginatedTotalNumFiles;f.browseNavActions.add({path:t,files:r,paginatedTotalNumFiles:o})},e.prototype.setLoadingState=function(e){var t=e.loadingState,r=e.path;f.browseNavActions.setLoadingState({loadingState:t,path:r})},e.prototype.addFilesAndSetLoadingState=function(e){var t=e.path,r=e.loadingState,o=e.files,s=e.paginatedTotalNumFiles;f.browseNavActions.addFilesAndSetLoadingState({path:t,loadingState:r,files:o,paginatedTotalNumFiles:s})},e.prototype.setMountPoints=function(e){var t=e.mountPoints;f.browseNavActions.setMountPoints({mountPoints:t})},e.prototype.setTeamFolders=function(e){var t=e.teamFolders;f.browseNavActions.setTeamFolders({teamFolders:t})},e.prototype.setPath=function(e){var t=e.path,r=e.sortLabel,o=e.sortIsAscending,s=e.onPathLoaded,a=e.nsId,n=e.logFetchedDataRequiredForTTI,i=void 0!==n&&n,l=e.ajaxWebTimer;f.browseNavActions.setPath({path:t,sortLabel:r,sortIsAscending:o,onPathLoaded:s,nsId:a,logFetchedDataRequiredForTTI:i,ajaxWebTimer:l})},e.prototype.reloadCurrentPath=function(){var e=_.getBrowseStore();this.setPath({path:e.path(),sortLabel:e.sortLabel(),sortIsAscending:e.sortIsAscending(),nsId:e.context().rootNSID})},e.prototype.setUser=function(e){var t=e.user;h.BrowseDispatcher.dispatch({type:p.BrowseActionType.SET_USER,data:{user:t}})},e.prototype.updatePreview=function(e){var t=e.files;P()&&I().updateFiles(t)},e.prototype.closeFileViewer=function(){P()&&I().close()},e.prototype.setUrlPrefix=function(e){var t=e.prefix;f.browseNavActions.setUrlPrefix({prefix:t})},e.prototype.setUrl=function(e){var t=e.path,r=e.qargs;f.browseNavActions.setUrl({path:t,qargs:r})},e.prototype.copyFilesToClipboard=function(e){if(e.length){if(e.some(function(e){return e.isDeleted}))return void b.Notify.error(v._("Deleted files cannot be added to the clipboard"));if(e.some(m.File.isTeamSharedFolder))return void b.Notify.error(v._("Team Folders can’t be copied."));var t=v.ungettext("Added %(num_items)s item to clipboard","Added %(num_items)s items to clipboard",e.length).format({num_items:e.length});b.Notify.success(t),h.BrowseDispatcher.dispatch({type:p.BrowseActionType.COPY_FILES_TO_CLIPBOARD,data:{files:e}})}},e.prototype.pasteClipboardFilesToCurrentPath=function(){c.copyFiles({user:_.getBrowseStore().user(),files:_.getBrowseStore().clipboardFiles(),newPath:_.getBrowseStore().path(),checkFSWs:!0,dataApi:this.dataApi})},e.prototype.selectRowsFromBoltClient=function(e){void 0===e&&(e=[]),this.setFilePathsToSelectOnNextUpdate({fqPathsToSelect:e.map(function(e){return e.fq_path})})},e.prototype.setFilePathsToSelectOnNextUpdate=function(e){var t=e.fqPathsToSelect;h.BrowseDispatcher.dispatch({type:p.BrowseActionType.SET_FILE_PATHS_TO_SELECT_ON_NEXT_UPDATE,data:{fqPathsToSelect:t}})},e.prototype.addFileJumpKeyCode=function(e){var t=e.keyChar;h.BrowseDispatcher.dispatch({type:p.BrowseActionType.ADD_FILE_JUMP_KEY_CODE,data:{keyChar:t}})},e.prototype.resetFileJump=function(){h.BrowseDispatcher.dispatch({type:p.BrowseActionType.RESET_FILE_JUMP})},e.prototype.copyFiles=function(e){c.copyFiles(e)},e.prototype.moveFiles=function(e){c.moveFiles(e)},e.prototype.showFileRename=function(e){var t=e.file;h.BrowseDispatcher.dispatch({type:p.BrowseActionType.REQUEST_NEW_FILE_NAME,data:{file:t}})},e.prototype.cancelFileRename=function(e){var t=e.file;h.BrowseDispatcher.dispatch({type:p.BrowseActionType.CANCEL_FILE_RENAME,data:{file:t}})},e.prototype.setFileRenameComplete=function(e){var t=e.file;h.BrowseDispatcher.dispatch({type:p.BrowseActionType.SET_FILE_RENAME_COMPLETE,data:{file:t}})},e.prototype.renameFile=function(e){var t=this,r=e.file,o=e.newName,s=e.isSearchMode;h.BrowseDispatcher.dispatch({type:p.BrowseActionType.SET_FILE_RENAME_PENDING,data:{file:r}});var a=_.getBrowseStore().user();this.dataApi.renameFile({file:r,newName:o,userId:a.id,onSuccess:function(e){var o=e.renamedFile,i=e.changesets,l=e.rollbackHints;n.notifyRenameSuccess(a,i,l,function(){t.selectRowsFromBoltClient([r])}),s&&E.SearchResultsDispatcher.dispatch({type:T.CHANGE_FILES_ACTION,data:{fileDeltas:[{before:r.fq_path,after:r.is_dir?o.set("icon",r.icon):o}]}}),t.selectRowsFromBoltClient([o])},onError:function(){t.cancelFileRename({file:r})}})},e.prototype.applyFileDeltas=function(e){var t=e.path,r=e.fileDeltas;h.BrowseDispatcher.dispatch({type:p.BrowseActionType.CHANGE_FILES,data:{path:t,fileDeltas:r}})},e.prototype.getMountPointUpdateForCurrentPath=function(e){var t,r,s=_.getBrowseStore().path(),a=_.getBrowseStore().mountPoints(),n=a?a.toJS():{},i=function(e){return e===s},l=parseInt(o.findKey(n,i),10);if(l)t=e[l]||null,r=n[l]||null;else{r=null;t=!!o.findKey(e,i)?s:null}return[r,t]},e.prototype.getPathForNewMountPoint=function(e,t){return e&&!t?_.getBrowseStore().path():e&&t?i.paths_are_equal(e,t)?null:t:!e&&t?_.getBrowseStore().path():null},e.prototype.showUserNotificationForPathChange=function(e,t){function r(e){return o.escape(i.filename(e))}function a(e){b.Notify.success(new w.HTML(e))}function n(e){b.Notify.error(new w.HTML(e))}var l=t.old_fq_path,c=s.get_browse_root(e)+t.new_fq_path,d=!t.is_changing_view,u=null!=t.change_type?t.change_type.toLowerCase():null;if("moved"===u)if(d)a(v._("This folder has been moved"));else{var p=v._('The folder ‘%(folder_name)s’ has been moved. <a href="%(href)s">View</a>').format({folder_name:r(l),href:o.escape(c)});n(p)}else if("renamed"===u)if(d){var p=v._("This folder has been renamed to ‘%(folder_name)s’").format({folder_name:r(t.change_to_fq_path)});a(p)}else{var p=v._('The folder ‘%(folder_name)s’ has been renamed. <a href="%(href)s">View</a>').format({folder_name:r(l),href:o.escape(c)});n(p)}else if("deleted"===u){var p=v._("The folder ‘%(folder_name)s’ has been deleted").format({folder_name:r(l)});n(p)}},e.prototype.computeAndApplyDeltasFromBoltClient=function(e){var t=e.path,r=e.payload,o=e.currentNSId,s=r.added,a=r.moved,n=r.removed,i=r.mount_points,l=r.parent_changes;if(l&&l.change_to_fq_path){var c=_.getBrowseStore().user();return this.showUserNotificationForPathChange(c,l),void this.setUrl({path:l.change_to_fq_path})}var d=this.getMountPointUpdateForCurrentPath(i),u=d[0],p=d[1];u&&!p&&b.Notify.success(v._("The folder was unshared."));var h=this.getPathForNewMountPoint(u,p);if(h)return void this.setPath({path:h,sortLabel:_.getBrowseStore().sortLabel(),sortIsAscending:_.getBrowseStore().sortIsAscending(),nsId:o});this.setMountPoints({mountPoints:i});for(var f=_.getBrowseStore().filesMap(),S=[],g=0,w=s;g<w.length;g++){var T=w[g],F=null,E=m.File.fromServerObject(T);S.push({before:F,after:E})}for(var y=0,R=a;y<R.length;y++){var C=R[y],A=C[0],T=C[1],F=f.get(A,null),E=m.File.fromServerObject(T);S.push({before:F,after:E})}for(var I=0,P=n;I<P.length;I++){var N=P[I],F=f.get(N,null),E=null;S.push({before:F,after:E})}this.applyFileDeltas({path:t,fileDeltas:S})},e.prototype.setSelection=function(e){var t=e.selection;h.BrowseDispatcher.dispatch({type:p.BrowseActionType.SET_SELECTION,data:{selection:t}})},e.prototype.selectFilesAfterUpload=function(e){var t=e.fqPathsToSelect;h.BrowseDispatcher.dispatch({type:p.BrowseActionType.SELECT_FILES_AFTER_UPLOAD,data:{fqPathsToSelect:t}})},e.prototype.selectFilesByFqPath=function(e){var t=e.fqPathsToSelect;h.BrowseDispatcher.dispatch({type:p.BrowseActionType.SELECT_FILES_BY_FQ_PATH,data:{fqPathsToSelect:t}})},e.prototype.setActiveTab=function(e){var t=e.tabName;h.BrowseDispatcher.dispatch({type:p.BrowseActionType.SET_ACTIVE_TAB,data:{tabName:t}})},e.prototype.navigateToFileOrFolder=function(e){var t=e.file,r=e.shouldFocusComment,o=void 0!==r&&r,s=e.onFileViewerUnmount,a=e.fileViewAction,n=void 0===a?S.FileViewActionType.CLICK:a,i=e.fileViewOrigin,l=void 0===i?S.FileViewOriginType.BROWSE:i,c=e.expShouldShowUnifiedTrashModal,u=void 0!==c&&c,h=_.getBrowseStore().user(),f=_.getBrowseStore().context();if(!f.isNonUserRelativeContext||t.is_dir)if(t.is_dir)m.File.isNoAccessSharedFolder(t)?d.showNoAccess(h,t,f):this.setUrl({path:t.fq_path});else{var w=_.getBrowseStore().getIndexOfFile(t),v=w<0?[t]:_.getBrowseStore().files().toArray();if(w<0&&(w=0),t.isDeleted)this.doRestoreFilesWithModal({files:[t],isSearchMode:n===S.FileViewActionType.SEARCH,expShouldShowUnifiedTrashModal:u});else if(t.is_cloud_doc&&t.preview_url)g.unsafe_open_tab(t.preview_url);else{var b=function(){F.showElementsBehindFileViewer(),s&&s()};F.asyncOpenPreview({containerId:p.BROWSE_FILE_VIEWER_ELEMENT_ID,files:v,indexOfPreviewFile:w,shouldFocusComment:o,user:h,onFileViewerDidMount:F.hideElementsBehindFileViewer,onFileViewerUnmount:b,fileViewAction:n,fileViewOrigin:l,fileViewTarget:S.FileViewTargetType.PRIVATE})}}},e.prototype.navigateToResultObjectParentFolder=function(e){var t=e.file,r=e.fileViewAction;void 0===r&&S.FileViewActionType.CLICK;if(m.File.isNoAccessSharedFolder(t))d.showNoAccess(_.getBrowseStore().user(),t,_.getBrowseStore().context());else{var o=i.parent_dir(t.fq_path);this.setUrl({path:o})}},e.prototype.navigateToParentFolder=function(){var e=i.parent_dir(_.getBrowseStore().path());this.setUrl({path:e})},e.prototype.setShouldShowDeletedFiles=function(e){var t=e.shouldShowDeletedFiles,r=e.shouldReloadFolder,o=void 0===r||r,s=e.shouldUpdateUrl,a=void 0===s||s,n=_.getBrowseStore();h.BrowseDispatcher.dispatch({type:p.BrowseActionType.SET_SHOULD_SHOW_DELETED_FILES,data:{shouldShowDeletedFiles:t}}),o&&(n.context().isNonUserRelativeContext?this.setPath({path:n.path(),sortLabel:n.sortLabel(),sortIsAscending:n.sortIsAscending(),nsId:n.context().rootNSID}):this.reloadCurrentPath()),a&&(t?l.update_query_param(p.BrowseQueryArg.d,"1"):l.remove_query_param(p.BrowseQueryArg.d))},e.prototype.sortFiles=function(e){var t=e.sortField,r=e.sortDirection;h.BrowseDispatcher.dispatch({type:p.BrowseActionType.SORT_FILES,data:{sortField:t,sortDirection:r}})},e.prototype.setViewType=function(e){var t=e.viewType;e.isSearchMode;h.BrowseDispatcher.dispatch({type:p.BrowseActionType.SET_VIEW_TYPE,data:{viewType:t}})},e.prototype.setColumnDependentCapabilities=function(e){var t=e.canDisplayFolderSizes;h.BrowseDispatcher.dispatch({type:p.BrowseActionType.SET_COLUMN_DEPENDENT_CAPABILITIES,data:{canDisplayFolderSizes:t}})},e.prototype.setColumnConfiguration=function(e){var t=e.columns,r=e.viewType,o=e.canDisplayFolderSizes;h.BrowseDispatcher.dispatch({type:p.BrowseActionType.SET_COLUMN_CONFIGURATION,data:{columns:t,viewType:r,canDisplayFolderSizes:o}})},e.prototype.setTilesPerRow=function(e){var t=e.tilesPerRow;h.BrowseDispatcher.dispatch({type:p.BrowseActionType.SET_TILES_PER_ROW,data:{tilesPerRow:t}})},e.prototype.downloadFiles=function(e){var t=e.files,r=e.context,o=e.user;if(1!==t.count()||t.first().is_dir){if(r.blockHash)if(r.isNonUserRelativeContext)a.zip_batch_by_ns_id({parent_ns_id:r.rootNSID,parent_ns_path:r.currentFQPath,files:t.toArray(),subject_uid:o.id,block_hash:r.blockHash});else{var s=r.currentFQPath,n=t.toArray().map(function(e){return e.fq_path});a.get_zip({fq_paths:n,subject_uid:o.id,block_hash:r.blockHash,parent_path:s})}}else if(r.isNonUserRelativeContext){var l=t.first(),c=l.direct_blockserver_link,d=r.rootNSID,u=i.filename(l.fq_path),p="/"===r.currentFQPath?"/"+u:r.currentFQPath+"/"+u;a.get_blockserver_link({url:c,ns_id:d,ns_path:p,inside_admin_console:!0})}else a.get_blockserver_link({url:t.first().direct_blockserver_link})},e.prototype.createCloudDoc=function(e){var t=e.pathName,r=e.title,o=e.documentType;R.Snackbar.sync(v._("Creating new Paper doc..."),!0);var s=_.getBrowseStore().user().id;this.dataApi.createCloudDoc({pathName:t,title:r,documentType:o,userId:s,onSuccess:function(e){var t=(e.changesets,e.createdFile);R.Snackbar.complete(v._("Paper doc created!")),g.redirect(t.preview_url)},onError:function(e){R.Snackbar.fail(e)}})},e.prototype.addCommentStatusBatch=function(e){var t=e.commentStatusByFqPath;h.BrowseDispatcher.dispatch({type:p.BrowseActionType.ADD_COMMENT_STATUS_BATCH,data:{commentStatusByFqPath:t}})},e.prototype.setDropTarget=function(e){var t=e.target;h.BrowseDispatcher.dispatch({type:p.BrowseActionType.SET_DROP_TARGET,data:{target:t}})},e.prototype.setDataApi=function(e){this.dataApi=e,f.browseNavActions.setDataApi(e)},e.prototype.fetchFolderSizes=function(e){var t=e.file;return r.__awaiter(this,void 0,void 0,function(){var e,o,s,a,n,i,l,c,d;return r.__generator(this,function(r){switch(r.label){case 0:e=_.getBrowseStore().user(),o=p.MAX_FOLDER_SIZE_ITERATIONS,r.label=1;case 1:return r.trys.push([1,7,,8]),h.BrowseDispatcher.dispatch({type:p.BrowseActionType.REQUEST_FETCH_FOLDER_SIZES,data:{fqPath:t.fq_path}}),[4,this.dataApi.fetchSharedFolderSizes(e.id,{fq_path:t.fq_path})];case 2:return s=r.sent(),h.BrowseDispatcher.dispatch({type:p.BrowseActionType.FETCHED_FOLDER_SIZES,data:{fqPath:t.fq_path,resp:s}}),a=[],[4,this.fetchAndSetSameNamespaceFolderSize(e.id,{fq_path:t.fq_path,folder_limit:p.MAX_FOLDERS_PER_CALL})];case 3:n=r.sent(),n.queue&&(a=a.concat(n.queue)),r.label=4;case 4:return a.length>0&&o>0?(o--,i=Math.min(p.MAX_FOLDER_SIZE_QUEUE_SIZE,a.length),l=a.splice(0,i),[4,this.fetchAndSetSameNamespaceFolderSize(e.id,{fq_path:t.fq_path,folder_limit:p.MAX_FOLDERS_PER_CALL,queue:l})]):[3,6];case 5:return n=r.sent(),n.queue&&a&&(a=a.concat(n.queue)),[3,4];case 6:return c=0!==o&&n.queue&&0===n.queue.length?y.FetchFolderSizeState.COMPLETE:y.FetchFolderSizeState.ERROR,h.BrowseDispatcher.dispatch({type:p.BrowseActionType.COMPLETE_FETCH_FOLDER_SIZES,data:{state:c}}),[3,8];case 7:return d=r.sent(),h.BrowseDispatcher.dispatch({type:p.BrowseActionType.COMPLETE_FETCH_FOLDER_SIZES,data:{state:y.FetchFolderSizeState.ERROR}}),[3,8];case 8:return[2]}})})},e.prototype.fetchAndSetSameNamespaceFolderSize=function(e,t){return r.__awaiter(this,void 0,void 0,function(){var o;return r.__generator(this,function(r){switch(r.label){case 0:return[4,this.dataApi.fetchSameNamespaceFolderSizes(e,t)];case 1:return o=r.sent(),h.BrowseDispatcher.dispatch({type:p.BrowseActionType.FETCHED_FOLDER_SIZES,data:{fqPath:t.fq_path,resp:o}}),[2,o]}})})},e.prototype.handleShowShareModal=function(e,t){var r=_.getBrowseStore(),o=r.user(),s=r.context();A.asyncShowShareModal(o,e,{browseContext:s,origin:t},f.browseNavActions.setPath,f.browseNavActions.setUrl)},e})();t.browseActions=new N(u)}),define("modules/clean/react/browse/browse",["require","exports","tslib","external/react","external/react-dom","external/lodash","modules/clean/ajax_as_promised","modules/clean/browse_interface","modules/clean/em_string","modules/clean/filepath","modules/clean/history","modules/clean/react/async_file_modal_controller","modules/clean/react/browse/actions","modules/clean/react/browse/api","modules/clean/react/browse/browse_view","modules/clean/react/browse/constants","modules/clean/react/browse/models","modules/clean/react/browse/store","modules/clean/browse/browse_bolt_client","modules/clean/react/file_uploader/constants","modules/clean/react/file_uploader/file_uploader","modules/clean/react/file_uploader/store","modules/clean/react/file_viewer/async_controller","modules/clean/search/search_results/actions","modules/clean/search/search_bar/data/store","modules/clean/search/search_bar/data/selectors","modules/clean/search/search_results/store","modules/clean/sharing/browse_exports","modules/clean/sharing/constants","modules/clean/viewer","modules/clean/pagelet_logger","modules/clean/web_timing_logger","modules/core/browser","modules/core/exception","modules/core/html","modules/core/i18n","modules/core/notify","modules/core/uri","modules/clean/filepath","modules/constants/python","modules/clean/search/search_helpers","modules/clean/search/search_bar/data/action_creators","modules/clean/storage","modules/clean/react/browse/browse_prefetch_loader","modules/clean/react/browse/nav_actions","modules/clean/react/snackbar"],function(e,t,r,o,s,a,n,i,l,c,d,u,p,h,m,f,_,S,g,w,v,b,T,F,E,y,R,C,A,I,P,N,D,x,L,M,O,U,k,B,V,q,H,W,G,z){"use strict";function j(e){O.Notify.success(M._("%(file_name)s added to your Dropbox.").format({file_name:c.filename(e)}))}function Q(e){var t=M._('Added “%(folder_name)s” <a href="%(href)s">Learn More</a>').format({folder_name:l.Emstring.em_snippet(c.filename(e),A.SNIPPET_SIZES.FILENAME),href:"/help/business/team-space-overview#acceptfolder"});O.Notify.success(new L.HTML(t))}function K(e){var t=c.parent_dir(e);"/"!==t&&O.Notify.success(M._("Folder is in %(path)s").format({path:l.Emstring.em_snippet(t,22)}))}function J(e){var t=X();d.replace_state(e,a.pick.apply(a,[t,f.BrowseQueryArg.d,f.BrowseQueryArg.select,f.BrowseQueryArg.preview].concat(f.FRAMEWORK_ARGS)))}function X(){var e=d.deconstruct_url().qargs;return{d:e[f.BrowseQueryArg.d],select:e[f.BrowseQueryArg.select],path:e[f.BrowseQueryArg.path],last_fq_path:e[f.BrowseQueryArg.last_fq_path],query:e[f.BrowseQueryArg.query],query_unnormalized:e[f.BrowseQueryArg.query_unnormalized],preview:e[f.BrowseQueryArg.preview],search_session_id:e[f.BrowseQueryArg.search_session_id],country_override:e[f.BrowseQueryArg.country_override],cProfile:e[f.BrowseQueryArg.cProfile],public_mode_override:e[f.BrowseQueryArg.public_mode_override],stormcrow_override:e[f.BrowseQueryArg.stormcrow_override],stormcrow_override_data_field:e[f.BrowseQueryArg.stormcrow_override_data_field],stormcrow_override_population:e[f.BrowseQueryArg.stormcrow_override_population],stormcrow_override_ttl:e[f.BrowseQueryArg.stormcrow_override_ttl],stormcrow_panel:e[f.BrowseQueryArg.stormcrow_panel],uncompressed_js:e[f.BrowseQueryArg.uncompressed_js],use_packages:e[f.BrowseQueryArg.use_packages]}}Object.defineProperty(t,"__esModule",{value:!0});var Y;(function(e){e[e.BROWSE=0]="BROWSE",e[e.SEARCH=1]="SEARCH"})(Y||(Y={}));var Z=(function(t){function l(o){var i=t.call(this,o)||this;i.logOnceFetchedDataRequiredForTTI=a.once(function(){return N.log_js_modules_fetched_data_required_for_tti()}),i.previousHistoryCallbackMode=Y.BROWSE,i.receiveStateFromStores=function(){i.setState(i.getStateFromStores())},i.handleComponentTTI=function(e){i.browseLogger&&(i.browseLogger.componentReady(e),i.browseLogger.ttiLogged&&i.ajaxRequestWebTimer&&(i.ajaxRequestWebTimer.markTimeToInteractive(),delete i.ajaxRequestWebTimer))},i.onAllUploadsComplete=function(e){var t=e.detail.files,r=t.map(function(e){return k.normalize(e.path)+k.normalize(e.name)});p.browseActions.selectFilesAfterUpload({fqPathsToSelect:r})},i.getIsFileJumping=function(){return S.getBrowseStore().isFileJumping()},i.setBrowseViewRef=function(e){i.browseViewRef=e},i.startBoltLiveUpdate=function(){i.browseBoltClient.startLiveUpdate(function(){i.getChangesRequest&&i.getChangesRequest.abort();var e=i.state,t=e.context,r=e.path,o=e.shouldShowDeletedFiles,s=i.getUser();i.getChangesRequest=h.getChangesForDirectory({path:r,userId:s.id,namespaceToJournalIdMap:i.browseBoltClient.getNsMap(),includeDeletedFiles:o,isNonUserRelativeContext:t.isNonUserRelativeContext,onSuccess:function(e){delete i.getChangesRequest,p.browseActions.computeAndApplyDeltasFromBoltClient({payload:e,path:r}),i.browseBoltClient.handleUpdateBoltClient(e.bolt_data)}})})},i.handleFileLocationChange=function(e,t){e="/"+U.URI.decode(e);var r=S.getBrowseStore().sortLabel(),o=S.getBrowseStore().sortIsAscending();i.ensureFileViewerIsOpenedOrClosedIfNeeded(t),i.previousHistoryCallbackMode===Y.BROWSE&&S.getBrowseStore().isPathEqualsTo(e)||(i.previousHistoryCallbackMode=Y.BROWSE,i.navigateToPath({path:e,sortLabel:r,sortIsAscending:o}))},i.getPathFromProps=function(){return i.props["init-fq-path"]||"/"},i.getUser=function(){return I.Viewer.get_viewer().get_user_by_id(i.props["user-id"])},i.handleSearchLocationChange=function(e,t){if(t){var r=i.props["exp-search-results-experiments"],o=t.query||t.query_unnormalized||"";e=t.path||t.last_fq_path||"/";var s=t.search_session_id||"",a=void 0;V.isInDeletedFilterRightRailExperiment(r)&&(a="1"===t.d,setTimeout(function(){p.browseActions.setShouldShowDeletedFiles({shouldShowDeletedFiles:a,shouldUpdateUrl:!1})},0));var n=S.getBrowseStore().sortLabel(),l=S.getBrowseStore().sortIsAscending()
;if(o&&(!k.paths_are_equal(e,i.state.path)||o!==i.state.latestQuery||V.isInDeletedFilterRightRailExperiment(r)&&a!==i.state.shouldShowDeletedFiles)){var c=i.getUser();i.previousHistoryCallbackMode=Y.SEARCH,S.getBrowseStore().isPathEqualsTo(e)||p.browseActions.setPath({path:e,sortLabel:n,sortIsAscending:l}),i.searchBarStore.dispatch(q.setBrowseScope({browseScope:e})),i.searchBarStore.dispatch(q.setSearchQueryAndFetchResults({user:c,query:o,searchSessionId:s}));var d=i.searchResultsExperiments,u=d.expFetchPartialSearchResultInFrontendService,h=d.expShowSymlinkIcon,m=d.expShowCDMIconography;F.searchResultsActions.runSearch({user:c,path:e,query:o,searchSessionId:s,showSymlinkIcon:!!h,showCDMIconography:!!m,webTimer:i.ajaxRequestWebTimer,logOnceFetchedDataRequiredForTTI:i.logOnceFetchedDataRequiredForTTI,fetchPartialResultVariant:u,deletedFiles:a})}}},i.handleSearchExit=function(){i.searchBarStore.dispatch(q.clearSearchBar()),F.searchResultsActions.clearSearch()},i.markTTVIfNeeded=function(){if(!i.hasTTVBeenLogged&&i.mounted&&(i.prefetchComplete||i.props["search-query"])){var e=window.ensemble;e&&e.markPageletRenderedByDOMNode(s.findDOMNode(i)),N.mark_time_to_view(),i.hasTTVBeenLogged=!0}},i.handleFileListUpdated=function(){i.fileViewerIsShown()?i.state.files.isEmpty()?p.browseActions.closeFileViewer():p.browseActions.updatePreview({files:i.state.files.toJS()}):i.ensureFileViewerIsOpenedOrClosedIfNeeded(X())},i.handleOnNavigateToPath=function(e){p.browseActions.setUrl({path:e})},i.handleOnNavigateToParentFolder=function(){p.browseActions.navigateToParentFolder()},i.handleDelete=function(e){var t=i.state.context,r=e.some(_.File.isTeamSharedFolder),o=e.some(function(e){return e.read_only});if(!t.isCurrentPathWriteable()||r||o)r?O.Notify.error(M._("Team folders can’t be deleted.")):O.Notify.warning(M._("You don’t have permission to delete files in this folder."));else{var s=i.browseExperiments.expSubgrowthBizWebClientOQDelete;p.browseActions.doDeleteFilesWithModal({files:e,expSubgrowthBizWebClientOQDelete:!!s})}},i.actionHandlers={onDelete:i.handleDelete,onShowRename:function(e){return p.browseActions.showFileRename({file:e})},onRestore:function(e){var t=i.browseExperiments.expSubgrowthProRestoreFilesUpsell;!i.getUser().is_team&&i.props["is-over-free-quota"]&&"V1"===t?u.showOverquota("wb_oq_rstdel_f"):p.browseActions.doRestoreFilesWithModal({files:e}),t&&["CONTROL","V1"].includes(t)&&n.SilentBackgroundRequest({url:"/log/stormcrow_exposures",data:{stormcrow_name:"subgrowth_pro_restore_files_upsell",variant:t}})},onPermanentDelete:function(e){return p.browseActions.doPermanentDeleteWithModal({files:e})}},i.filesViewActionHandlers={onDelete:i.handleDelete,onShowRename:function(e){return p.browseActions.showFileRename({file:e})},onCopyToClipboard:function(e){return p.browseActions.copyFilesToClipboard(e)},onPasteFromClipboard:function(){return p.browseActions.pasteClipboardFilesToCurrentPath()},onNewFolderSubmit:function(e){return p.browseActions.createFolder({pathName:i.state.context.currentFQPath,folderName:e,nsId:i.state.context.rootNSID,checkFSWs:!0})},onNewFolderCancel:function(){return p.browseActions.cancelCreateFolder()},onRenameSubmit:function(e,t){return p.browseActions.renameFile({file:e,newName:t,isSearchMode:i.state.isSearchMode})},onRenameCancel:function(e){return p.browseActions.cancelFileRename({file:e})},onSetDropTarget:function(e){return p.browseActions.setDropTarget({target:e})},onSwitchViewType:function(e){return p.browseActions.setViewType({viewType:e})},onTilesPerRowChange:function(e){return p.browseActions.setTilesPerRow({tilesPerRow:e})},onColumnsChanged:function(e,t,r){return p.browseActions.setColumnConfiguration({columns:e,viewType:t,canDisplayFolderSizes:r})},onCanDisplayFolderSizesChanged:function(e){return p.browseActions.setColumnDependentCapabilities({canDisplayFolderSizes:e})},onAddFileJumpKeyCode:function(e){return p.browseActions.addFileJumpKeyCode({keyChar:e})},onResetFileJump:function(){return p.browseActions.resetFileJump()},onShowShare:function(e,t){return p.browseActions.handleShowShareModal(e,t)}},i.handleSearch=function(e,t,r,o){var s=V.buildSearchURL({user:i.getUser(),searchPath:t,normalizedQuery:e,searchSessionId:r?y.searchSessionId(i.searchBarStore.getState()):R.getSearchResultsStore().searchSessionId(),searchToken:V.getSearchCsrfToken(),qargs:o});i.ensureTimer("search_results"),d.push_state(s.getPath(),s.getQuery())},i.fileViewerIsShown=function(){return!!i.state.arePostTTIModulesLoaded&&e("modules/clean/react/file_viewer/controller").isShown()},i.ensureFileViewerClosedIfNotPreviewing=function(e){!e.preview&&i.fileViewerIsShown()&&p.browseActions.closeFileViewer()},i.ensureFileViewerIsOpenedOrClosedIfNeeded=function(e){var t=i.fileViewerIsShown();if(e.preview&&!t){var r=S.getBrowseStore().getFileByFilename(e.preview);r&&p.browseActions.navigateToFileOrFolder({file:r})}else t&&!e.preview&&p.browseActions.closeFileViewer()},i.getLearnMoreLinkHandler=function(){window.open("/help/business/unsynced-team-folder","_blank")},N.log_js_modules_application_code_start();var l=S.getBrowseStore(),c=R.getSearchResultsStore();return E.getStoreForSearchBar().dispatch(q.setExperiments({experiments:o["exp-search-bar-experiments"]||{}})),i.searchBarStore=E.getStoreForSearchBar(),l.add_change_listener(i.receiveStateFromStores),c.add_change_listener(i.receiveStateFromStores),b.uploaderStore.add_change_listener(i.receiveStateFromStores),window.addEventListener(w.ALL_UPLOADS_COMPLETE_EVENT,i.onAllUploadsComplete),i.state=r.__assign({},i.getStateFromStores(),{arePostTTIModulesLoaded:!1,shouldShowDeletedFiles:!!i.props["should-show-deleted-files"]}),i}return r.__extends(l,t),Object.defineProperty(l.prototype,"uploaderExperiments",{get:function(){return this.props["exp-uploader-experiments"]||{}},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"searchBarExperiments",{get:function(){return this.props["exp-search-bar-experiments"]||{}},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"searchResultsExperiments",{get:function(){return this.props["exp-search-results-experiments"]||{}},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"browseExperiments",{get:function(){return this.props["exp-browse-experiments"]||{}},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"browsePostTTIExperiments",{get:function(){return this.state.browsePostTTIExperiments||{}},enumerable:!0,configurable:!0}),l.prototype.componentWillMount=function(){var e,t=this;e=this.props["search-query"]?["FilesViewController"]:["FilesViewController","AppActionsView"],this.browseLogger=new P.PageletLogger("browse",e,!0,{view_type:this.state.viewType.toLowerCase()});var r=S.getBrowseStore(),o=this.getUser(),s=i.get_browse_root(o),a=this.props["search-query"],n=this.props["share-link"],l=!!this.props["preview-file-info"],c=this.getPathFromProps();p.browseActions.setUrlPrefix({prefix:s}),p.browseActions.setUser({user:o}),a||n||l||J(this.getUrlForFQPath(s,c));var u=I.Viewer.get_viewer().get_users().map(function(e){return e.id});H.UserLocalStorage.clearOtherUsers(u),this.browseBoltClient=new g.BrowseBoltClient(o.id);var h=new W.BrowsePrefetchLoader({user:o,path:c,urlPrefix:s,shouldShowDeletedFiles:!!this.props["should-show-deleted-files"],fqPathsToSelect:this.props["select-fq-paths"]},function(){t.prefetchComplete=!0,t.searchBarStore.dispatch(q.setBrowseScope({browseScope:c})),N.log_js_modules_fetched_data_required_for_tti(),t.markTTVIfNeeded()},function(){t.prefetchComplete=!0,p.browseActions.setUrl({path:""}),t.navigateToPath({path:"",sortLabel:r.sortLabel(),sortIsAscending:r.sortIsAscending()})},function(e){var r=e["exp-browse-post-tti-experiments"];r.expShouldShowNcctPaywall&&D.redirect("/ncct-trial-end"),t.setState({browsePostTTIExperiments:r})},function(e){x.reportException({err:e||new Error("failed to load post TTI experiments")})});h.isPrefetching()?h.handlePrefetch():a||this.navigateToPath({path:c,sortLabel:r.sortLabel(),sortIsAscending:r.sortIsAscending(),logFetchedDataRequiredForTTI:!0}),d.add_callback(s,this.handleFileLocationChange,!0),d.add_callback("/search",this.handleSearchLocationChange,!a),d.add_exit_callback("/search",this.handleSearchExit)},l.prototype.componentDidMount=function(){var t=this;this.mounted=!0;var o=this.getPathFromProps(),s=this.getUser(),n=this.props["search-query"],i=this.props["share-link"],c=!!this.props["preview-file-info"];if(this.props["from-scl-sync-modal"]&&(s.is_cdm_member?Q(o):j(o)),!n&&i&&!c&&s.is_cdm_member&&K(o),this.markTTVIfNeeded(),l.mountFileViewerTarget(),this.props["loaded-with-explicit-preview"]&&!c){var u=d.deconstruct_url().path,p=X();delete p.preview,d.replace_state(u,p)}N.waitForTTI().then(function(){n||t.fetchAndStartBoltUpdates();var r=function(e,r,o,s,n,i,l,c,d,u,p,h,m,f,_,g){var w=o.SharedWithStore,v=n.checkForMissingStarredData,b=n.StarredStore,T=p.BloodhoundContactsV2,F=m.EmailVerification;if(t.mounted){var E=t.state,y=E.path,R=E.files,C=R.toArray(),A=t.getUser();w.initializeWith({path:y,files:C}),v({items:C,user:A});var I=b.addListener(function(){t.setState({starredState:b.getLoadingStates()})}),P=S.getBrowseStore(),N=function(){return a.defer(function(){v({items:t.state.files.toArray(),user:A})})};P.add_change_listener(N),t.removeStarredStoreListener=function(){I(),P.remove_change_listener(N)},T.getOrCreateForUser(A),h.setup(),t.setState({arePostTTIModulesLoaded:!0}),t.props["email-just-verified"]?F.getForRole(A.role).show_verified_modal():t.props["email-just-verified-and-changed"]?F.getForRole(A.role).show_verified_and_changed_modal():t.props["send-verification-email"]&&F.getForRole(A.role).show_sent_modal()}};r.perfName="browse_post_tti",e(["modules/clean/react/file_viewer/controller","modules/clean/react/browse/file_actions","modules/clean/react/browse/shared_with","modules/clean/react/files_view/overflow_menu_with_star","modules/clean/react/starred/browse_exports","modules/clean/react/file_modal_controller","modules/clean/sharing/share_modal_util","modules/clean/sharing/shared_content_link_sync_utils","modules/clean/sharing/ui_util","modules/clean/sharing/wizard/wizard_modals","modules/clean/contacts/bloodhound_contacts_v2","modules/clean/react/browse/comment_status","modules/clean/account/email","modules/clean/unity_browse_interface","modules/clean/unity/features","modules/clean/unity/check_file_cache"],r)});var h=!!this.props["show-share-modal"],m=this.props["share-prefill-email"],g=this.props["preview-file-info"];if(g){var w=_.File.fromServerObject(g);T.asyncOpenPreview({containerId:f.BROWSE_FILE_VIEWER_ELEMENT_ID,files:[w],fileViewAction:B.FileViewActionType.CLICK,fileViewOrigin:B.FileViewOriginType.BROWSE,fileViewTarget:B.FileViewTargetType.PRIVATE,indexOfPreviewFile:0,user:s,updateBrowserLocation:!1,onFileViewerDidMount:T.hideElementsBehindFileViewer,onFileViewerUnmount:function(){T.showElementsBehindFileViewer();var e=t.browseViewRef;(e=e.getFilesViewControllerRef())&&(e=e.getFilesViewTileGridRef())&&(e=e.getTileGridRef())&&e.getAndUpdateTileLayout(),t.restoreUrlAfterFileViewClose()}}),h&&N.waitForTTI().then(function(){t.mounted&&C.asyncShowPrefilledShareModal({user:s,sharePrefillEmail:m,content:w,setPath:G.browseNavActions.setPath,setUrl:G.browseNavActions.setUrl})})}else h&&N.waitForTTI().then(function(){if(t.mounted){var e=t.props["ns-id"],r=t.props["ns-path"];C.asyncShowPrefilledShareModal({user:s,sharePrefillEmail:m,content:{fqPath:o,isFolder:!0,nsId:e&&r?e:null,targetNsId:e&&!r?e:null},setPath:G.browseNavActions.setPath,setUrl:G.browseNavActions.setUrl})}});h||this.props["showing-ios-apple-billing-modal"]||this.props["showing-client-modal"]||N.waitForTTI().then(function(){e(["modules/clean/upsell/prompt_loader"],function(o){return r.__awaiter(t,void 0,void 0,function(){var t,s=this;return r.__generator(this,function(a){switch(a.label){case 0:return[4,o.waitForPrompt()];case 1:return t=a.sent(),t.didMainCampaignLoad()||t.didCampaignForUserEducationLoad()?[2]:(e(["modules/clean/react/ncct/reminder_modal"],function(t){return r.__awaiter(s,void 0,void 0,function(){var o;return r.__generator(this,function(r){switch(r.label){case 0:return[4,t.NcctReminderModalView.load()];case 1:return o=r.sent(),o||e(["modules/clean/react/teams/modals/multifield_invite_reminder_modal"],function(e){e.MultifieldInviteReminderModal.load()}),[2]}})})}),[2])}})})})}),this.shouldShowUnsyncNotification()&&this.showUnsyncNotification()},l.prototype.componentWillUpdate=function(e,t){t.isSearchMode&&!this.state.isSearchMode?this.browseBoltClient.stopLiveUpdate():!t.isSearchMode&&this.state.isSearchMode&&this.fetchAndStartBoltUpdates(),t.files.equals(this.state.files)||a.defer(this.handleFileListUpdated)},l.prototype.componentWillUnmount=function(){e.defined("modules/clean/react/browse/comment_status")&&e("modules/clean/react/browse/comment_status").teardown(),this.removeStarredStoreListener&&this.removeStarredStoreListener(),l.unmountFileViewerTarget(),S.getBrowseStore().remove_change_listener(this.receiveStateFromStores),R.getSearchResultsStore().remove_change_listener(this.receiveStateFromStores),b.uploaderStore.remove_change_listener(this.receiveStateFromStores),window.removeEventListener(w.ALL_UPLOADS_COMPLETE_EVENT,this.onAllUploadsComplete),this.mounted=!1},l.prototype.getStateFromStores=function(){var e=S.getBrowseStore(),t=R.getSearchResultsStore(),r=t.latestQuery();return{context:e.context(),files:e.files(),filesWithoutTeamFolders:e.filesWithoutTeamFolders(),paginatedTotalNumFiles:e.paginatedTotalNumFiles(),teamFolders:e.teamFolders(),loadingState:e.loadingState(),path:e.path(),selection:e.selection(),selectedFiles:e.selectedFiles(),fileRename:e.fileRename(),shouldShowDeletedFiles:e.shouldShowDeletedFiles(),isDraggingInternalFiles:v.FileUploaderController.isDraggingInternalFiles(),isDraggingExternalFiles:v.FileUploaderController.isDraggingExternalFiles(),activeDropTarget:e.activeDropTarget(),isUploadModalOpen:v.FileUploaderController.isUploadModalOpen(),isTextSelectable:!!e.fileRename(),createNewFolderState:e.newFolderCreationState(),latestQuery:r,isSearchMode:!!r,currentSort:e.currentSort(),viewType:e.viewType(),canDisplayFolderSizes:e.canDisplayFolderSizes(),viewTypeColumns:e.viewTypeColumns(),urlPrefix:e.urlPrefix(),isQueryingFolderSizes:e.isQueryingFolderSizes(),tilesPerRow:e.tilesPerRow()}},l.prototype.restoreUrlAfterFileViewClose=function(){var e,t=this.getUser(),r=i.get_browse_root(t),o=this.getUrlForFQPath(r,this.state.path);e=this.props["loaded-with-explicit-preview"]?a.omit(X(),f.BrowseQueryArg.preview,f.BrowseQueryArg.select):{},d.replace_state(o,e)},l.prototype.getUrlForFQPath=function(e,t){return e+("/"===t?"":U.URI.encode_parts(t))},l.prototype.fetchAndStartBoltUpdates=function(){this.browseBoltClient.isReady()?this.startBoltLiveUpdate():this.browseBoltClient.fetchInitialBoltData(this.startBoltLiveUpdate)},l.prototype.ensureTimer=function(e,t){if(this.ajaxRequestWebTimer&&this.ajaxRequestWebTimer.getContextName()!==e&&delete this.ajaxRequestWebTimer,this.ajaxRequestWebTimer)this.ajaxRequestWebTimer.restart();else{this.ajaxRequestWebTimer=N.get_timer(e);var r={requireTTI:!0,requireTTV:!1};t&&(r.url=t),this.ajaxRequestWebTimer.initialize(r)}},l.prototype.navigateToPath=function(e){var t=e.path,r=e.sortLabel,o=e.sortIsAscending,s=e.logFetchedDataRequiredForTTI,a=void 0!==s&&s;this.browseLogger&&this.browseLogger.ttiLogged&&this.ensureTimer("browse_ajax","browse_ajax_nav"),p.browseActions.setPath({path:t,sortLabel:r,sortIsAscending:o,logFetchedDataRequiredForTTI:a,onPathLoaded:this.markTTVIfNeeded,ajaxWebTimer:this.ajaxRequestWebTimer}),this.searchBarStore.dispatch(q.clearSearchBar()),this.searchBarStore.dispatch(q.setBrowseScope({browseScope:t}))},l.prototype.shouldShowUnsyncNotification=function(){return this.props["should-show-unsync-notification"]},l.prototype.showUnsyncNotification=function(){z.Snackbar.show(o.createElement(z.Snackbar,{variant:"generic",title:M._("Do you also need this on your computer?",{comment:'\'"this" refers to the folder that the user is currently browsing. (limited space, please keep the phase short)'}),timeoutDelayMs:1e5,actionButtonText:M._("Learn more"),closeButtonText:M._("Close"),onActionClick:this.getLearnMoreLinkHandler}))},l.prototype.render=function(){var e=this.state,t=e.activeDropTarget,r=e.context,s=e.path,a=e.createNewFolderState,n=e.currentSort,i=e.isUploadModalOpen,l=e.selection,c=e.fileRename,d=e.files,u=e.teamFolders,p=e.isTextSelectable,h=e.loadingState,f=e.selectedFiles,_=e.isSearchMode,S=e.viewType,g=e.canDisplayFolderSizes,w=e.viewTypeColumns,v=e.starredState,b=e.filesWithoutTeamFolders,T=e.arePostTTIModulesLoaded,F=e.isDraggingExternalFiles,E=e.isDraggingInternalFiles,y=e.isQueryingFolderSizes,R=e.paginatedTotalNumFiles,C=e.tilesPerRow,A=e.shouldShowDeletedFiles,I=this.getUser();return o.createElement(m.BrowseView,{autoTeamGroupId:this.props["auto-team-group-id"],ref:this.setBrowseViewRef,actionHandlers:this.actionHandlers,filesViewActionHandlers:this.filesViewActionHandlers,onNavigateToParentFolder:this.handleOnNavigateToParentFolder,onNavigateToPath:this.handleOnNavigateToPath,activeDropTarget:t,context:r,createNewFolderState:a,currentSort:n,ensureFileViewerClosedIfNotPreviewing:this.ensureFileViewerClosedIfNotPreviewing,fileRename:c,files:d,filesWithoutTeamFolders:b,getIsFileJumping:this.getIsFileJumping,handleComponentTTI:this.handleComponentTTI,isDraggingExternalFiles:F,isDraggingInternalFiles:E,isFileViewerShown:this.fileViewerIsShown,isSearchMode:_,isTextSelectable:p,isUploadModalOpen:i,loadingState:h,onSearch:this.handleSearch,path:s,selectedFiles:f,selection:l,shouldOpenUploadModal:this.props["should-open-upload-modal"],shouldShowDeletedFiles:A,starredState:v,teamFolders:u,totalNumItems:R,user:I,viewType:S,canDisplayFolderSizes:g,columns:w[S],viewTypeColumns:w,tilesPerRow:C,arePostTTIModulesLoaded:T,isNoComment:this.props["is-no-comment"],isOverFreeQuota:this.props["is-over-free-quota"],isQueryingFolderSizes:y,nsId:this.props["ns-id"],uploaderExperiments:this.uploaderExperiments,searchBarExperiments:this.searchBarExperiments,searchResultsExperiments:this.searchResultsExperiments,browseExperiments:this.browseExperiments,browsePostTTIExperiments:this.browsePostTTIExperiments})},l.mountFileViewerTarget=function(){var e=document.getElementById(f.BROWSE_FILE_VIEWER_ELEMENT_ID);e||(e=document.createElement("div"),e.id=f.BROWSE_FILE_VIEWER_ELEMENT_ID,document.body.insertBefore(e,document.body.children[0]))},l.unmountFileViewerTarget=function(){var e=document.getElementById(f.BROWSE_FILE_VIEWER_ELEMENT_ID);e&&document.body.removeChild(e)},l})(o.Component);t.BrowseApp=Z}),define("modules/clean/react/browse/browse_prefetch_loader",["require","exports","modules/core/exception","modules/clean/react/files_view/types","modules/clean/react/browse/actions","modules/clean/react/browse/models","modules/clean/pagination_manager","modules/core/notify","modules/clean/web_timing_logger"],function(e,t,r,o,s,a,n,i,l){"use strict";function c(e){if(0===e.indexOf("err:")){var t=e.substr("err:".length);i.Notify.error(t)}}Object.defineProperty(t,"__esModule",{value:!0});var d=(function(){function e(e,t,i,d,u,p){var h=e.user,m=e.path,f=e.urlPrefix,_=e.shouldShowDeletedFiles,S=e.fqPathsToSelect;void 0===p&&(p=window);var g=this;this.isPrefetching=function(){return!!g.browsePreloadHandler&&!!g.firstPagePreloadHandler},this.handlePrefetch=function(){r.assert(g.isPrefetching(),"trying to handle prefetching and think we aren't prefetching at the same time.  something is wrong"),g.browsePreloadHandler(g.handlePrefetchDataSuccess,g.onPrefetchError),l.waitForTTI().then(function(){g.postTTIPreloadHandler(g.handlePostTTIDataSuccess,g.onPostTTIPrefetchError)})},this.handlePostTTIDataSuccess=function(e){var t=void 0;try{t=JSON.parse(e)}catch(e){return void g.onPostTTIPrefetchError(e)}if(!t)return void g.onPostTTIPrefetchError();g.onPostTTIPrefetchComplete(t)},this.handlePrefetchDataSuccess=function(e){var t=g.extractAjaxInitData(e);if(!t)return void g.onPrefetchError();var r,n,i=[],l=0,c=o.LoadingState.LOADING_FIRST_PAGE,d=g.firstPagePreloadHandler.getDataIfAvailable();if(d){if(!d.payload||d.error)return void g.onPrefetchError();var u=g.extractAjaxFileInfo(d.payload);if(!u)return void g.onPrefetchError();r=u.file_info,n=u.first_page,n?(i=[],l=n.total_num_items,c=o.LoadingState.LOADING_REMAINING_PAGES):r&&(i=r,l=i.length,c=o.LoadingState.LOADED)}var p=a.BrowseContext.fromServerObject(t);s.browseActions.initializeEverything({user:g.user,path:g.path,files:i,paginatedTotalNumFiles:l,urlPrefix:g.urlPrefix,context:p,mountPoints:t.ns_id_to_mount_point,shouldShowDeletedFiles:g.shouldShowDeletedFiles,fqPathsToSelect:g.fqPathsToSelect,loadingState:c,teamFolders:t.team_folders_js_info}),r||n?(n&&g.initializePaginationManager(n),g.onPrefetchComplete()):g.firstPagePreloadHandler(function(e){g.handleFirstPagePrefetchDataSuccess(e,p)},g.onPrefetchError)},this.handleFirstPagePrefetchDataSuccess=function(e,t){var r=g.extractAjaxFileInfo(e);if(!r)return void g.onPrefetchError();r.paginated?g.initializePaginationManager(r.first_page):s.browseActions.load({path:g.path,files:r.file_info,paginatedTotalNumFiles:r.file_info.length,context:t}),g.onPrefetchComplete()},this.extractAjaxInitData=function(e){var t=void 0;try{t=JSON.parse(e)}catch(t){c(e)}return t},this.extractAjaxFileInfo=function(e){var t=void 0;try{t=JSON.parse(e)}catch(t){c(e)}return t},this.initializePaginationManager=function(e){var t=e.total_num_items,r=n.PaginationManager.create({firstPage:e,keyName:"sjid",ajaxURL:"/browse_get_next",userID:g.user.id,newDataAvailableCallback:function(e,r){var a=e.areAllItemsReady(),n=a?o.LoadingState.LOADED:o.LoadingState.LOADING_REMAINING_PAGES;s.browseActions.addFilesAndSetLoadingState({path:g.path,files:r,paginatedTotalNumFiles:t,loadingState:n}),a&&e.stopAutoFetching()}});l.waitForTTI().then(function(){return r.startAutoFetching()})},this.user=h,this.path=m,this.urlPrefix=f,this.shouldShowDeletedFiles=_,this.fqPathsToSelect=S,this.onPrefetchComplete=t,this.onPrefetchError=i,this.onPostTTIPrefetchComplete=d,this.onPostTTIPrefetchError=u,this.browsePreloadHandler=p.__REGISTER_BROWSE_PRELOAD_HANDLER,this.firstPagePreloadHandler=p.__REGISTER_BROWSE_FIRST_PAGE_PRELOAD_HANDLER,this.postTTIPreloadHandler=p.__REGISTER_BROWSE_POST_TTI_PRELOAD_HANDLER}return e})();t.BrowsePrefetchLoader=d}),define("modules/clean/react/browse/browse_view",["require","exports","tslib","external/immutable","external/react","modules/clean/filepath","modules/clean/react/browse/action_logger","modules/clean/react/browse/actions","modules/clean/react/browse/browse_location","modules/clean/filetypes","modules/clean/react/files_view/types","modules/clean/react/files_view/controller","modules/clean/react/browse/sidebar_view","modules/clean/react/browse/models","modules/clean/react/browse/store","modules/clean/react/file_uploader/file_uploader","modules/clean/react/maestro/layout","modules/clean/search/search_results/log_helper","modules/clean/search/search_bar/log_helper","modules/clean/search/search_results/controller","modules/clean/sharing/browse_exports","modules/clean/sharing/access_level","modules/clean/user_education/user_education_client","modules/clean/viewer","modules/clean/web_timing_logger","modules/constants/python","modules/core/browser","modules/core/i18n","modules/clean/analytics","modules/clean/web_user_action_events","modules/clean/react/files_view/constants"],function(e,t,r,o,s,a,n,i,l,c,d,u,p,h,m,f,_,S,g,w,v,b,T,F,E,y,R,C,A,I,P){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var N=[b.NameSpaceAccess.ACCESS_NO_ACCESS,b.NameSpaceAccess.ACCESS_READER,b.NameSpaceAccess.ACCESS_READER_NO_COMMENT],D=(function(t){function b(r){var l=t.call(this,r)||this;return l.handleGetOverflowMenuActions=function(e,t,r){return l.handleGetFileActionsForSetOfFiles(o.Set([e]),t,r,!1)},l.handleGetFileActionsForSetOfFiles=function(t,r,o,s){if(l.props.arePostTTIModulesLoaded){var a=l.props,n=a.context,i=a.user,c=a.actionHandlers,d=a.isSearchMode,u=a.isOverFreeQuota,p=a.isQueryingFolderSizes,h=a.browseExperiments,m=a.browsePostTTIExperiments,f=e("modules/clean/react/browse/file_actions"),_=h.expShouldShowUnifiedTrashModal,S=h.expShowAddToShowcase,g=m.expShowAddToShowcaseUpsell;return f.getActionsForFileCollection({files:t,context:n,user:i,canDisplayFolderSizes:r,actionHandlers:c,skipSharing:!1,isSearchMode:d,isOverFreeQuota:u,isQueryingFolderSizes:p,shouldShowUnifiedTrashModal:!!_,canShowUJPopup:s,showAddToShowcase:!!S,showAddToShowcaseUpsell:!!g,addToShowcaseUpsellVariant:g||"OFF",responsive:o})}return[]},l.handleNavigateToFileOrFolder=function(e,t){var r=l.props,o=r.user,s=r.isSearchMode,d=r.viewType,u=r.browseExperiments,p=u.expShouldShowUnifiedTrashModal,h=e.ns_id,f=e.sjid,_=e.file_id,g=e.fq_path,w=e.bytes,b=e.ext,E=e.request_id;if(n.logOpenRow({uid:o.id,entity_type:e.is_dir?"folder":"file",source:"list_browse",view_type:d,file_nsid:h,file_sjid:f,file_id:_,file_name:a.filename(e.fq_path),file_path:g,file_size:w,file_extension:b,request_id:E}),e.type===c.FileTypes.TEAM_SHARED_FOLDER&&(T.UEClient.sendEvent("FileItemRow","TeamFolderClicked"),A.TeamsWebActionsLogger.log("clicked_team_folder_web",{team_id:F.Viewer.get_viewer().team_id})),s&&e.is_unmounted)S.recordSearchResultsAction({result:e,user:o,action_type:I.WebUserActionLogEvent.UNMOUNTED_VIEW,view_type:m.getBrowseStore().viewType()}),v.asyncShowSharedContentLinkSyncModal(o,e);else{var R=y.FileViewActionType.CLICK;s&&(S.recordSearchResultsAction({result:e,user:o,action_type:e.is_dir?I.WebUserActionLogEvent.FOLDER_OPEN:I.WebUserActionLogEvent.FILE_VIEW,view_type:m.getBrowseStore().viewType()}),R=y.FileViewActionType.SEARCH),i.browseActions.navigateToFileOrFolder({file:e,onFileViewerUnmount:t,fileViewAction:R,expShouldShowUnifiedTrashModal:!!p})}},l.handleUploadButtonClick=function(e){f.FileUploaderController.setPath(l.props.path),f.FileUploaderController.handleUploadButtonClick(e)},l.handleShowFileUploader=function(){f.FileUploaderController.setPath(l.props.path),f.FileUploaderController.showModal()},l.handleSelectionChange=function(e){var t=m.getBrowseStore().getFileByFullPath(e.selected.first());if(t){var r=t.ns_id,o=t.sjid,s=t.file_id,c=t.fq_path,d=t.bytes,u=t.ext,p=t.request_id;n.logSelectRow({uid:l.props.user.id,entity_type:t.is_dir?"folder":"file",view_type:l.props.viewType,file_nsid:r,file_sjid:o,file_id:s,file_name:a.filename(t.fq_path),file_path:c,file_size:d,file_extension:u,request_id:p})}i.browseActions.setSelection({selection:e})},l.handleFileListSortChange=function(e,t){n.logSortRecords({uid:l.props.user.id,sort_by:e,sort_direction:t,view_type:l.props.viewType}),i.browseActions.sortFiles({sortField:e,sortDirection:t})},l.handleStarClick=function(e,t){var r=t?I.WebUserActionLogEvent.STAR:I.WebUserActionLogEvent.REMOVE_STAR,o=l.props,s=o.user,a=o.isSearchMode,i=o.viewType,c=m.getBrowseStore().countFilesAndFolders(),d=c.num_files_selected,u=c.num_folders_selected;a&&S.recordSearchResultsAction({result:e,user:s,action_type:r,view_type:i}),n.logBrowseAction(s.id,"BROWSE",r,d,u,i,e)},l.handleSearchFromSearchBar=function(e){var t=e.query,r=e.searchPath;t?l.props.onSearch(t,r,!0):i.browseActions.setUrl({path:r})},l.handleSearchResultOpen=function(e){e instanceof h.File?e.is_unmounted?v.asyncShowSharedContentLinkSyncModal(l.props.user,e):(g.logDropdownSearchAction({result:e,user:l.props.user,action_type:e.is_dir?I.WebUserActionLogEvent.FOLDER_OPEN:I.WebUserActionLogEvent.FILE_VIEW,viewport:"dropdown-view"}),i.browseActions.navigateToFileOrFolder({file:e,fileViewAction:y.FileViewActionType.SEARCH})):(e instanceof h.Paper||e instanceof h.PaperFolder)&&(g.logDropdownSearchAction({result:e,user:l.props.user,action_type:I.WebUserActionLogEvent.PAPER_OPEN,viewport:"dropdown-view"}),R.open_tab(e.url))},l.handleResultObjectPathClick=function(e){g.logDropdownSearchAction({result:e,user:l.props.user,action_type:I.WebUserActionLogEvent.CLICK_PATH_LINK,viewport:"dropdown-view"}),i.browseActions.navigateToResultObjectParentFolder({file:e,fileViewAction:y.FileViewActionType.SEARCH})},l.setFilesViewControllerRef=function(e){l.filesViewControllerRef=e},l.handleSearchFromSearchResults=function(e,t,r){l.props.onSearch(e,t,!1,r)},l.renderSideBar=function(e){var t=l.props,r=t.autoTeamGroupId,o=t.arePostTTIModulesLoaded,a=t.canDisplayFolderSizes,n=t.context,i=t.handleComponentTTI,c=t.isNoComment,d=t.isSearchMode,u=t.selectedFiles,h=t.shouldShowDeletedFiles,m=t.starredState,f=t.user,_=t.viewType,S=t.uploaderExperiments,g=t.browseExperiments,w=t.browsePostTTIExperiments;return s.createElement(p.BrowseSidebarView,{autoTeamGroupId:r,arePostTTIModulesLoaded:o,canDisplayFolderSizes:a,context:n,uploaderExperiments:S,browseExperiments:g,browsePostTTIExperiments:w,handleComponentTTI:i,handleUploadButtonClick:l.handleUploadButtonClick,isNoComment:c,isSearchMode:d,onGetFileActionsForFiles:l.handleGetFileActionsForSetOfFiles,responsive:e,selectedFiles:u,shouldShowDeletedFiles:h,starredState:m,user:f,viewType:_})},l.renderAppContent=function(e){return s.createElement("div",{className:"maestro-browse-app-content"},l.renderFilesViewController(e))},l.state={searchBarProps:l.getCurrentSearchBarProps(l.props),sharedFolderUpsellBanner:void 0},l}return r.__extends(b,t),b.prototype.componentWillReceiveProps=function(e){e.isSearchMode===this.props.isSearchMode&&e.path===this.props.path||this.setState({searchBarProps:this.getCurrentSearchBarProps(e)})},b.prototype.componentDidMount=function(){var t=this;E.waitForTTI().then(function(){t.defineFileUploader(),t.maybeOpenUploaderOnMount(),t.maybeLoadSharedFolderUpsell(),e(["modules/clean/growth/experiments/overquota_helper"],function(e){e.OverquotaHelper.maybeShowSubgrowthProOQRecurringModal("wb_oq_ups_recur_fb")})}),T.UEClient.sendEvent("BrowseView","componentDidMount",this.props.context.toJSON())},b.prototype.componentDidUpdate=function(){this.props.loadingState===d.LoadingState.LOADED&&T.UEClient.sendEvent("BrowseView","componentDidUpdate",this.props.context.toJSON())},b.prototype.maybeOpenUploaderOnMount=function(){this.props.shouldOpenUploadModal&&this.handleShowFileUploader()},b.prototype.getCurrentDropTargetHighlightMode=function(){var e=this.props.selectedFiles,t=this.props.context;return t.isInsideSharedFolder&&N.includes(t.currentSharedFolderPermissionRole)?d.DropTargetHighlightMode.NONE:this.props.isDraggingInternalFiles?e.some(function(e){return e.isDeleted||e.type===c.FileTypes.TEAM_SHARED_FOLDER})?d.DropTargetHighlightMode.NONE:e.some(function(e){return e.type===c.FileTypes.SHARED_FOLDER})?t.currentNSAllowsNesting?d.DropTargetHighlightMode.NONSELECTED_FOLDERS:d.DropTargetHighlightMode.NONSELECTED_NONSHARED_FOLDERS:d.DropTargetHighlightMode.NONSELECTED_FOLDERS:this.props.isDraggingExternalFiles&&!this.props.isUploadModalOpen?d.DropTargetHighlightMode.ALL_FOLDERS:d.DropTargetHighlightMode.NONE},b.prototype.getCurrentSearchBarProps=function(e){return{showSearchBar:!0,currentPath:e.path,onSearch:this.handleSearchFromSearchBar,onSearchResultOpen:this.handleSearchResultOpen,onResultObjectPathClick:this.handleResultObjectPathClick,isSearchBarExpanded:e.isSearchMode,searchBarExperiments:e.searchBarExperiments}},b.prototype.getFilesViewControllerRef=function(){return this.filesViewControllerRef},b.prototype.shouldShowPinnedTeamFolder=function(){var e=this.props,t=e.context,r=e.browseExperiments,o=e.loadingState,s=e.path,a=e.teamFolders,n=e.viewType;if(r.expSubgrowthBizTrialOnboarding&&("/"!==s||n!==d.ViewType.List))return!1;var i=o===d.LoadingState.LOADED;return t.showPinnedTeamFolder&&!a.isEmpty()&&i},b.prototype.renderFilesViewController=function(e){var t=this.shouldShowPinnedTeamFolder(),o=t?this.props.filesWithoutTeamFolders:this.props.files,a=this.props.browseExperiments,n=a.expShouldShowUnifiedTrashModal,i=a.expSharedFolderUpsellV1,l=a.expSubgrowthBizTrialOnboarding
;return s.createElement("div",null,s.createElement(u.FilesViewController,r.__assign({},this.props.filesViewActionHandlers,{getOverflowMenuActions:this.handleGetOverflowMenuActions,onNavigateToFileOrFolder:this.handleNavigateToFileOrFolder,onNavigateToParentFolder:this.props.onNavigateToParentFolder,onNavigateToPath:this.props.onNavigateToPath,activeDropTarget:this.props.activeDropTarget,context:this.props.context,createNewFolderState:this.props.createNewFolderState,currentSort:this.props.currentSort,dropTargetHighlightMode:this.getCurrentDropTargetHighlightMode(),fileRename:this.props.fileRename,items:o,responsive:e,expShouldShowUnifiedTrashModal:!!n,expSharedFolderUpsell:!!i,getIsFileJumping:this.props.getIsFileJumping,isDraggingExternalFiles:this.props.isDraggingExternalFiles,isDraggingInternalFiles:this.props.isDraggingInternalFiles,isFileViewerShown:this.props.isFileViewerShown,isOverFreeQuota:this.props.isOverFreeQuota,isSubgrowthPinnedExp:t&&l,numTeamFolders:this.props.teamFolders.size,arePostTTIModulesLoaded:this.props.arePostTTIModulesLoaded,isTextSelectable:this.props.isTextSelectable,loadingState:this.props.loadingState,onComponentTTI:this.props.handleComponentTTI,onSelectionChange:this.handleSelectionChange,onSortChange:this.handleFileListSortChange,onStarClick:this.handleStarClick,path:this.props.path,ref:this.setFilesViewControllerRef,selectedFiles:this.props.selectedFiles,selection:this.props.selection,setFileUploaderPath:f.FileUploaderController.setPathAndPermissions,shouldShowPinnedTeamFolders:t,showFileUploaderModal:this.handleShowFileUploader,teamFolders:this.props.teamFolders,totalNumFiles:this.props.totalNumItems,user:this.props.user,viewType:this.props.viewType,isQueryingFolderSizes:this.props.isQueryingFolderSizes,columns:this.props.columns,viewTypeColumns:this.props.viewTypeColumns,tilesPerRow:this.props.tilesPerRow,viewTypes:"ON"===this.props.browseExperiments.expBrowseLargeGridView?P.AllViewTypesExperiment:P.AllViewTypes})))},b.prototype.defineFileUploader=function(){f.FileUploaderController.loadCoreComponent()},b.prototype.renderBrowseLocation=function(){var e=this.props.path;if(e){var t=e.split("/"),r=t.length;document.title="/"!==e?C._("%(folder_name)s - Dropbox").format({folder_name:e.split("/")[r-1]}):C._("Files - Dropbox")}var o=this.props,a=o.isDraggingInternalFiles,n=o.isDraggingExternalFiles,c=o.isUploadModalOpen;return s.createElement(l.BrowseLocation,{path:this.props.path,user:this.props.user,selectedFiles:this.props.selectedFiles,isDraggingInternalFiles:a,setFileUploaderPath:f.FileUploaderController.setPathAndPermissions,shouldHighlightDropTargets:a||n&&!c,setUrl:i.browseActions.setUrl})},b.prototype.renderBrowse=function(){var e=this.props.user;return s.createElement("div",null,s.createElement(_.MaestroChrome,{user:e,titleRegion:this.renderBrowseLocation(),titleClass:"page-header__title-overflow",embeddedAppRegion:this.renderAppContent,actionSidebarRegion:this.renderSideBar,searchBarProps:this.state.searchBarProps}),this.renderSharedFolderUpsell())},b.prototype.renderSearchResults=function(){var e=this.props,t=e.actionHandlers,r=e.filesViewActionHandlers,o=e.fileRename,a=e.path,n=e.user,i=e.handleComponentTTI,l=e.isFileViewerShown,c=e.arePostTTIModulesLoaded,d=e.getIsFileJumping,u=e.ensureFileViewerClosedIfNotPreviewing,p=e.browseExperiments,h=e.searchResultsExperiments,m=e.onNavigateToParentFolder,_=e.onNavigateToPath,S=e.shouldShowDeletedFiles;return s.createElement(w.SearchResultsController,{actionHandlers:t,filesViewActionHandlers:r,path:a,user:n,searchResultsExperiments:h,browseExperiments:p,onSearch:this.handleSearchFromSearchResults,setFileUploaderPath:f.FileUploaderController.setPathAndPermissions,maestroSearchBarProps:this.state.searchBarProps,handleComponentTTI:i,ensureFileViewerClosedIfNotPreviewing:u,getIsFileJumping:d,isFileViewerShown:l,fileRename:o,arePostTTIModulesLoaded:c,getOverflowMenuActions:this.handleGetOverflowMenuActions,onNavigateToFileOrFolder:this.handleNavigateToFileOrFolder,onNavigateToParentFolder:m,onNavigateToPath:_,shouldShowDeletedFiles:S})},b.prototype.maybeLoadSharedFolderUpsell=function(){return r.__awaiter(this,void 0,void 0,function(){var t,o,a,n,i,l,c,d,u,p,h;return r.__generator(this,function(r){switch(r.label){case 0:return t=this.props,o=t.browseExperiments,a=t.nsId,n=t.context,i=o.expSharedFolderUpsellV1,l=o.expSharedFolderUpsellMembers,c=o.expSharedFolderUpsellNumMembers,d=o.expSharedFolderUpsellNumInSameDomain,u=o.expSharedFolderUpsellViewerIsCorpDomain,i&&n.isInsideSharedFolder?[4,new Promise(function(t,r){e(["modules/clean/teams/membership_request_block"],t,r)})]:[3,2];case 1:p=r.sent().MembershipRequestBlock,h={expSharedFolderUpsell:i,contacts:l,isViewerCorpDomain:u,nsId:a,numMembers:c,numInSameDomain:d},this.setState({sharedFolderUpsellBanner:s.createElement(p,{membershipRequestOptions:h})}),r.label=2;case 2:return[2]}})})},b.prototype.renderSharedFolderUpsell=function(){if(this.props.browseExperiments.expSharedFolderUpsellV1&&this.props.context.isInsideSharedFolder)return this.state.sharedFolderUpsellBanner},b.prototype.render=function(){return this.props.isSearchMode?this.renderSearchResults():this.renderBrowse()},b.defaultProps={selectedFiles:o.OrderedMap(),viewType:d.ViewType.List},b})(s.PureComponent);t.BrowseView=D}),define("modules/clean/react/browse/dispatcher",["require","exports","modules/core/exception","modules/clean/flux/dispatcher","modules/clean/react/browse/store"],function(e,t,r,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BrowseDispatcher={dispatch:function(e){r.assert(s.browseStoreInstantiated(),"Must call getBrowseStore() before a dispatch"),o.Dispatcher.dispatch(e)}}}),define("modules/clean/react/browse/global_actions",["require","exports","external/lodash","modules/clean/browse_interface","modules/clean/filepath","modules/clean/react/browse/action_logger","modules/clean/react/async_file_modal_controller","modules/clean/react/browse/actions","modules/clean/react/browse/constants","modules/clean/react/browse/nav_actions","modules/clean/react/browse/store","modules/clean/react/file_uploader/action_logger","modules/clean/sharing/access_level","modules/clean/sharing/browse_exports","modules/clean/sharing/constants","modules/clean/viewer","modules/constants/cloud_docs","modules/core/browser","modules/core/exception","modules/core/i18n","modules/core/notify","modules/clean/user_education/user_education_client","modules/clean/web_user_action_events"],function(e,t,r,o,s,a,n,i,l,c,d,u,p,h,m,f,_,S,g,w,v,b,T){"use strict";function F(e){var t=e.context,o=e.user,s=e.showDeletedFiles,a=e.onUpload,n=void 0===a?r.noop:a,i=e.isNoComment,c=void 0!==i&&i,d=e.autoTeamGroupId,p=e.uploaderExperiments,m=e.browseExperiments,w=e.browsePostTTIExperiments,v=t.isCurrentlyInRoot,F=!t.canViewContainingNSMembers,y=t.isCurrentPathWriteable(),R={className:"action-upload",label:C(E.UploadFiles),popoverLabel:C(E.Files),iconName:"upload",performAction:function(){return n(!1)},disabled:!y},M=!!p.expFolderUploadAction&&S.is_input_webkitdirectory_supported(),O=M?{className:"action-upload",label:C(E.UploadFolder),popoverLabel:C(E.Folder),iconName:"upload",performAction:function(){return n(!0)},disabled:!y}:void 0,U=!t.isInsideSandboxFolder,k=[];if(t.isInsideTeamFolderTree||!t.isInsideDeletedSharedFolder&&!t.isInsideDeletedNestedSharedFolder)if(t.isInsideDeletedFolder)k.push({label:C(E.RestoreFolder),iconName:"restore",className:"action-restore",performAction:D(o,t,!!m.expShouldShowUnifiedTrashModal),disabled:!y});else{var B={label:C(E.NewFolder),iconName:"new-folder",performAction:A(o,t,d,w.expSubgrowthProOQNewFolder),disabled:!y,className:"action-new-folder"},V={label:C(v?E.NewSharedFolder:E.ShareFolder),iconName:"new-shared-folder",performAction:P(o,t,w.expSubgrowthProOQNewFolder),disabled:F,className:"action-share-folder"},q={label:C(E.NewTeamFolder),iconName:"new-team-folder",performAction:L(o,t),disabled:!1,className:"action-team-folder"};o.is_cdm_member&&"/"===t.currentFQPath?(b.UEClient.registerCallbackForEducationStep("trial_admin_setup_team_space","team_folder_modal",B.performAction),b.UEClient.registerCallbackForEducationStep("trial_admin_setup_team_space_v2","team_folder_modal",B.performAction),k.push(R),M&&k.push(O),k.push(B)):v?(k.push(R),M&&k.push(O),!o.is_cdm_member&&h.GoldenGate.hasContentManagerAndSuperAdmin(o.id)&&k.push(q),k.push(V,B)):(U&&k.push(V),k.push(R),M&&k.push(O),k.push(B)),_.ENABLE_CREATE&&k.push({label:C(E.NewPaperDoc),iconName:"new-paper-doc",className:"action-paper-docs",performAction:I(l.CloudDoc.PAPER,t),disabled:!y}),c||k.push({label:C(s?E.HideDeletedFiles:E.ShowDeletedFiles),iconName:s?"hide":"show-deleted-files",performAction:N(o,s),disabled:F,className:"action-deleted-files"}),!f.Viewer.get_viewer().is_assume_user_session&&(h.GoldenGate.hasContentManagerAndSuperAdmin(o.id)&&h.GoldenGate.hasNewOwnershipModel(o.id)&&!t.isNonUserRelativeContext&&t.isInsideTeamFolderTree||!o.is_cdm_member&&h.GoldenGate.hasContentManagerAndSuperAdmin(o.id)&&t.isCurrentlyInRoot&&!t.isNonUserRelativeContext)&&k.push({label:C(E.ManageAsAdmin),iconName:"settings-gear",performAction:L(o,t)})}else k.push({label:C(E.ReAddSharedFolder),iconName:"restore",performAction:x(o,t),disabled:!y});if(O&&k[0]===R){g.assert(k[1]===O,"`uploadFolderItem` does not immediately follow `uploadFilesItem`");var H={className:"action-upload",label:C(E.Upload),iconName:"upload",performAction:function(){return u.logUploadAction(o.id,T.WebUserActionLogEvent.UPLOAD_CLICK)},disabled:!y,subItems:[R,O]};k.splice(0,2,H)}return k}Object.defineProperty(t,"__esModule",{value:!0});var E;(function(e){e[e.UploadFiles=1]="UploadFiles",e[e.UploadFolder=2]="UploadFolder",e[e.Upload=3]="Upload",e[e.Files=4]="Files",e[e.Folder=5]="Folder",e[e.NewPaperDoc=6]="NewPaperDoc",e[e.NewFolder=7]="NewFolder",e[e.RestoreFolder=8]="RestoreFolder",e[e.ReAddSharedFolder=9]="ReAddSharedFolder",e[e.ShowDeletedFiles=10]="ShowDeletedFiles",e[e.HideDeletedFiles=11]="HideDeletedFiles",e[e.NewSharedFolder=12]="NewSharedFolder",e[e.ShareFolder=13]="ShareFolder",e[e.ManageAsAdmin=14]="ManageAsAdmin",e[e.NewTeamFolder=15]="NewTeamFolder"})(E||(E={}));var y={},R=function(e){switch(e){case E.UploadFiles:return w._("Upload files");case E.UploadFolder:return w._("Upload folder");case E.Upload:return w._("Upload");case E.Files:return w._("Files");case E.Folder:return w._("Folder");case E.NewPaperDoc:return w._("New Paper Document");case E.NewFolder:return w._("New folder");case E.RestoreFolder:return w._("Restore folder");case E.ReAddSharedFolder:return w._("Re-add shared folder");case E.ShowDeletedFiles:return w._("Show deleted files");case E.HideDeletedFiles:return w._("Hide deleted files");case E.NewSharedFolder:return w._("New shared folder");case E.ShareFolder:return w._("Share folder");case E.ManageAsAdmin:return w._("View in admin console");case E.NewTeamFolder:return w._("New team folder")}},C=function(e){return e in y||(y[e]=R(e)),y[e]},A=function(t,r,o,l){return function(){if("V1"===l)e(["modules/clean/growth/experiments/overquota_helper"],function(e){e.OverquotaHelper.showSubgrowthProOQNewFolderModal({oqa:"wb_oq_ad_fo_fi"})});else{var u=r.currentNSID,m=r.currentFQPath;if(a.logCreateFolder({uid:t.id,view_type:d.getBrowseStore().viewType(),file_nsid:u,file_path:m,file_name:s.filename(m)}),t.is_cdm_member&&"/"===m){g.assert(!!o,"All CDM Users should have an auto team group in their team");var f=function(){v.Notify.error(w._("There was a problem completing this request.")),i.browseActions.cancelCreateFolder()},_=function(e){var t=e.user,r=e.folderName,o=e.fqPath;h.asyncShowInvitePromptModal(),i.browseActions.createFolderComplete({user:t,folderName:r,changesets:null}),i.browseActions.selectFilesByFqPath({fqPathsToSelect:[o]})};h.asyncShowAppropriateNewFolderModalForCdmUser({user:t,context:r,autoTeamGroupId:o,showFileSystemWarningsModal:n.showFileSystemWarningsModal,onPending:i.browseActions.createFolderPending,onComplete:_,onCancel:f,autoTeamGroupDefaultAccessLevel:p.ACCESS_LEVEL.WRITER,setPath:c.browseNavActions.setPath,setUrl:c.browseNavActions.setUrl})}else i.browseActions.nameNewFolder();"CONTROL"===l&&e(["modules/clean/growth/experiments/overquota_helper"],function(e){e.OverquotaHelper.logExposureSubgrowthProOQNewFolderModal("CONTROL")})}}},I=function(e,t){return function(){i.browseActions.createCloudDoc({pathName:t.currentFQPath,title:"Untitled",documentType:e})}},P=function(t,r,o){return function(){"V1"===o?e(["modules/clean/growth/experiments/overquota_helper"],function(e){e.OverquotaHelper.showSubgrowthProOQNewFolderModal({oqa:"wb_oq_ad_shfo_fi"})}):r.isCurrentlyInRoot?h.asyncShowShareAFolderWizardModal(t):h.asyncShowShareModal(t,r,{origin:m.SHARE_ACTION_ORIGIN_TYPE.BROWSE_GLOBAL_ACTIONS},c.browseNavActions.setPath,c.browseNavActions.setUrl),"CONTROL"===o&&e(["modules/clean/growth/experiments/overquota_helper"],function(e){e.OverquotaHelper.logExposureSubgrowthProOQNewFolderModal("CONTROL")})}},N=function(e,t){return function(){a.logToggleDeletedFiles({uid:e.id,show_deleted_files:!t,view_type:d.getBrowseStore().viewType()}),i.browseActions.setShouldShowDeletedFiles({shouldShowDeletedFiles:!t})}},D=function(e,t,r){return void 0===r&&(r=!1),function(){var n=t.currentNSID,l=t.currentFQPath,c=d.getBrowseStore().countFilesAndFolders(),u=c.num_files_selected,p=c.num_folders_selected;if(a.logRestore({uid:e.id,view_type:d.getBrowseStore().viewType(),file_nsid:n,file_path:l,file_name:s.filename(l),num_files_selected:u,num_folders_selected:p}),r)i.browseActions.doRestoreFilesWithUnifiedTrashModal({});else{var h=o.getRestoreFileUrl({fqPath:l,userId:e.id});S.redirect(h)}}},x=function(e,t){return function(){var r=t.currentFQPath.toLowerCase(),o=t.inactiveNSIDByFQPath[r],s=t.isInsideDeletedNestedSharedFolder;o&&h.asyncMountSharedFolder(o,e.role,m.SHARE_ACTION_ORIGIN_TYPE.BROWSE_GLOBAL_ACTIONS,!1,null,s)}},L=function(e,t){return function(){h.asyncGoToContentManagerForPath({isLimitedTeam:f.Viewer.get_viewer().team_is_limited,containingFolder:t.currentFQPath,isCDM:e.is_cdm_member})}};t.getGlobalActions=F}),define("modules/clean/react/browse/nav_actions",["require","exports","modules/clean/history","modules/clean/pagination_manager","modules/clean/react/browse/api","modules/clean/react/browse/constants","modules/clean/react/files_view/types","modules/clean/react/browse/dispatcher","modules/clean/react/browse/models","modules/clean/react/browse/store","modules/clean/react/selection","modules/clean/sharing/gating_util","modules/clean/web_timing_logger","modules/core/browser","modules/core/uri"],function(e,t,r,o,s,a,n,i,l,c,d,u,p,h,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(){function e(e){var t=this;this.dataApi=e,this.setPath=function(e){var r=e.path,s=e.sortLabel,d=e.sortIsAscending,m=e.onPathLoaded,f=e.nsId,_=e.logFetchedDataRequiredForTTI,S=void 0!==_&&_,g=e.ajaxWebTimer,w=c.getBrowseStore(),v=w.user(),b=v.id;null==s&&(s=w.sortLabel()),null==d&&(d=w.sortIsAscending()),i.BrowseDispatcher.dispatch({type:a.BrowseActionType.SET_PATH,data:{path:r,sortLabel:s,sortIsAscending:d}}),t.setLoadingState({loadingState:n.LoadingState.LOADING_FIRST_PAGE,path:r});var T=function(e){var r=e.path,s=e.data,a=e.xhr;if(S&&p.log_js_modules_fetched_data_required_for_tti(),g){var i=a.getResponseHeader("x-dropbox-request-id");g.end(i?i:void 0)}t.setMountPoints({mountPoints:s.ns_id_to_mount_point}),t.setTeamFolders({teamFolders:s.team_folders_js_info});var c=l.BrowseContext.fromServerObject(s);if(s.paginated){t.clear({path:r,context:c});var d=c.isNonUserRelativeContext,h=d&&!v.is_cdm_member&&!u.GoldenGate.hasContentManagerCdm(b),f=w.path(),_="/"!==f&&h?f.split("/")[1]:"",T=s.first_page.total_num_items;o.PaginationManager.create({firstPage:s.first_page,keyName:"sjid",ajaxURL:"/browse_get_next",userID:b,newDataAvailableCallback:function(e,o){var s=e.areAllItemsReady()?n.LoadingState.LOADED:n.LoadingState.LOADING_REMAINING_PAGES;t.addFilesAndSetLoadingState({path:r,files:o,paginatedTotalNumFiles:T,loadingState:s}),e.areAllItemsReady()&&e.stopAutoFetching()},fqPathPrefix:_}).startAutoFetching()}else{var F=s.file_info,E=F?F.length:0;t.load({path:r,files:F,paginatedTotalNumFiles:E,context:c})}m&&m(w.context())},F=c.getBrowseStore().sortLabel(),E=c.getBrowseStore().sortIsAscending();t.dataApi.loadPath({sortLabel:F,sortIsAscending:E,path:r,userId:b,sortFoldersFirst:!h.mac,includeDeletedFiles:c.getBrowseStore().shouldShowDeletedFiles(),nsId:f,onSuccess:T,onError:function(){"/"!==r&&t.setPath({path:"/",sortLabel:F,sortIsAscending:E,onPathLoaded:m})}})}}return e.prototype.setUrlPrefix=function(e){var t=e.prefix;i.BrowseDispatcher.dispatch({type:a.BrowseActionType.SET_URL_PREFIX,data:{prefix:t}})},e.prototype.setUrl=function(e){var t=e.path,o=(e.qargs,{});"1"===r.deconstruct_url().qargs.d&&(o.d="1");var s=t?m.URI.encode_parts(t):"";r.push_state(c.getBrowseStore().urlPrefix()+s,o),i.BrowseDispatcher.dispatch({type:a.BrowseActionType.SET_SELECTION,data:{selection:d.createSelection()}})},e.prototype.setLoadingState=function(e){var t=e.loadingState,r=e.path;i.BrowseDispatcher.dispatch({type:a.BrowseActionType.SET_LOADING_STATE,data:{loadingState:t,path:r}})},e.prototype.setMountPoints=function(e){var t=e.mountPoints;i.BrowseDispatcher.dispatch({type:a.BrowseActionType.SET_MOUNT_POINTS,data:{mountPoints:t}})},e.prototype.setTeamFolders=function(e){var t=e.teamFolders;i.BrowseDispatcher.dispatch({type:a.BrowseActionType.SET_TEAM_FOLDERS,data:{teamFolders:t}})},e.prototype.load=function(e){var t=e.path,r=e.files,o=e.paginatedTotalNumFiles,s=e.context;i.BrowseDispatcher.dispatch({type:a.BrowseActionType.LOAD_PATH,data:{path:t,files:r,paginatedTotalNumFiles:o,context:s}})},e.prototype.clear=function(e){var t=e.path,r=e.context;i.BrowseDispatcher.dispatch({type:a.BrowseActionType.CLEAR_FILES,data:{path:t,context:r}})},e.prototype.add=function(e){var t=e.path,r=e.files,o=e.paginatedTotalNumFiles;i.BrowseDispatcher.dispatch({type:a.BrowseActionType.ADD_FILES,data:{path:t,files:r,paginatedTotalNumFiles:o}})},e.prototype.addFilesAndSetLoadingState=function(e){var t=e.path,r=e.loadingState,o=e.files,s=e.paginatedTotalNumFiles;i.BrowseDispatcher.dispatch({type:a.BrowseActionType.ADD_FILES_AND_SET_LOADING_STATE,data:{path:t,loadingState:r,files:o,paginatedTotalNumFiles:s}})},e.prototype.setDataApi=function(e){this.dataApi=e},e})();t.BrowseNavActions=f,t.browseNavActions=new f(s)}),define("modules/clean/react/browse/sidebar_view",["require","exports","tslib","external/react","modules/clean/react/app_actions_view","modules/clean/react/browse/global_actions","modules/clean/react/browse/util","modules/clean/react/file_uploader/file_uploader","modules/core/i18n"],function(e,t,r,o,s,a,n,i,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(t){function c(e){var r=t.call(this,e)||this;return r.state={appActionsProps:r.getCurrentAppActionsProps(r.props)},r}return r.__extends(c,t),c.prototype.componentWillReceiveProps=function(e){e.selectedFiles===this.props.selectedFiles&&e.context===this.props.context&&e.user===this.props.user&&e.shouldShowDeletedFiles===this.props.shouldShowDeletedFiles&&e.isNoComment===this.props.isNoComment&&e.arePostTTIModulesLoaded===this.props.arePostTTIModulesLoaded&&e.viewType===this.props.viewType&&e.starredState===this.props.starredState&&e.isSearchMode===this.props.isSearchMode&&e.canDisplayFolderSizes===this.props.canDisplayFolderSizes&&e.responsive.isMatchedMedium===this.props.responsive.isMatchedMedium&&e.responsive.isMatchedLarge===this.props.responsive.isMatchedLarge&&e.uploaderExperiments===this.props.uploaderExperiments&&e.browseExperiments===this.props.browseExperiments&&e.browsePostTTIExperiments===this.props.browsePostTTIExperiments||this.setState({appActionsProps:this.getCurrentAppActionsProps(e)})},c.prototype.renderSingleSelectionAudienceBox=function(t){var r=t.selectedFiles,s=t.arePostTTIModulesLoaded,a=t.context,n=r.first();if(s){var i=e("modules/clean/react/browse/shared_with").SharedWithController;return o.createElement(i,{file:n,browseContext:a,isInAudienceBox:!0})}return null},c.prototype.getCurrentAppActionsProps=function(t){function r(e){return{displayName:e.label,popoverMenuName:e.popoverLabel,iconName:e.iconName,handleClick:e.performAction,disabled:e.disabled,className:e.className,badge:e.badge}}var s,i=t.selectedFiles,c=t.autoTeamGroupId,d=t.context,u=t.canDisplayFolderSizes,p=t.onGetFileActionsForFiles,h=t.user,m=t.shouldShowDeletedFiles,f=t.handleUploadButtonClick,_=t.isNoComment,S=t.uploaderExperiments,g=t.browseExperiments,w=t.browsePostTTIExperiments,v=t.arePostTTIModulesLoaded,b=t.handleComponentTTI,T=t.responsive,F=n.getSelectedFilesText(i,d),E=i.count(),y=o.createElement("div",null);if(E>0)s=p(i,u,T,!0),1===E&&(y=this.renderSingleSelectionAudienceBox(t));else if(s=a.getGlobalActions({context:d,user:h,showDeletedFiles:m,onUpload:f,isNoComment:_,autoTeamGroupId:c,uploaderExperiments:S,browseExperiments:g,browsePostTTIExperiments:w}),v){var R=e("modules/clean/react/browse/shared_with").SharedWithController;y=o.createElement(R,{browseContext:d,isInAudienceBox:!0})}var C=s.map(r);if(s.length>0&&s[0].subItems){var A=s[0].subItems.map(r);C[0]={displayName:s[0].label,iconName:s[0].iconName,handleClick:s[0].performAction,disabled:s[0].disabled,className:s[0].className,badge:s[0].badge,subItems:A}}return t.isNoComment&&(y=o.createElement("div",null)),{headerText:F,popoverTriggerLabel:l._("Actions"),primaryMenuItem:C[0],primarySubnode:y,secondaryMenuItems:C.slice(1),handleComponentTTI:b}},c.prototype.maybeRenderBrowseFileUploader=function(){var e=this.props,t=e.context,r=e.viewType,s=e.uploaderExperiments;return null!=t.currentFQPath?o.createElement(i.FileUploaderController,{key:"file-uploader-controller",ref:"fileUploader",loadOnRender:!1,needToSetStoreValues:!1,uploaderExperiments:s,browseViewType:r}):null},c.prototype.render=function(){return o.createElement("div",{className:"maestro-browse-action-sidebar"},this.maybeRenderBrowseFileUploader(),o.createElement(s.AppActionsView,r.__assign({},this.state.appActionsProps,{responsive:this.props.responsive})))},c})(o.PureComponent);t.BrowseSidebarView=c}),define("modules/clean/react/file_uploader/action_logger",["require","exports","tslib","modules/clean/filepath","modules/clean/web_upload_action_logger","modules/clean/web_user_action_logger","modules/clean/web_user_action_events"],function(e,t,r,o,s,a,n){"use strict";function i(e){return e&&!!e.uploadId}function l(e){return e&&!!e.lastModifiedDate}function c(e){return e===n.WebUserActionLogEvent.UPLOAD_BUTTON_CLICK||e===n.WebUserActionLogEvent.ADD_MORE_FILES_CLICK||e===n.WebUserActionLogEvent.VIEW_DETAILS_CLICK||e===n.WebUserActionLogEvent.CLOSE_MODAL_CLICK||e===n.WebUserActionLogEvent.DISMISS_INLINE_STATUS||e===n.WebUserActionLogEvent.UPLOAD_CLICK||e===n.WebUserActionLogEvent.UPLOAD_FILES_CLICK||e===n.WebUserActionLogEvent.UPLOAD_FOLDER_CLICK}function d(e,t,n,d,u,p,h){var m={num_files:p,num_dirs:h,chooser_type:d,upload_method:u};if(i(n)){var f=n;m=r.__assign({},m,{upload_id:f.uploadId,file_size:f.size,file_extension:o.file_extension(f.name),failure_reason:f.errorType})}else if(l(n)){var f=n;m=r.__assign({},m,{file_size:f.size,file_extension:o.file_extension(f.name)})}c(t)?a.WebUserActionLog.log(e,t,m):(t=t,m.client_timestamp=Math.round(Date.now()/1e3),s.WebUploadActionLog.log(e,t,m))}Object.defineProperty(t,"__esModule",{value:!0}),t.logUploadAction=d}),define("modules/clean/react/file_uploader/constants",["require","exports","tslib","external/immutable","modules/core/browser"],function(e,t,r,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e.SET_PATH="UPLOADER_SET_PATH",e.SET_FOLDER_NS_ID="UPLOADER_SET_FOLDER_NS_ID",e.SET_USER="UPLOADER_SET_USER",e.SET_NUM_DRAGGING_FILES="SET_NUM_DRAGGING_FILES",e.QUEUE_UPLOADS="QUEUE_UPLOADS",e.START_UPLOAD="START_UPLOAD",e.COMPLETE_UPLOAD="COMPLETE_UPLOAD",e.CANCEL_UPLOADS="CANCEL_UPLOADS",e.SET_CURRENT_UPLOAD_PROGRESS="SET_CURRENT_UPLOAD_PROGRESS",e.UPLOAD_ERROR="UPLOAD_ERROR",e.SET_IS_UPLOAD_MODAL_OPEN="SET_IS_UPLOAD_MODAL_OPEN",e.SET_INLINE_STATUS_SHOULD_BE_DISMISSED="SET_INLINE_STATUS_SHOULD_BE_DISMISSED",e.ADD_NEW_FAILED_FILE="ADD_NEW_FAILED_FILE",e.CONFIRM_FSW="CONFIRM_FSW",e.ADD_FILES_TO_PLU="ADD_FILES_TO_PLU",e.ADD_DIRECTORIES_TO_PLU="ADD_DIRECTORIES_TO_PLU",e.REMOVE_FILES="REMOVE_FILES"})(t.UploaderActionType||(t.UploaderActionType={}));var a;(function(e){e.PENDING="PENDING",e.UPLOADING="UPLOADING",e.COMPLETE="COMPLETE",e.CANCELLED="CANCELLED",e.FAILED="FAILED"})(a=t.FileStatusType||(t.FileStatusType={}));var n;(function(e){e.FILE_SIZE_ERROR="FILE_SIZE_ERROR",e.HTTP_ERROR="HTTP_ERROR",e.CONNECTION_ERROR="CONNECTION_ERROR",e.OVER_QUOTA_ERROR="OVER_QUOTA_ERROR",e.LOCKED_TEAM_ERROR="LOCKED_TEAM_ERROR",e.IGNORED="IGNORED",e.EMPTY_OR_FOLDER="EMPTY_OR_FOLDER",e.FOLDER_SAFARI="FOLDER_SAFARI",e.PACKAGE_FILE="PACKAGE_FILE",e.GENERIC="GENERIC"})(n=t.UploadErrorType||(t.UploadErrorType={}));(function(e){e.NONE="NONE",e.BASIC_OVER_QUOTA="BASIC_OVER_QUOTA",e.BASIC_NEAR_QUOTA="BASIC_NEAR_QUOTA",e.LIMITED_TEAM_USER_OVER_QUOTA="LIMITED_TEAM_USER_OVER_QUOTA",e.LIMITED_TEAM_TSD_OVER_QUOTA="LIMITED_TEAM_TSD_OVER_QUOTA",e.LOCKED_TEAM_USER_OVER_QUOTA="LOCKED_TEAM_USER_OVER_QUOTA"})(t.OverQuotaStatusType||(t.OverQuotaStatusType={}));var i=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t})(o.Record({uploadId:void 0,dest:"",ns_id:null,ns_path:null,userId:null,name:"",size:0,percentUploaded:0,status:a.PENDING,errorType:n.GENERIC,errorMessage:""},"FileUpload"));t.FileUpload=i,t.INTERNAL_FILE_DATA_TRANSFER_TYPE=s.msie?"text":s.edge?"text/plain":"application/x-dropbox-file-list",t.UPLOAD_BEGIN_EVENT="dbxUploadBegin",t.UPLOAD_CANCEL_EVENT="dbxUploadCancel",t.UPLOAD_COMPLETE_EVENT="dbxUploadComplete",t.ALL_UPLOADS_COMPLETE_EVENT="dbxAllUploadsComplete",t.UPLOAD_ERROR_EVENT="dbxUploadError",t.EXP_WEB_LARGER_CHUNKS_DEFAULT="OFF"}),define("modules/clean/react/file_uploader/store",["require","exports","tslib","external/immutable","modules/clean/flux/base_store","modules/clean/react/browse/constants","modules/clean/react/file_uploader/constants","modules/clean/react/file_uploader/utils","modules/core/exception"],function(e,t,r,o,s,a,n,i,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype._init=function(){this._path="/",this._hasPermissionToUploadToFolder=!0,this._folderNsId=null,this._user=null,this._fileList=o.OrderedMap(),this._currentUploadId=null,this._numDraggingFiles=0,this._isInternalTransfer=!1,this._isUploadModalOpen=!1,this._inlineStatusShouldBeDismissed=!1,this._numSecondsLeft=0,this._confirmedFSWs=[]},t.prototype.fileList=function(){return this._fileList},t.prototype.currentUpload=function(){var e=this._currentUploadId;if(!e)return null;var t=this._fileList.get(e);return t?t:null},t.prototype.numSecondsLeft=function(){return this._numSecondsLeft},t.prototype.isUploadCancelled=function(e){var t=this._fileList.get(e);return!!t&&t.status===n.FileStatusType.CANCELLED},t.prototype.inlineStatusShouldBeDismissed=function(){return this._inlineStatusShouldBeDismissed},t.prototype.path=function(){return this._path},t.prototype.folderNsId=function(){return this._folderNsId},t.prototype.hasPermissionToUploadToFolder=function(){return this._hasPermissionToUploadToFolder},t.prototype.user=function(){return this._user},t.prototype.nextUpload=function(){return this._fileList.find(function(e){return e.status===n.FileStatusType.PENDING})},t.prototype.numDraggingFiles=function(){return this._numDraggingFiles},t.prototype.isInternalTransfer=function(){return this._isInternalTransfer},t.prototype.isUploadModalOpen=function(){return this._isUploadModalOpen},t.prototype.confirmedFSWs=function(){return this._confirmedFSWs},t.prototype.setUser=function(e){var t=e.user;this._user=t,this.emit_change()},t.prototype.setBrowsePath=function(e){var t=e.path;this._path=t,this.emit_change()},t.prototype.setPath=function(e){var t=e.path,r=e.hasPermissionToUploadToFolder,o=void 0===r||r;this._path=t,this._hasPermissionToUploadToFolder=o,this._confirmedFSWs=[],this.emit_change()},t.prototype.setFolderNsId=function(e){var t=e.folderNsId;this._folderNsId=t},t.prototype.initializeEverything=function(e){var t=e.user,r=e.path,o=e.context;this._user=t,this._path=r,this._hasPermissionToUploadToFolder=o.isCurrentPathWriteable(),this.emit_change()},t.prototype.queueUploads=function(e){for(var t=e.files,r={},o=0,s=t;o<s.length;o++){var a=s[o];r[a.uploadId]=a}this._fileList=this._fileList.merge(r),this.emit_change()},t.prototype.startUpload=function(e){var t=e.file;l.assert(null==this.currentUpload(),"can't start an unload while one is ongoing"),l.assert(null!=t,"missing file to upload"),l.assert(this._fileList.get(t.uploadId)===t,"failed to find file in file list"),this._fileList.get(t.uploadId)&&(this._fileList=this._fileList.update(t.uploadId,function(e){return e.set("status",n.FileStatusType.UPLOADING)}),this._currentUploadId=t.uploadId),this.emit_change()},t.prototype.completeUpload=function(e){var t=e.uploadId,r=this._fileList.get(t);r&&(t===this._currentUploadId&&r.status===n.FileStatusType.UPLOADING||l.reportStack("Tried to mark a file upload that is not currently uploading as complete",{exc_extra:{file:r.toString(),fileListLength:this._fileList.count(),uploadId:t,currentUploadId:this._currentUploadId}}),this._fileList=this._fileList.update(t,function(e){return e.set("status",n.FileStatusType.COMPLETE)})),this._currentUploadId=null,this.emit_change()},t.prototype.cancelUploads=function(e){for(var t=e.files,r=0,o=t;r<o.length;r++){var s=o[r];this._fileList=this._fileList.update(s.uploadId,function(e){return e.status===n.FileStatusType.PENDING||e.status===n.FileStatusType.UPLOADING?e.set("status",n.FileStatusType.CANCELLED):e}),s.uploadId===this._currentUploadId&&(this._currentUploadId=null)}this.emit_change()},t.prototype.setCurrentUploadProgress=function(e){var t=e.percentComplete,r=e.numSecondsLeft,o=this._currentUploadId;o&&(this._fileList=this._fileList.update(o,function(e){return e.set("percentUploaded",t)}),this._numSecondsLeft=r),this.emit_change()},t.prototype.handleUploadError=function(e){var t=e.uploadId,r=e.errorType,o=e.errorMessage,s=this._fileList.get(t);s&&(s.uploadId!==this._currentUploadId&&l.reportStack("Error reported for file upload that is not the current upload",{exc_extra:{file:s.toString(),fileListLength:this._fileList.count(),errorType:r,errorMessage:o}}),this._fileList=this._fileList.update(s.uploadId,function(e){return e.set("status",n.FileStatusType.FAILED).set("errorType",r).set("errorMessage",o)})),this._currentUploadId=null,this.emit_change()},t.prototype.setNumDraggingFiles=function(e){var t=e.numDraggingFiles,r=e.isInternalTransfer,o=void 0!==r&&r;this._numDraggingFiles=t,this._isInternalTransfer=o,this.emit_change()},t.prototype.setIsUploadModalOpen=function(e){var t=e.isUploadModalOpen;this._isUploadModalOpen=t,this.emit_change()},t.prototype.setInlineStatusShouldBeDismissed=function(e){var t=e.inlineStatusShouldBeDismissed;this._inlineStatusShouldBeDismissed=t,this.emit_change()},t.prototype.addNewFailedFile=function(e){var t=e.file,r=e.errorType,o=e.errorMessage;null==t.uploadId&&(t=t.set("uploadId",i.generateUploadId())),t=t.set("status",n.FileStatusType.FAILED).set("errorType",r).set("errorMessage",o),this._fileList=this._fileList.set(t.uploadId,t),this.emit_change()},t.prototype.confirmFSW=function(e){var t=this;return e.fswIds.forEach(function(e){t._confirmedFSWs.includes(e)||t._confirmedFSWs.push(e)})},t.prototype._new_payload=function(e){var t=e.action;switch(t.type){case a.BrowseActionType.INITIALIZE_EVERYTHING:this.initializeEverything(t.data);break;case a.BrowseActionType.SET_USER:case n.UploaderActionType.SET_USER:this.setUser(t.data);break
;case a.BrowseActionType.SET_PATH:this.setBrowsePath(t.data);break;case n.UploaderActionType.SET_PATH:this.setPath(t.data);break;case n.UploaderActionType.SET_FOLDER_NS_ID:this.setFolderNsId(t.data);break;case n.UploaderActionType.QUEUE_UPLOADS:this.queueUploads(t.data);break;case n.UploaderActionType.START_UPLOAD:this.startUpload(t.data);break;case n.UploaderActionType.COMPLETE_UPLOAD:this.completeUpload(t.data);break;case n.UploaderActionType.CANCEL_UPLOADS:this.cancelUploads(t.data);break;case n.UploaderActionType.SET_CURRENT_UPLOAD_PROGRESS:this.setCurrentUploadProgress(t.data);break;case n.UploaderActionType.UPLOAD_ERROR:this.handleUploadError(t.data);break;case n.UploaderActionType.SET_NUM_DRAGGING_FILES:this.setNumDraggingFiles(t.data);break;case n.UploaderActionType.SET_IS_UPLOAD_MODAL_OPEN:this.setIsUploadModalOpen(t.data);break;case n.UploaderActionType.SET_INLINE_STATUS_SHOULD_BE_DISMISSED:this.setInlineStatusShouldBeDismissed(t.data);break;case n.UploaderActionType.ADD_NEW_FAILED_FILE:this.addNewFailedFile(t.data);break;case n.UploaderActionType.CONFIRM_FSW:this.confirmFSW(t.data)}},t})(s.Store);t.UploaderStoreClass=c,t.uploaderStore=new c}),define("modules/clean/react/file_uploader/utils",["require","exports","modules/clean/base64","modules/clean/react/file_uploader/constants","modules/core/browser"],function(e,t,r,o,s){"use strict";function a(){for(var e="",t=0;t<16;++t)e+=String.fromCharCode(Math.floor(256*Math.random()));var o=r.encode(e);return o=o.replace(/\+/g,"-"),o=o.replace(/\//g,"_"),o=o.replace(/\=*$/,"")}function n(e){var t=e.fileList,r=e.uploadId;return!!t.find(function(e){return e.status in[o.FileStatusType.PENDING,o.FileStatusType.UPLOADING]&&e.uploadId!==r})}function i(e,t){var r=0;return e.forEach(function(e){t.indexOf(e.status)!==-1&&(r+=e.size)}),r}function l(e){var t="8mb",r=/^([0-9]+)mb$/i.exec(e);if(r&&2===r.length){var o=Number(r[1]);o>0&&o%4===0&&(t=o+"mb")}return t}function c(e,t,r){var o=t,s=0;return e.forEach(function(e,t){for(var a=0,n=e.split("/"),i=r.split("/");a<n.length&&a<i.length&&n[a]===i[a];)a++;a===n.length&&a>1&&a>s&&(s=a,o=Number(t))}),o}Object.defineProperty(t,"__esModule",{value:!0}),t.generateUploadId=a,t.checkIfThereArePendingUploadsWithoutCurrent=n,t.calculateSizeOfUploads=i,t.parseChunkSize=l,t.getNsId=c,t.getOQmodalOQALocationCode=function(e){return"/h"===(e||s.get_uri().path)?"ho":"fb"}}),define("modules/clean/react/fileops_actions",["require","exports","tslib","modules/core/notify","modules/core/i18n","modules/clean/react/async_file_modal_controller","modules/clean/file_operations/notifications","modules/clean/react/browse/api"],function(e,t,r,o,s,a,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.copyFiles=function(e){var o=e.files,l=e.newPath,c=e.checkFSWs,d=e.onSuccess,u=e.onRequestNotSent,p=e.onUndo,h=e.user,m=e.dataApi;!(void 0===m?i:m).copyFiles({files:o,newPath:l,checkFSWs:c,userId:h.id,onSuccess:function(i){var c=i.newFiles,u=i.changesets,m=i.rollbackHints,f=i.failureDetails;if(f){var _=function(){t.copyFiles(r.__assign({},e,{checkFSWs:!1}))};a.showFileSystemWarningsModal({fsws:f,onFinalAccept:_,confirmText:s._("Copy")})}else d&&d(c),n.notifyCopySuccess(o.length,h,u,l,m,function(){p&&p()})}})&&u&&u()},t.moveFiles=function(e){var l=e.path,c=e.files,d=e.newPath,u=e.checkFSWs,p=e.onSuccess,h=e.onRequestNotSent,m=e.onUndo,f=e.user,_=e.dataApi,S=void 0===_?i:_,g=function(o){var i=o.newFiles,l=o.changesets,u=o.rollbackHints,h=o.failureDetails;if(h){var _=function(){t.moveFiles(r.__assign({},e,{checkFSWs:!1}))};a.showFileSystemWarningsModal({fsws:h,onFinalAccept:_,confirmText:s._("Move")})}else n.notifyMoveSuccess(c.length,f,l,d,u,function(){m&&m()}),p&&p(i)},w=function(e){"This will result in losing ownership of these folders."===e&&(o.Notify.clear(),a.showConfirmOwnershipTransferModal(function(){S.moveFiles({path:l,files:c,newPath:d,userId:f.id,onSuccess:g,allowOwnershipTransfer:!0})}))};!S.moveFiles({path:l,files:c,newPath:d,checkFSWs:u,userId:f.id,onSuccess:g,onError:w,allowOwnershipTransfer:!1})&&h&&h()}}),define("modules/clean/react/files_view/column_header",["require","exports","tslib","external/classnames","spectrum/checkbox","spectrum/table","external/react","modules/clean/react/files_view/column_header_menu","modules/clean/react/files_view/fixed_table_head","modules/clean/react/files_view/sticky_table_head","modules/clean/react/files_view/view_type_column_header_menu","modules/clean/react/files_view/types","modules/clean/react/files_view/constants"],function(e,t,r,o,s,a,n,i,l,c,d,u,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={isHovered:!1},t.handleChangeSelectAllCheckbox=function(e){"unchecked"===e?t.props.onDeselectAll():t.props.onSelectAll()},t.handleMouseEnter=function(){t.setState({isHovered:!0})},t.handleMouseLeave=function(){t.setState({isHovered:!1})},t}return r.__extends(t,e),t.prototype.getAriaSortValue=function(e){return e===u.SortDirection.ASCENDING?"ascending":e===u.SortDirection.DESCENDING?"descending":"none"},t.prototype.render=function(){var e=this,t=this.state.isHovered,h=this.props,m=h.columnFlex,f=h.isCompactMode,_=h.isSelectMode,S=h.isSticky,g=h.isTabbing,w=h.currentSort,v=h.onSelection,b=h.onSort,T=h.onSwitchViewType,F=h.selectAllCheckboxState,E=void 0===F?"unchecked":F,y=h.stickyOffsetHeight,R=h.stickyOffsetTop,C=h.visibleColumns,A=h.viewType,I=h.viewTypes,P=h.onTTI,N=!(g||_||t||f),D=[n.createElement(a.TableHeadCell,{className:"brws-column-header-table-cell brws-checkbox-cell",key:"checkbox-cell",role:"columnheader",scope:"col"},n.createElement("div",{className:"brws-vertically-center"},n.createElement(s.Checkbox,{className:o("brws-checkbox",{"brws-checkbox-checked":"checked"===E}),checked:E,onChange:this.handleChangeSelectAllCheckbox,variant:N?"invisible":"default"})))].concat(C.map(function(t,r){var o=w&&w.sortField===t.sortField?w.sortDirection:void 0;return n.createElement(a.TableHeadCell,{key:r,role:"columnheader",scope:"col","aria-sort":e.getAriaSortValue(o),className:"brws-column-header-table-cell"},n.createElement(i.ColumnHeaderMenu,{column:t,sortDirection:o,columns:A===u.ViewType.List?p.LIST_VIEW_COLUMNS:p.GRID_VIEW_COLUMNS,visibleColumns:C,onSelection:v,onSort:b,viewType:A}),r===C.length-1&&n.createElement(d.ViewTypeColumnHeaderMenu,{onTTI:P,viewType:A,viewTypes:I,onSwitchViewType:T}))})),x={offsetHeight:y,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave};return S?n.createElement(c.StickyTableHead,r.__assign({columnFlex:m,offsetTop:R,className:"brws-column-header"},x),D):n.createElement(l.FixedTableHead,r.__assign({},x),D)},t})(n.PureComponent);t.ColumnHeader=h}),define("modules/clean/react/files_view/column_header_menu",["require","exports","tslib","external/classnames","spectrum/icon_form","spectrum/popover","external/react","modules/clean/react/files_view/types","modules/core/i18n"],function(e,t,r,o,s,a,n,i,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handlePopoverSelection=function(e){var r=t.props,o=r.onSort,s=r.onSelection,a=r.column;e===i.SortDirection.ASCENDING||e===i.SortDirection.DESCENDING?o(a.sortField,e):(s(e,a),1===t.props.visibleColumns.length&&o(e.sortField,t.props.sortDirection||i.SortDirection.ASCENDING))},t}return r.__extends(t,e),t.prototype._columnMenuTitle=function(){switch(this.props.viewType){case i.ViewType.Grid:case i.ViewType.LargeGrid:return l._("Group by");case i.ViewType.List:default:return l._("Show")}},t.prototype.render=function(){var e=this.props,t=e.column,r=e.columns,c=e.visibleColumns,d=e.sortDirection;if(t.isSortDisabled)return n.createElement("div",{className:"normal brws-column-header-menu"},n.createElement("span",{className:"brws-column-header-menu-trigger-disabled"},t.label));var u;!t.isLocked&&r&&r.length&&(u=[n.createElement(a.PopoverItemGroupSeparator,{key:"show-separator"}),n.createElement(a.PopoverItemGroup,{key:"show-item-group"},n.createElement(a.PopoverItemGroupTitle,{className:"brws-column-header-menu-title",key:"show-title"},this._columnMenuTitle()),r.filter(function(e){return!e.isLocked}).map(function(e){return n.createElement(a.PopoverSelectableItem,{key:e.sortField,disabled:c.map(function(e){return e.sortField}).includes(e.sortField)&&e.sortField!==t.sortField,selected:e.sortField===t.sortField,value:e},e.label)}))]);var p=d===i.SortDirection.ASCENDING?"sort-arrow-up":d===i.SortDirection.DESCENDING?"sort-arrow-down":"caret-down";return n.createElement(a.Popover,{className:"brws-column-header-menu",onSelection:this.handlePopoverSelection},n.createElement(a.PopoverTrigger,{className:o("brws-column-header-menu-trigger",{"brws-column-header-menu-trigger-active":!!d}),title:t.popoverTriggerLabel},n.createElement("span",null,t.label),n.createElement("span",{className:"brws-column-header-menu-label-icon-wrapper"},n.createElement(s.IconForm,{className:"brws-column-header-menu-label-icon",name:p}))),n.createElement(a.PopoverContent,null,n.createElement(a.PopoverItemGroup,null,n.createElement(a.PopoverItemGroupTitle,{className:"brws-column-header-menu-title"},l._("Order")),n.createElement(a.PopoverSelectableItem,{selected:d===i.SortDirection.ASCENDING,value:i.SortDirection.ASCENDING},l._("Ascending")),n.createElement(a.PopoverSelectableItem,{selected:d===i.SortDirection.DESCENDING,value:i.SortDirection.DESCENDING},l._("Descending"))),u))},t})(n.PureComponent);t.ColumnHeaderMenu=c}),define("modules/clean/react/files_view/column_manager",["require","exports","tslib","external/react","modules/clean/immutability_helper","modules/clean/react/files_view/types"],function(e,t,r,o,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(e){function t(t){var r=e.call(this,t)||this;return r.handleSelection=function(e,t){var o=r.props,n=o.viewType,i=o.onColumnsChanged,l=o.viewTypeColumns,c=r.state.visibleColumns,d=l?l[a.ViewType.List]:void 0,u=l?l[a.ViewType.Grid]:void 0;if(d&&u){var p=c.indexOf(t);if(p===-1||c.includes(e))r.changeVisibleColumns(c);else{var h=s.splice(c,p,1,e);r.changeVisibleColumns(h);var m=r.isSizeColumnPresent(h);n===a.ViewType.List?i(r.swapColumns(d,t.sortField,e.sortField),a.ViewType.List,m):(i(r.swapColumns(u,t.sortField,e.sortField),n,m),e.sortField!==a.SortField.FILENAME&&i(r.swapColumns(d,d[1].sortField,e.sortField),a.ViewType.List,m))}}},r}return r.__extends(t,e),t.prototype.componentWillMount=function(){this.changeVisibleColumns(this.computeVisibleColumns(this.props),!0)},t.prototype.componentWillReceiveProps=function(e){var t=this.props.viewTypeColumns,r=this.state.visibleColumns,o=this.getNumVisibleColumns(this.props),s=this.getNumVisibleColumns(e);if(this.props.columns!==e.columns)if(1===s&&e.columns.length&&e.currentSort){var n=e.columns,i=e.viewType,l=t?t[a.ViewType.Grid]:void 0;if(i===a.ViewType.List)this.changeVisibleColumns([n[0]],!0);else if(l&&i===a.ViewType.Grid){var c=e.currentSort,d=n.find(function(e){return e.sortField===c.sortField}),u=d||n[0];this.deferredOnColumnsChangedHandler([u],this.swapColumns(l,l[0].sortField,u.sortField),a.ViewType.Grid)}}else this.changeVisibleColumns(e.columns.slice(0,s),!0);else if(s<o)this.changeVisibleColumns(r.slice(0,s),!0);else if(s>o){var n=this.props.columns,p=s-r.length,h=[];n.forEach(function(e){h.length<p&&!r.includes(e)&&h.push(e)}),this.changeVisibleColumns(r.concat(h),!0)}},t.prototype.changeVisibleColumns=function(e,t){var r=this;void 0===t&&(t=!1),this.resetChangeVisibleColumnsTimeout();var o=this.isSizeColumnPresent(e);this.setState({visibleColumns:e,canDisplayFolderSizes:o}),t?this.changeVisibleColumnsTimeout=setTimeout(function(){r.resetChangeVisibleColumnsTimeout(),r.props.onCanDisplayFolderSizesChanged(o)}):this.props.onCanDisplayFolderSizesChanged(o)},t.prototype.resetChangeVisibleColumnsTimeout=function(){this.changeVisibleColumnsTimeout&&(clearTimeout(this.changeVisibleColumnsTimeout),this.changeVisibleColumnsTimeout=void 0)},t.prototype.deferredOnColumnsChangedHandler=function(e,t,r){var o=this;this.resetDeferredOnColumnsChangedHandler();var s=this.isSizeColumnPresent(e);this.setState({visibleColumns:e,canDisplayFolderSizes:s}),this.onColumnsChangesTimeout=setTimeout(function(){o.resetDeferredOnColumnsChangedHandler(),o.props.onColumnsChanged(t,r,s)})},t.prototype.resetDeferredOnColumnsChangedHandler=function(){this.onColumnsChangesTimeout&&(clearTimeout(this.onColumnsChangesTimeout),this.onColumnsChangesTimeout=void 0)},t.prototype.swapColumns=function(e,t,r){var o=e.map(function(e){return e.sortField}).indexOf(t),a=e.map(function(e){return e.sortField}).indexOf(r);if(o===a||o===-1||a===-1)return e;var n=e[o],i=e[a];return s.splice(s.splice(e,o,1,i),a,1,n)},t.prototype.computeVisibleColumns=function(e){return e.columns.slice(0,this.getNumVisibleColumns(e))},t.prototype.getNumVisibleColumns=function(e){var t=e.isMatchedLarge,r=e.isMatchedMedium,o=e.isSearchMode;switch(e.viewType){case a.ViewType.Grid:case a.ViewType.LargeGrid:return 1;case a.ViewType.List:default:return t?o?2:3:r?2:1}},t.prototype.isSizeColumnPresent=function(e){return e.some(function(e){return e.sortField===a.SortField.SIZE})},t.prototype.render=function(){var e=this.props.children,t=this.state,r=t.visibleColumns,o=t.canDisplayFolderSizes;if(!e)return null;var s=e;return"function"==typeof e&&(s=e({visibleColumns:r,canDisplayFolderSizes:o,handleSelection:this.handleSelection})),s},t})(o.PureComponent);t.ColumnManager=n}),define("modules/clean/react/files_view/controller",["require","exports","tslib","external/classnames","external/immutable","spectrum/media_table_skeleton","spectrum/table","external/react","external/react-dom","external/lodash","modules/clean/react/files_view/types","modules/clean/react/files_view/drag_and_drop","modules/clean/react/files_view/file_list_empty_folder_table","modules/clean/react/files_view/column_header","modules/clean/react/files_view/column_manager","modules/clean/react/files_view/constants","modules/clean/react/files_view/list","modules/clean/react/files_view/pinned_team_folder_view","modules/clean/react/files_view/selectable_list","modules/clean/react/files_view/selectors","modules/clean/react/files_view/tile_grid","modules/clean/react/files_view/internal_drag_status","modules/clean/react/browse/models","modules/clean/react/file_uploader/constants","modules/clean/user_education/user_education_client","modules/clean/web_timing_logger","modules/core/i18n","modules/core/notify","modules/clean/sharing/access_level","modules/clean/search/search_results/log_helper","modules/core/browser","modules/clean/web_user_action_events","modules/clean/photos/thumb_loading/buffered_thumb_store","modules/clean/photos/thumb_loading/generic_thumb_store"],function(e,t,r,o,s,a,n,i,l,c,d,u,p,h,m,f,_,S,g,w,v,b,T,F,E,y,R,C,A,I,P,N,D,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var L=function(){},M=[A.NameSpaceAccess.ACCESS_NO_ACCESS,A.NameSpaceAccess.ACCESS_READER,A.NameSpaceAccess.ACCESS_READER_NO_COMMENT],O=[{moduleName:"cdm_new_team_creator_v2",stepName:"start"},{moduleName:"cdm_new_team_joiner_v2",stepName:"start"},{moduleName:"uj_housewarming_v1",stepName:"start"},{moduleName:"uj_housewarming_v2",stepName:"start"},{moduleName:"uj_housewarming_v5",stepName:"start"},{moduleName:"ncct_uj_housewarming_v5",stepName:"start"},{moduleName:"trial_admin_setup_team_space",stepName:"team_space_tooltip"},{moduleName:"trial_admin_setup_team_space_v2",stepName:"team_space_tooltip"},{moduleName:"biz_onboarding_tour_rwl_copy_creator_v1",stepName:"start"},{moduleName:"biz_onboarding_tour_rwl_copy_joiner_v1",stepName:"start"},{moduleName:"biz_trial_onboarding_creator_no_tf",stepName:"start"},{moduleName:"biz_trial_onboarding_joiner_no_tf",stepName:"start"}],U=(function(t){function A(){var e=null!==t&&t.apply(this,arguments)||this;return e.gridViewPrewarmedThumbnailRequestIds=[],e.state={thumbStore:new D.BufferedThumbStore,isTabbing:!1,keyboardShortcutModalHandler:function(){e.setState({shouldShowKeyboardShortcutModal:!0})}},e.handleOpenPaper=function(t,r){e.props.isSearchMode&&I.recordSearchResultsAction({result:r,user:e.props.user,action_type:N.WebUserActionLogEvent.PAPER_OPEN,view_type:e.props.viewType}),P.mac&&t.metaKey||!P.mac&&t.ctrlKey?P.open_tab(r.url):P.redirect(r.url)},e.handleMouseDownBody=function(){e.setState({isTabbing:!1})},e.handleKeyDownBody=function(t){9===t.keyCode&&e.setState({isTabbing:!0})},e.handleTabbingStart=function(){e.setState({isTabbing:!0})},e.handleCopyToClipboard=function(){var t=e.props,r=t.selectedFiles,o=t.onCopyToClipboard;r.size&&o(r.toArray())},e.handleNewFolderSubmit=function(t){""===t?(e.props.onNewFolderCancel(),e.handleNewFolderCancel({source:d.NameInputActionSource.SUBMIT})):e.props.onNewFolderSubmit(t)},e.handleNewFolderCancel=function(t){t.source!==d.NameInputActionSource.ESC&&C.Notify.error(R._("Please provide a name for the new folder.")),e.props.onNewFolderCancel()},e.handleSetFileUploaderPath=function(t){var r=t?t.path:e.props.path,o=e.props.context.isCurrentPathWriteable();t&&t.hasOwnProperty("hasPermissionToUploadToFolder")&&(o=!!t.hasPermissionToUploadToFolder),e.props.setFileUploaderPath({path:r,hasPermissionToUploadToFolder:o})},e.handleDragStart=function(t,o){void 0===o&&(o=[]);var s=e.props,a=s.path,n=s.selectedFiles,i=s.user,d=c.keyBy(o,"fq_path");d=r.__assign({},d,n.toJS());var u=c.values(d);if(u.some(function(e){return T.File.isTeamSharedFolder(e)}))return void C.Notify.error(R._("Team folders can’t be moved."));if(u.some(function(e){return T.File.isTeamMemberFolder(e)}))return void C.Notify.error(R._("Your member folder can’t be moved."));var p=t.dataTransfer;p&&(p.setDragImage&&e.internalDragStatusRef&&p.setDragImage(l.findDOMNode(e.internalDragStatusRef),-10,-10),p.setData(F.INTERNAL_FILE_DATA_TRANSFER_TYPE,JSON.stringify({userId:i.id,fromPath:a,filePaths:u.map(function(e){return e.fq_path})})),p.effectAllowed="copyMove")},e.handleDragEnter=function(t,r,o,s){u.onFileDragEnterItem(r,!!e.props.isDraggingExternalFiles,!!e.props.isDraggingInternalFiles,o,s,e.props.context,e.props.onSetDropTarget,e.handleSetFileUploaderPath)},e.handleSelectionChange=function(t){E.UEClient.sendEvent("FileItemRow","CheckboxToggled"),e.props.onSelectionChange(t)},e.handleDeselectAll=function(){var t=e.props,r=t.selection;(0,t.onSelectionChange)(r.set("selected",s.OrderedSet()))},e.handleSelectAll=function(){var t=e.props,r=t.items,o=t.selection;(0,t.onSelectionChange)(o.set("selected",s.OrderedSet(r.filter(A.canSelectItem).map(function(e){return e.fq_path}))))},e._handleGetOverflowMenuActions=function(t,r){var o=e.props;return(0,o.getOverflowMenuActions)(t,r,o.responsive)},e.handleTTI=function(){e.props.onComponentTTI("FilesViewController")},e.setFilesViewTileGridRef=function(t){e.filesViewTileGridRef=t},e.setInternalDragStatusRef=function(t){e.internalDragStatusRef=t},e.getIsCurrentPathWriteable=function(){return e.props.context.isCurrentPathWriteable()},e}return r.__extends(A,t),A.prototype.componentDidMount=function(){var t=this;this.setupUnity(),document.addEventListener("keydown",this.handleKeyDownBody),document.addEventListener("mousedown",this.handleMouseDownBody),E.UEClient.registerBulkCallbackForEducationStep(O,function(){t.props.onSwitchViewType(d.ViewType.List)}),y.waitForTTI().then(function(){t.prewarmGridViewThumbStore();var r=function(e){var r=e.showKeyboardShortcutsModal;t.state.shouldShowKeyboardShortcutModal&&r(t.props.viewType===d.ViewType.List),t.setState({keyboardShortcutModalHandler:function(){r(t.props.viewType===d.ViewType.List)},shouldShowKeyboardShortcutModal:!1})};r.perfName="keyboard_shortcuts_modal",e(["modules/clean/react/files_view/keyboard_shortcuts_modal"],r)})},A.prototype.componentWillReceiveProps=function(e){if(e.context&&this.props.context&&e.context.currentFQPath!==this.props.context.currentFQPath){this.undoPrewarmGridViewThumbStore();var t=this.props.arePostTTIModulesLoaded?new x.GenericThumbStore:new D.BufferedThumbStore;this.setState({thumbStore:t})}},A.prototype.componentDidUpdate=function(e){e.context&&this.props.context&&e.context.currentFQPath!==this.props.context.currentFQPath&&this.prewarmGridViewThumbStore(),this.props.enableUnity&&e.items!==this.props.items&&this.triggerUnityChangeCallback&&this.triggerUnityChangeCallback(),e.path!==this.props.path&&this.handleScrollToTop()},A.prototype.componentWillUnmount=function(){this.triggerUnityChangeCallback=void 0,document.removeEventListener("keydown",this.handleKeyDownBody),document.removeEventListener("mousedown",this.handleMouseDownBody)},A.prototype.setupUnity=function(){return r.__awaiter(this,void 0,void 0,function(){var t,o=this;return r.__generator(this,function(r){switch(r.label){case 0:return[4,y.waitForTTI()];case 1:return r.sent(),[4,e(["modules/clean/unity_browse_interface"])];case 2:return t=r.sent()[0],this.triggerUnityChangeCallback=function(){t.browse_visible_change_callback(o.props.items.toArray(),o.props.user.id,0,o.props.items.size-1)},[2]}})})},A.prototype.prewarmGridViewThumbStore=function(){var e=this;if(this.props.viewType!==d.ViewType.Grid){var t=this.state.thumbStore;this.props.items.slice(0,100).forEach(function(r){if(r instanceof T.File){var o=v.getThumbnailUrlForItem(r,f.ViewTypeThumbnailSizes[d.ViewType.Grid]);if(o){var s=t.bind_url(o,{onSuccess:L});s&&e.gridViewPrewarmedThumbnailRequestIds.push(s)}}})}},A.prototype.undoPrewarmGridViewThumbStore=function(){var e=this;this.gridViewPrewarmedThumbnailRequestIds.length&&(this.gridViewPrewarmedThumbnailRequestIds.forEach(function(t){e.state.thumbStore.unbind_url(t)}),this.gridViewPrewarmedThumbnailRequestIds=[])},A.prototype.handleScrollToTop=function(){window.scrollTo(0,0)},A.prototype.getFilesViewTileGridRef=function(){return this.filesViewTileGridRef},A.prototype.renderEmptyFolderView=function(){var e=this.props,t=e.context,r=e.responsive;if(this.props.customEmptyFolderView)return this.props.customEmptyFolderView(r);var o=t.isInsideSharedFolder,s=t.currentSharedFolderPermissionRole,a=o&&M.includes(s),n=a?void 0:R._("Drag and drop files onto this window to upload.");return i.createElement(p.EmptyFolderTable,{title:R._("This folder is empty"),subtitle:n,onTTI:this.handleTTI})},A.prototype.renderPinnedTeamFolderView=function(e){var t=this.props,r=t.activeDropTarget,o=t.context,s=t.dropTargetHighlightMode,a=t.isSubgrowthPinnedExp,n=t.shouldShowPinnedTeamFolders,l=t.onShowShare,c=t.teamFolders,d=t.user,u=t.onRenameSubmit,p=t.onRenameCancel,h=this.state,m=h.isTabbing,_=h.thumbStore;if(n&&c&&c.size)return i.createElement(S.PinnedTeamFolderView,{activeDropTarget:r,columnFlex:f.LIST_VIEW_COLUMN_FLEX[1],context:o,dropTargetHighlightMode:s,expSubgrowthBizTrialOnboarding:a,getOverflowMenuActions:this._handleGetOverflowMenuActions,isCompactMode:e,isTabbing:m,onDragEnter:this.handleDragEnter,onNavigateToFileOrFolder:this.props.onNavigateToFileOrFolder,onRenameCancel:p,onRenameSubmit:u,teamFolders:c,user:d,arePostTTIModulesLoaded:this.props.arePostTTIModulesLoaded,thumbStore:_,onShowShare:l})},A.prototype.getSelectAllCheckboxCheckedVariant=function(){var e=this.props,t=e.selectedFiles,r=e.items,o="unchecked";return t.size===r.filter(A.canSelectItem).size?o="checked":t.size&&(o="mixed"),o},A.prototype.isCreateFolderUIActive=function(){var e=this.props.createNewFolderState;return e&&"CREATE_FOLDER_INACTIVE"!==e},A.prototype.shouldShowEmptyFolderView=function(){return this.props.loadingState===d.LoadingState.LOADED&&!this.props.items.size&&!this.isCreateFolderUIActive()},A.canSelectItem=function(e){return e instanceof T.File},A.prototype.shouldComponentUpdate=function(e){return e.loadingState!==this.props.loadingState||e.loadingState!==d.LoadingState.LOADING_FIRST_PAGE},A.prototype.render=function(){var e=this,t=this.props,r=t.onDelete,s=t.onShowRename,l=t.onRenameSubmit,c=t.onRenameCancel,u=t.onSwitchViewType,p=t.onSetDropTarget,S=t.onPasteFromClipboard,T=t.onTilesPerRowChange,F=t.onColumnsChanged,E=t.onCanDisplayFolderSizesChanged,y=t.activeDropTarget,R=t.currentSort,C=t.createNewFolderState,A=t.context,I=t.columns,P=t.dropTargetHighlightMode,N=t.expSharedFolderUpsell,D=t.fileRename,x=t.getIsFileJumping,L=t.onAddFileJumpKeyCode,M=t.onResetFileJump,O=t.items,U=t.isSubgrowthPinnedExp,k=t.isSearchMode,B=t.isDraggingExternalFiles,V=t.isDraggingInternalFiles,q=t.isQueryingFolderSizes,H=t.isFileViewerShown,W=t.loadingState,G=t.onSortChange,z=t.path,j=t.selectedFiles,Q=t.selection,K=t.shouldShowPinnedTeamFolders,J=t.onShowShare,X=t.teamFolders,Y=t.tilesPerRow,Z=t.totalNumFiles,$=t.user,ee=t.viewType,te=t.viewTypes,re=t.viewTypeColumns,oe=t.onNavigateToFileOrFolder,se=t.onNavigateToParentFolder,ae=t.onNavigateToPath,ne=t.arePostTTIModulesLoaded,ie=t.onStarClick,le=t.expShowPaperStars,ce=t.expUseFqPathForStars,de=this.props.responsive,ue=de.isMatchedLarge,pe=de.isMatchedMedium,he=this.state,me=he.thumbStore,fe=he.isTabbing,_e=he.keyboardShortcutModalHandler;if(W===d.LoadingState.LOADING_FIRST_PAGE)return ne?i.createElement(a.MediaTableSkeleton,{numRows:15}):null;var Se=w.getItemIds(this.props),ge=!ue,we=!!j.size;if(this.shouldShowEmptyFolderView())return i.createElement("div",{className:"brws-files-view"},this.renderPinnedTeamFolderView(ge),this.renderEmptyFolderView());var ve=ue?f.DEFAULT_COLUMN_HEADER_HEIGHT:f.COMPACT_COLUMN_HEADER_HEIGHT,be=ue||pe?f.DEFAULT_PAGE_HEADER_HEIGHT:f.COMPACT_PAGE_HEADER_HEIGHT,Te=ve+be,Fe=0;K&&X&&X.size&&(Fe+=ve+ve+f.PINNED_TEAM_FOLDER_SECONDARY_HEADER_PADDING_TOP+X.size*f.DEFAULT_ROW_HEIGHT);var Ee="";return N&&A.isInsideSharedFolder&&(Ee="exp-shared-folder-upsell-v1__scrollList"),i.createElement("div",{className:"brws-files-view"},this.renderPinnedTeamFolderView(ge),i.createElement("div",{className:Ee},i.createElement(m.ColumnManager,{columns:I,viewTypeColumns:re,currentSort:R,onCanDisplayFolderSizesChanged:E,onColumnsChanged:F,isMatchedLarge:ue,isMatchedMedium:pe,isSearchMode:k,viewType:ee},function(t){var a=t.visibleColumns,m=t.handleSelection,w=t.canDisplayFolderSizes,b=(k?f.LIST_VIEW_SEARCH_MODE_COLUMN_FLEX:f.LIST_VIEW_COLUMN_FLEX)[a.length],F=i.createElement(h.ColumnHeader,{columnFlex:b,currentSort:R,isCompactMode:ge,isSelectMode:we,isSticky:U&&ee===d.ViewType.List,isTabbing:fe,onDeselectAll:e.handleDeselectAll,onSelectAll:e.handleSelectAll,onSelection:m,onSort:G,onSwitchViewType:u,selectAllCheckboxState:e.getSelectAllCheckboxCheckedVariant(),stickyOffsetHeight:ve,stickyOffsetTop:be,visibleColumns:a,viewType:ee,viewTypes:te,onTTI:e.handleTTI});return ee===d.ViewType.List?i.createElement(g.SelectableList,{itemIds:Se,keyScope:f.SELECTABLE_LIST_KEY_SCOPE,linkedOutsideClasses:f.SELECTABLE_LIST_LINKED_OUTSIDE_CLASSES,onSelectionChange:e.handleSelectionChange,onTabbingStart:e.handleTabbingStart,selection:Q,tilesPerRow:Y},function(t){var d=t.focusedFileId,u=t.handleDeselect,h=(t.handleDeselectAll,t.handleFocusFile),m=t.handleSelect,g=(t.handleSelectAll,t.isSelectableListEvent);return i.createElement(n.Table,{"aria-rowcount":Z,className:o("brws-files-view-list",{"brws-files-view-list-compact":ge}),columnFlex:b},F,i.createElement(_.FilesViewList,{onDelete:r,onShowRename:s,activeDropTarget:y,context:A,createNewFolderState:C,dropTargetHighlightMode:P,items:O,fileRename:D,focusedFileId:d,getOverflowMenuActions:e._handleGetOverflowMenuActions,getIsCurrentPathWriteable:e.getIsCurrentPathWriteable,getIsFileJumping:x,onAddFileJumpKeyCode:L,onResetFileJump:M,isCompactMode:ge,isDraggingExternalFiles:B,isDraggingInternalFiles:V,isFileViewerShown:H,isSearchMode:k,isSelectMode:we,isSelectableListEvent:g,arePostTTIModulesLoaded:ne,isTabbing:fe,keyScope:f.SELECTABLE_LIST_KEY_SCOPE,onCopyToClipboard:e.handleCopyToClipboard,onDragStart:e.handleDragStart,onDragEnter:e.handleDragEnter,onDeselectFile:u,onFocusFile:h,onOpenKeyboardShortcutModal:_e,onNavigateToFileOrFolder:oe,onNavigateToParentFolder:se,onNavigateToPath:ae,onNewFolderCancel:e.handleNewFolderCancel,onNewFolderSubmit:e.handleNewFolderSubmit,onOpenPaper:e.handleOpenPaper,onPasteFromClipboard:S,onRenameCancel:c,onRenameSubmit:l,onSelectFile:m,onSetDropTarget:p,onSetFileUploaderPath:e.handleSetFileUploaderPath,onStarClick:ie,scrollPositionOffset:Fe,scrollToRow:d&&fe?Se.indexOf(d):0,selectedFiles:j,selection:Q,onShowShare:J,user:$,viewportTopOffset:Te,visibleColumns:a,canDisplayFolderSizes:w,thumbStore:me,expShowPaperStars:le,expUseFqPathForStars:ce}))}):i.createElement(g.SelectableList,{itemIds:Se,keyScope:f.TILE_GRID_SCOPE,onSelectionChange:e.handleSelectionChange,onTabbingStart:e.handleTabbingStart,selection:Q,tilesPerRow:Y},function(t){var o=t.handleDeselectAll,a=t.handleFocusFile,d=t.handleSelectAll;return i.createElement("div",null,i.createElement(n.Table,{columnFlex:f.GRID_VIEW_COLUMN_FLEX},F),i.createElement(v.FilesViewTileGrid,{onDelete:r,onShowRename:s,activeDropTarget:y,activeSortDirection:R&&R.sortDirection,activeSortField:R&&R.sortField,arePostTTIModulesLoaded:ne,createNewFolderState:C,context:A,deselectAll:o,dropTargetHighlightMode:P,fileRename:D,getOverflowMenuActions:e._handleGetOverflowMenuActions,getIsCurrentPathWriteable:e.getIsCurrentPathWriteable,getIsFileJumping:x,onAddFileJumpKeyCode:L,onResetFileJump:M,onTTI:e.handleTTI,items:O,isCreateFolderUIActive:e.isCreateFolderUIActive(),isDraggingExternalFiles:B,isDraggingInternalFiles:V,isSearchMode:k,onCopyToClipboard:e.handleCopyToClipboard,onDragEnter:e.handleDragEnter,onDragStart:e.handleDragStart,onNewFolderCancel:e.handleNewFolderCancel,onNewFolderSubmit:e.handleNewFolderSubmit,onNavigateToFileOrFolder:oe,onOpenPaper:e.handleOpenPaper,onOpenKeyboardShortcutModal:_e,onPasteFromClipboard:S,onRenameCancel:c,onRenameSubmit:l,onSelectionChange:e.handleSelectionChange,onSetDropTarget:p,onSortChange:G,onStarClick:ie,onFocusFile:a,path:z,ref:e.setFilesViewTileGridRef,selectAll:d,selectedFiles:j,selection:Q,onSetFileUploaderPath:e.handleSetFileUploaderPath,thumbStore:me,totalNumItems:Z,user:$,isQueryingFolderSizes:q,tilesPerRow:Y,onTilesPerRowChange:T,expShowPaperStars:le,expUseFqPathForStars:ce,viewType:ee}))})})),i.createElement(b.InternalDragStatus,{className:"offscreen-drag-icon",files:j.toArray(),ref:this.setInternalDragStatusRef}))},A.defaultProps={activeDropTarget:null,dropTargetHighlightMode:d.DropTargetHighlightMode.NONE,enableUnity:!0,fileRename:null,loadingState:d.LoadingState.LOADING_FIRST_PAGE},A})(i.PureComponent);t.FilesViewController=U}),define("modules/clean/react/files_view/culled_table_body",["require","exports","tslib","spectrum/table","external/react"],function(e,t,r,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rangeInViewStartIndex=0,t.rangeInViewEndIndex=0,t.handleRangeInView=function(e,r){var o=document.body.scrollTop,s=window.innerHeight-t.props.viewportTopOffset,a=t.props.listItemHeight,n=t.props.items.length,i=n*a;t.rangeInViewStartIndex=Math.floor(o/i*n),t.rangeInViewEndIndex=Math.ceil((o+s||1)/i*n)-1},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.props.scrollToRow&&this.updateScroll(this.props.scrollToRow)},t.prototype.componentWillReceiveProps=function(e){this.props.scrollToRow!==e.scrollToRow&&e.scrollToRow!==-1&&this.updateScroll(e.scrollToRow)},t.prototype.updateScroll=function(e){var t=this.props,r=t.listItemHeight,o=t.viewportTopOffset;if(e<=this.rangeInViewStartIndex||e>=this.rangeInViewEndIndex){var s=document.body.scrollTop,a=window.innerHeight-o,n=(e+1)*r,i=e*r,l=0;l=i>s?Math.abs(a-n):n-r,window.scrollTo(0,l)}},t.prototype.render=function(){var e=this.props,t=(e.children,e.scrollToRow,e.viewportTopOffset),a=r.__rest(e,["children","scrollToRow","viewportTopOffset"]);return s.createElement("div",null,s.createElement(o.CulledTableBody,r.__assign({onRangeInView:this.handleRangeInView,viewportHeight:window.innerHeight-t},a)))},t.defaultProps={viewportTopOffset:0},t})(s.PureComponent)
;t.CulledTableBodyWithScrollToRow=a}),define("modules/clean/react/files_view/file_name_cell",["require","exports","tslib","external/classnames","spectrum/media_table","external/react","modules/clean/browse_interface","modules/clean/filepath","modules/clean/filetypes","modules/clean/react/files_view/types","modules/clean/react/files_view/name_input","modules/clean/react/files_view/star","modules/clean/react/files_view/util","modules/clean/react/browse/models","modules/clean/react/icon/file_folder_icon","modules/clean/search/search_results/log_helper","modules/clean/search/search_highlights","modules/clean/user_education/react/user_education_effect","modules/core/i18n","modules/clean/react/title_bubble","modules/clean/web_user_action_events"],function(e,t,r,o,s,a,n,i,l,c,d,u,p,h,m,f,_,S,g,w,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var b=(function(e){function t(r){var o=e.call(this,r)||this;return o.handleNameInputSubmit=function(e){o.props.onRenameSubmit(o.props.file,e)},o.handleNameInputCancel=function(){o.props.onRenameCancel(o.props.file)},o.handleOnClickNameInput=function(e){e.stopPropagation()},o.handleOnClickName=function(e){o.props.isTextSelectable||o.props.isSelectMode||p.shouldHandleClick(e)&&(e.preventDefault(),e.stopPropagation(),o.props.onNavigateToFileOrFolder(o.props.file))},o.handleOnClickLocationLink=function(e){e.stopPropagation();var t=o.props,r=t.file,s=t.isSearchMode,a=t.user;if(s&&f.recordSearchResultsAction({result:r,user:a,action_type:v.WebUserActionLogEvent.CLICK_PATH_LINK,view_type:c.ViewType.List}),o.props.onNavigateToPath&&p.shouldHandleClick(e)){e.preventDefault(),e.stopPropagation();var n=i.parent_dir(r.fq_path);o.props.onNavigateToPath(n)}},o.handleThumbnailError=function(){o.setState({thumbLoaded:!1})},o._setFilenameRef=function(e){return o._filenameDiv=e},o.onStarClick=function(e){var t=o.props,r=t.file,s=t.onStarClick;s&&s(r,e)},o.state={shouldShowTooltip:o.shouldShowTooltip(r),thumbLoaded:t.isThumbLoaded(r)},o}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.fetchThumbnail()},t.prototype.componentDidUpdate=function(e,t){var r=this.shouldShowTooltip(this.props);r!==t.shouldShowTooltip&&this.setState({shouldShowTooltip:r})},t.prototype.componentWillReceiveProps=function(e){var r=this.shouldShowTooltip(e);r!==this.state.shouldShowTooltip&&this.setState({shouldShowTooltip:r}),e.file.thumbnail_url_tmpl!==this.props.file.thumbnail_url_tmpl&&(this.unbindThumbnailIfNeeded(),this.setState({thumbLoaded:t.isThumbLoaded(e)}),this.fetchThumbnail())},t.prototype.componentWillUnmount=function(){this.unbindThumbnailIfNeeded()},t.prototype.shouldShowTooltip=function(e){var t=this._filenameDiv;return!!(e.showTooltip&&t&&t.offsetWidth<t.scrollWidth)},t.isThumbLoaded=function(e){var t=e.file,r=e.thumbStore,o=t.thumbnail_url_tmpl;return!(!o||!r.get_thumb(o))},t.prototype.fetchThumbnail=function(){var e=this,t=this.props,r=t.file,o=t.thumbStore,s=r.thumbnail_url_tmpl;s&&(this._thumbRequestId=o.bind_url(s,{onSuccess:function(){e.setState({thumbLoaded:!0})},onError:function(){e.handleThumbnailError()}}))},t.prototype.unbindThumbnailIfNeeded=function(){var e=this.props.thumbStore;this.state.thumbLoaded&&this._thumbRequestId&&e.unbind_url(this._thumbRequestId),this.setState({thumbLoaded:!1})},t.prototype.renderThumbnail=function(){var e=this.props,t=e.file,r=e.thumbStore,s=t.thumbnail_url_tmpl,n=t.fq_path;if(this.state.thumbLoaded&&s){var i=r.get_thumb(s);if(i)return a.createElement("img",{alt:n,draggable:!1,className:o("brws-file-name-cell-icon","brws-file-name-cell-thumb"),src:i,onError:this.handleThumbnailError})}return this.renderFileIcon()},t.prototype.renderFileIcon=function(){var e=this.props,t=e.file,r=e.showCDMUserEducationEffects,o=a.createElement(m.FileOrFolderIcon,{className:"brws-file-name-cell-icon",ref:"icon",file:t,onClick:this.handleOnClickName,showPreview:!1});return r?a.createElement(S.UserEducationEffect,{containerName:"FileItemRow",name:"TMFIcon",useSpan:!0},o):o},t.prototype.renderScreenReaderExtraInfo=function(){var e=[],t=this.props,r=t.file,o=t.isSelected;if(r.isDeleted&&e.push(g._("Deleted")),o&&e.push(g._("Selected")),r.is_dir&&(r.type===l.FileTypes.SHARED_FOLDER?h.File.isReadOnlySharedFolder(r)?e.push(g._("Read-only shared folder")):e.push(g._("Shared folder")):r.type===l.FileTypes.TEAM_SHARED_FOLDER?h.File.isReadOnlySharedFolder(r)?e.push(g._("Read-only team shared folder")):e.push(g._("Team shared folder")):e.push(g._("Folder"))),e.length>0)return a.createElement("span",{className:"ax-visually-hidden"},""+e.join(" "))},t.prototype.renderTitle=function(){var e=this.props,t=e.file,r=e.renameState,o=e.user;if(r===c.RenameState.SAVING_INPUT)return a.createElement("span",{role:"status"},g._("Renaming…"));var s,l=i.filename(t.fq_path);if(s=this.props.showHighlights&&t.filename_highlights?_.highlightMatchReact(l,t.filename_highlights):a.createElement("span",null,l),s=a.createElement("div",{className:"brws-file-name-element",ref:this._setFilenameRef},s),this.state.shouldShowTooltip&&(s=a.createElement(w.TitleBubble,{content:l,position:w.TitleBubble.POSITIONS.BOTTOM,className:"list-label__title-bubble"},s)),!t.is_unmounted){var d=n.href_for_file(o,t);s=a.createElement("a",{className:"brws-file-name-cell-filename",href:d,onClick:this.handleOnClickName},s)}return this.props.showUserEducationEffects?a.createElement(S.UserEducationEffect,{containerName:"FileItemRow",name:this.props.userEducationEffectName||"FileNameLabel",useSpan:!0},s):s},t.prototype.renderSubtitle=function(){var e=this.props,t=e.file,r=e.isSelectMode,o=e.renameState,s=e.renderLocationAsLink,l=e.showLocation,c=e.user;if(o||!l)return null;var d=i.parent_dir(t.fq_path),u="/"===d?n.get_browse_root_name(c):d.slice(1);if(t.is_unmounted)return g._("not added yet, in %(location)s",{comment:"Describes the parent directory of a file in a list of search results."}).format({location:u});var p=g._("in %(location)s",{comment:"Describes the parent directory of a file in a list of search results."}).format({location:u});if(!s||r)return p;var h=n.browse_uri_for_fq_path(c,d);return a.createElement("a",{className:"brws-file-name-cell-location",href:h.toString(),onClick:this.handleOnClickLocationLink},p)},t.prototype.render=function(){var e,t=this.props,r=t.file,n=t.mediaActions,l=t.renameState,p=t.user,h=t.showStar,m=t.isSelectMode,f=t.isTabbing;if(l===c.RenameState.PENDING_INPUT){var _=r.is_dir?g._("Rename directory…"):g._("Rename file…");e=a.createElement(d.NameInput,{defaultValue:i.filename(r.fq_path),label:_,onClick:this.handleOnClickNameInput,onSubmit:this.handleNameInputSubmit,onCancel:this.handleNameInputCancel,isDir:r.is_dir})}else e=[a.createElement(s.MediaCellText,{key:"title",highlight:this.props.isHovered},this.renderTitle(),this.renderScreenReaderExtraInfo()),a.createElement(s.MediaCellText,{highlight:this.props.isHovered,key:"subtitle",variant:"subtitle"},this.renderSubtitle())];var S=o("brws-file-name-cell-text","brws-vertically-center",{"brws-file-name-cell-text-rename":!!this.props.renameState}),w=this.props.expUseFqPathForStars?{fq_path:r.fq_path}:r;return a.createElement(s.MediaCell,{icon:this.renderThumbnail()},a.createElement("div",{className:S},e),h&&!l&&a.createElement(u.StarContainer,{item:w,user:p,className:"brws-file-name-cell-star brws-vertically-center",onStarClick:this.onStarClick,isReadOnly:m,isTabbing:f}),n)},t.defaultProps={renderLocationAsLink:!0},t})(a.Component);t.FileNameCell=b}),define("modules/clean/react/files_view/file_row",["require","exports","tslib","external/classnames","spectrum/button","spectrum/icon_table","spectrum/checkbox","spectrum/media_table","external/react","external/react-dom","modules/clean/filetypes","modules/clean/react/files_view/file_name_cell","modules/clean/react/files_view/types","modules/clean/react/files_view/share_button","modules/clean/react/files_view/util","modules/clean/react/browse/models","modules/clean/react/partner_file_actions/partner_file_action_button","modules/clean/user_education/react/user_education_effect","modules/core/i18n","modules/clean/react/title_bubble","modules/clean/browse_interface"],function(e,t,r,o,s,a,n,i,l,c,d,u,p,h,m,f,_,S,g,w,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var b=function(e){return e.type===d.FileTypes.TEAM_SHARED_FOLDER&&("archived"===e.team_folder_status||"archive_in_progress"===e.team_folder_status)},T=function(){return l.createElement("span",{"aria-hidden":!0},"--")},F=function(e){var t=e.isVisible,r=e.onClick;return l.createElement(s.Button,{className:"brws-file-row-view-file-button","aria-label":g._("View File"),onClick:r,tabIndex:t?void 0:-1,variant:t?"secondary":"invisible"},l.createElement(a.IconTable,{name:"view"}))},E=function(){return l.createElement("svg",{width:"20px",height:"20px",viewBox:"0 0 20 20",version:"1.1"},l.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},l.createElement("g",{id:"Group",transform:"translate(2.000000, 2.000000)"},l.createElement("circle",{id:"Oval-65",cx:"8",cy:"8",r:"8"}),l.createElement("path",{d:"M8,13 L8,14.5 L5.5,12.5 L8,10.5 L8,12 C10.209139,12 12,10.209139 12,8 C12,6.93104698 11.5806921,5.96002857 10.8975817,5.24245012 L11.4674192,4.39763124 C12.4121861,5.30722218 13,6.58496544 13,8 C13,10.7614237 10.7614237,13 8,13 Z M8,3 L8,1.5 L10.5,3.5 L8,5.5 L8,4 C5.790861,4 4,5.790861 4,8 C4,8.96511539 4.34180174,9.8503987 4.91095749,10.5414022 L4.33270318,11.3986995 C3.5056268,10.5066799 3,9.3123877 3,8 C3,5.23857625 5.23857625,3 8,3 Z",id:"Oval-67",fill:"#637282"}))))},y=function(){return l.createElement("svg",{width:"20px",height:"20px",viewBox:"0 0 20 20",version:"1.1"},l.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},l.createElement("g",{id:"icon-warning",fill:"#637282"},l.createElement("path",{d:"M13.9298189,16.125 C16.4624689,16.125 17.5138484,14.3377448 16.2785476,12.1337797 L12.238298,4.92535765 C11.002815,2.72106753 8.99951926,2.72139251 7.76421846,4.92535765 L3.7239688,12.1337797 C2.48848585,14.3380698 3.54098311,16.125 6.07269759,16.125 L13.9298189,16.125 Z M11.002944,14.0995516 L8.99957244,14.0995516 L8.99957244,12.0741033 L11.002944,12.0741033 L11.002944,14.0995516 L11.002944,14.0995516 Z M11.002944,11.0613791 L8.99957244,11.0613791 L8.99957244,7.01048239 L11.002944,7.01048239 L11.002944,11.0613791 L11.002944,11.0613791 Z",id:"Shape"}))))},R=function(){return l.createElement("div",{className:"error-tooltip"},l.createElement("div",{className:"error-tooltip__title"},g._("This folder is too large")),g._("We can’t calculate the full size of this folder right now. This can happen when there are a large number of files inside of the folder or if the request takes too long."))},C=function(e){var t=e.file;if(!t.is_dir)return l.createElement("span",null,t.size);switch(t.fetchFolderSizesStatus){case p.FetchFolderSizeState.LOADING:return l.createElement("span",{className:"item-cell-title item-cell-title--loading"},l.createElement("span",{className:"ax-visually-hidden"},g._("Calculating folder sizes...")),l.createElement(E,null),g._("Calculating..."));case p.FetchFolderSizeState.ERROR:return l.createElement("span",{className:"item-cell-title"},l.createElement(w.TitleBubble,{content:l.createElement(R,null),position:w.TitleBubble.POSITIONS.TOP,isTargetPositionFixed:!1},l.createElement("span",{className:"ax-visually-hidden"},g._("Error in calculating folder sizes")),l.createElement("span",null,l.createElement(y,null))),t.size);case p.FetchFolderSizeState.COMPLETE:return l.createElement("span",{className:"item-cell-title"},t.size);default:return l.createElement(T,null)}},A=(function(t){function s(){var e=null!==t&&t.apply(this,arguments)||this;return e.checkboxRef=null,e.handleClick=function(t){if(e.checkboxRef&&c.findDOMNode(e.checkboxRef).contains(t.target))return void t.preventDefault();if(e.props.isSelectMode&&e.props.onDeselect&&e.props.onSelect){t.preventDefault();var r=e.props.file.fq_path;return void(e.props.isSelected?e.props.onDeselect(r,t.shiftKey):e.props.onSelect(r,t.shiftKey))}m.shouldHandleClick(t)&&(t.preventDefault(),t.stopPropagation(),e.props.onNavigateToFileOrFolder(e.props.file))},e.handleClickViewFileButton=function(t){m.shouldHandleClick(t)&&(t.preventDefault(),t.stopPropagation(),e.props.onNavigateToFileOrFolder(e.props.file))},e.handleChangeCheckbox=function(t,r){if(e.props.onSelect&&e.props.onDeselect){var o=e.props.file.fq_path;"checked"===t?e.props.onSelect(o,r.shiftKey):e.props.onDeselect(o,r.shiftKey)}},e.handleDragEnter=function(t){var r=e.props,o=r.file,s=r.isSelected,a=r.isActiveDropTarget;e.props.onDragEnter(t,o,!!s,!!a)},e.handleDragStart=function(t){var r=e.props,o=r.file,s=r.isSelected,a=r.onDragStart,n=r.onSelect;a&&(s?a(t):(n&&n(o.fq_path),a(t,[o])))},e.setCheckboxRef=function(t){e.checkboxRef=t},e.rowChildFn=function(t){var r,s=t.isHovered,a=e.props,c=a.isCompactMode,d=a.isPinned,u=a.isSelectMode,p=a.isSelected,h=a.showUserEducationEffects,m=a.isTabbing,f=a.visibleColumns;if(!d){var _=!(m||s||p||u||c);r=l.createElement(n.Checkbox,{checked:p?"checked":"unchecked",className:o("brws-checkbox",{"brws-checkbox-checked":p}),onChange:e.handleChangeCheckbox,ref:e.setCheckboxRef,variant:_?"invisible":"default"}),h&&(r=l.createElement(S.UserEducationEffect,{containerName:"FileItemRow",name:"FirstFileSelectCheckbox",useSpan:!0},r))}return[l.createElement(i.MediaCell,{key:"checkboxCell",className:"brws-checkbox-cell"},l.createElement("div",{className:"brws-vertically-center"},r))].concat(f.map(function(t,r){return e.renderCell({isHovered:s,isLastCell:r===f.length-1,sortField:t.sortField})}))},e}return r.__extends(s,t),s.prototype.componentDidUpdate=function(e){var t=this;(this.props.isFocused&&!e.isFocused||this.props.isFocused&&this.props.isSelected&&!e.isSelected)&&this.checkboxRef&&Promise.resolve().then(function(){if(t.checkboxRef){var e=c.findDOMNode(t.checkboxRef);e&&e.focus()}})},s.prototype.renderHelloSignButton=function(e){return l.createElement(_.PartnerFileActionButton,{file:e,user:this.props.user,text:g._("Open for signature"),actionContext:"browse_list",variant:this.props.expHelloSignVariant,logExposure:this.props.expLogHelloSignExposure})},s.prototype.showHelloSignExp=function(e){return".pdf"===e.ext&&"OFF"!==this.props.expHelloSignVariant},s.prototype.renderMediaActions=function(t){var o=this.props,s=o.file,a=o.user,n=o.isCompactMode,c=o.isSelected,d=o.isSelectMode,u=o.isSharingDisabled,p=o.isTabbing,m=o.getOverflowMenuActions,f=o.isSearchMode,_=o.canDisplayFolderSizes,S=o.arePostTTIModulesLoaded,g=o.onShowShare,w={file:s,isSearchMode:f,user:a,onShowShare:g},v=null;if(S){var b=e("modules/clean/react/files_view/overflow_menu_with_star").OverflowMenuWithStar;v=l.createElement(b,{file:s,getOverflowMenuActions:m,showBorders:p||t,canDisplayFolderSizes:_})}return d?l.createElement(i.MediaActions,null,!n&&(c||t)&&this.showHelloSignExp(s)?this.renderHelloSignButton(s):null,!u&&l.createElement(h.ShareButton,r.__assign({},w,{isVisible:!n&&(c||t)})),l.createElement(F,{isVisible:c||n||t,onClick:this.handleClickViewFileButton})):l.createElement(i.MediaActions,null,(p||t&&!n)&&this.showHelloSignExp(s)?this.renderHelloSignButton(s):null,!u&&l.createElement(h.ShareButton,r.__assign({},w,{isVisible:p||t&&!n})),v)},s.prototype.renderModifiedCell=function(e,t){var r=e.ago,o=e.last_modified_name||void 0,s=o&&g._("by %(modified_by)s",{comment:"name of the person that modified the file"}).format({modified_by:o});return l.createElement(i.MediaCell,{className:"brws-file-modified-at-cell",key:"modifiedAt",subtitle:s,title:r||l.createElement(T,null)},t)},s.prototype.renderSharedWithController=function(){var t=this.props,r=t.context,o=t.file,s=t.isSelectMode;if(!t.arePostTTIModulesLoaded||b(o))return null;var a=e("modules/clean/react/browse/shared_with").SharedWithController;return l.createElement("div",{className:"brws-vertically-center brws-shared-with-wrapper"},l.createElement(a,{file:o,browseContext:r,inSelectMode:s}))},s.prototype.renderCell=function(e){var t=e.isHovered,r=e.isLastCell,o=e.sortField,s=this.props,a=s.file,n=s.user,c=s.isCompactMode,d=s.isSearchMode,h=s.isSelectMode,m=s.isTabbing,_=s.arePostTTIModulesLoaded,S=s.renameState,g=s.showCDMUserEducationEffects,w=s.showUserEducationEffects,v=s.userEducationEffectName,b=s.onNavigateToFileOrFolder,T=s.onStarClick,F=s.thumbStore,E=s.expUseFqPathForStars,y=r&&!(c&&S),R=y?this.renderMediaActions(t):void 0;switch(o){case p.SortField.FILENAME:return l.createElement(u.FileNameCell,{key:"fileName",user:n,file:a,isHovered:t,isSearchMode:d,isSelectMode:h,isTabbing:m,mediaActions:R,onNavigateToPath:this.props.onNavigateToPath,onNavigateToFileOrFolder:b,onRenameCancel:this.props.onRenameCancel,onRenameSubmit:this.props.onRenameSubmit,renameState:S,showCDMUserEducationEffects:g,showTooltip:_,showHighlights:d,showLocation:d,showUserEducationEffects:w,userEducationEffectName:v,showStar:_&&!f.File.isNoAccessSharedFolder(a),onStarClick:T,thumbStore:F,expUseFqPathForStars:E});case p.SortField.MODIFIED:return this.renderModifiedCell(a,R);case p.SortField.SHARED_WITH:return l.createElement(i.MediaCell,{className:"brws-file-shared-with-cell",key:"sharedWith"},this.renderSharedWithController(),R);case p.SortField.CATEGORY:return l.createElement(i.MediaCell,{className:"brws-file-category-cell",key:"category",title:f.File.getCategoryDescription(a)},R);case p.SortField.EXTENSION:return l.createElement(i.MediaCell,{className:"brws-file-extension-cell",key:"extension",title:f.File.getExtension(a)},R);case p.SortField.SIZE:return l.createElement(i.MediaCell,{className:"brws-file-size-cell",key:"size",title:l.createElement(C,{file:a})},R);case p.SortField.SYNC_SETTING:return null}},s.prototype.render=function(){var e=this.props,t=e.file,s=e.isActiveDropTarget,a=e.isAvailableDropTarget,n=e.isPinned,c=e.isSelected,d=e.renameState,u=e.rowIndex,p=e.tabIndex,h=e.topOffset,m=e.user,_=o("brws-file-row",{"brws-file-row-selected":c,"brws-file-row-deleted":t.isDeleted,"brws-file-row-droppable":a&&!s,"brws-file-row-dragover":s,"brws-file-row-no-access":f.File.isNoAccessSharedFolder(t),"brws-file-row-pinned":n}),S=s?"dragover":a&&!s?"droppable":c?"selected":"default",g={"aria-rowindex":void 0!==u?u+1:void 0,className:_,"data-filename":t.fq_path.split("/").slice(-1),onClick:this.handleClick,onDragEnter:this.handleDragEnter,tabIndex:p,variant:S};if(n)return l.createElement(i.MediaRow,r.__assign({},g),this.rowChildFn);var w=v.href_for_file(m,t);return l.createElement("a",{className:"brws-file-name-cell",href:w,onDragStart:this.handleDragStart},l.createElement(i.CulledMediaRow,r.__assign({},g,{draggable:!d,topOffset:h}),this.rowChildFn))},s.defaultProps={isSelectionEmpty:!0,topOffset:0},s})(l.PureComponent);t.FileRow=A}),define("modules/clean/react/files_view/fixed_table_head",["require","exports","tslib","spectrum/vertically_fixed","spectrum/table","external/react"],function(e,t,r,o,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FixedTableHead=function(e){var t=e.children,n=e.offsetHeight,i=r.__rest(e,["children","offsetHeight"]);return a.createElement("thead",r.__assign({className:"mc-table-head mc-table-head-fixed brws-column-header"},i),a.createElement(o.VerticallyFixed,{tag:function(e){var o=e.style;return a.createElement(s.TableRow,r.__assign({className:"mc-table-head-row mc-table-head-row-fixed",style:{height:n}},o),t)}}))}}),define("modules/clean/react/files_view/internal_drag_status",["require","exports","tslib","external/classnames","external/react","modules/clean/react/sprite"],function(e,t,r,o,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.className,r=e.files,n=o("active",t);return s.createElement("div",{id:"drag-status",className:n},s.createElement("div",{id:"drag-selection-status"},r.slice(0,4).map(function(e,t){return e.thumbnail_url_tmpl?s.createElement("img",{key:t,src:e.thumbnail_url_tmpl,className:"icon icon"+t,alt:""}):s.createElement(a.Sprite,{key:t,group:"web",name:e.icon,className:"icon icon"+t,alt:""})}),s.createElement("span",{className:"badge"},r.length)))},t})(s.PureComponent);t.InternalDragStatus=n}),define("modules/clean/react/files_view/list",["require","exports","tslib","external/react","modules/clean/react/files_view/drag_and_drop","modules/clean/react/files_view/constants","modules/clean/react/files_view/culled_table_body","modules/clean/react/files_view/file_row","modules/clean/react/files_view/new_folder_row","modules/clean/react/files_view/paper_row","modules/clean/react/files_view/selectors","modules/clean/react/files_view/keyboard_shortcuts","modules/clean/react/browse/models","modules/clean/api_v2/client","modules/clean/web_timing_logger","modules/core/exception"],function(e,t,r,o,s,a,n,i,l,c,d,u,p,h,m,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var _=function(){},S=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={scrollToRow:0,expHasLoggedHelloSignExposure:!1,expHelloSignVariant:"OFF"},t.apiClient=new h.ApiV2Client,t.logHelloSignExposure=function(){return r.__awaiter(t,void 0,void 0,function(){var e;return r.__generator(this,function(t){switch(t.label){case 0:if(this.state.expHasLoggedHelloSignExposure||!this.apiClient)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.apiClient.ns("stormcrow").rpc("log_exposure",{feature:"pp_hellosign_experiment",variant:this.state.expHelloSignVariant},{subjectUserId:this.props.user.id})];case 2:return t.sent(),this.setState({expHasLoggedHelloSignExposure:!0}),[3,4];case 3:return e=t.sent(),f.reportException({err:e,tags:["partner_platform"],severity:f.SEVERITY.NONCRITICAL}),[3,4];case 4:return[2]}})})},t.handleFileViewerUnmount=function(){var e=t.props.selectedFiles.first();e&&t.props.onFocusFile(e.fq_path)},t.getIsListEvent=function(e){return t.props.isSelectableListEvent()&&"BUTTON"!==e.target.tagName},t.getSelectedFiles=function(){return t.props.selectedFiles},t.handleNavigateToFileOrFolder=function(e){t.props.onNavigateToFileOrFolder(e,t.handleFileViewerUnmount)},t.enableContextMenu=function(){return!1},t.getActiveDropTarget=function(){return t.props.activeDropTarget},t.getIsDraggingInternalFiles=function(){return!!t.props.isDraggingInternalFiles},t.getIsDraggingExternalFiles=function(){return!!t.props.isDraggingExternalFiles},t.renderRow=function(e,r,s){if("NewFolderRow"===e.type)return o.createElement(l.NewFolderRow,{createNewFolderState:e.props.createNewFolderState,isInsideTeamFolderTree:e.props.isInsideTeamFolderTree,onCancel:t.props.onNewFolderCancel,onSubmit:t.props.onNewFolderSubmit,rowIndex:r,topOffset:s,useNewCdmIconography:t.props.user.is_cdm_member});if("PaperRow"===e.type)return o.createElement(c.PaperRow,{paper:e.props.paper,isSearchMode:e.props.isSearchMode,rowIndex:r,topOffset:s,user:t.props.user,visibleColumns:e.props.visibleColumns,onOpenPaper:t.props.onOpenPaper,arePostTTIModulesLoaded:e.props.arePostTTIModulesLoaded,expShowPaperStars:t.props.expShowPaperStars});var a=t.props.selection,n=e.props.file,d=a.selected.last()===e.props.file.fq_path||!a.selected.size&&0===r?0:void 0,u=0===r||t.props.user.is_cdm_member&&(2===r||1===r);return o.createElement(i.FileRow,{context:t.props.context,file:n,getOverflowMenuActions:t.props.getOverflowMenuActions,isActiveDropTarget:e.props.isActiveDropTarget,isAvailableDropTarget:e.props.isAvailableDropTarget,isCompactMode:e.props.isCompactMode,isFocused:e.props.isFocused,isSearchMode:e.props.isSearchMode,isSelectMode:e.props.isSelectMode,isSelected:e.props.isSelected,arePostTTIModulesLoaded:e.props.arePostTTIModulesLoaded,isSharingDisabled:e.props.isSharingDisabled,isTabbing:e.props.isTabbing,key:n.fq_path,onDeselect:t.props.onDeselectFile,onDragStart:t.props.onDragStart,onDragEnter:t.props.onDragEnter,onNavigateToPath:t.props.onNavigateToPath,onNavigateToFileOrFolder:t.handleNavigateToFileOrFolder,onRenameCancel:t.props.onRenameCancel,onRenameSubmit:t.props.onRenameSubmit,onSelect:t.props.onSelectFile,onStarClick:t.props.onStarClick,renameState:e.props.renameState,rowIndex:r,showUserEducationEffects:u,userEducationEffectName:u?"FileNameLabel-"+r:void 0,showCDMUserEducationEffects:p.File.isTeamMemberFolder(n),tabIndex:d,topOffset:s,user:t.props.user,visibleColumns:t.props.visibleColumns,canDisplayFolderSizes:t.props.canDisplayFolderSizes,thumbStore:t.props.thumbStore,onShowShare:t.props.onShowShare,expHelloSignVariant:t.state.expHelloSignVariant,expLogHelloSignExposure:t.logHelloSignExposure,expUseFqPathForStars:t.props.expUseFqPathForStars})},t}return r.__extends(t,e),t.prototype.componentWillMount=function(){var e=this;m.waitForTTI().then(function(){return r.__awaiter(e,void 0,void 0,function(){var e,t;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.apiClient.ns("stormcrow").rpc("get_variant",{feature:"pp_hellosign_experiment",log_exposure:!1},{subjectUserId:this.props.user.id})];case 1:return e=r.sent(),this.setState({expHelloSignVariant:e.variant}),[3,3];case 2:return t=r.sent(),f.reportException({err:t,tags:["partner_platform"],severity:f.SEVERITY.NONCRITICAL}),[3,3];case 3:return[2]}})})})},t.prototype.componentDidMount=function(){var e=this.props.onTTI;e&&e(),this.setupKeyboardShortcuts(),this.setupExternalDragHandler(),this.props.selectedFiles.size&&!this.props.isFileViewerShown()&&this.setState({scrollToRow:this.getRowIndexForFile(this.props.selectedFiles.first())})},t.prototype.componentWillReceiveProps=function(e){this.props.scrollToRow!==e.scrollToRow&&this.setState({scrollToRow:e.scrollToRow})},t.prototype.componentDidUpdate=function(e){e.createNewFolderState===this.props.createNewFolderState||"PENDING_INPUT"!==this.props.createNewFolderState||this.props.isFileViewerShown()||this.setState(function(e){return 0===e.scrollToRow?(window.scrollTo(0,0),{}):{scrollToRow:0}})},t.prototype.componentWillUnmount=function(){this.cleanupKeyboardShortcuts(),s.cleanupExternalDragHandler(this.props.keyScope)},t.prototype.getRowIndexForFile=function(e){return this.props.items.indexOf(e)},t.prototype.cleanupKeyboardShortcuts=function(){u.resetFilesViewKeyboardShortcuts(this.props.keyScope),u.resetFileJumpKeyboardShortcuts(this.props.keyScope)},t.prototype.setupKeyboardShortcuts=function(){var e=this,t=this.props,r=t.onDelete,o=t.onShowRename,s=t.getIsFileJumping,a=t.onAddFileJumpKeyCode,n=t.onResetFileJump,i=t.keyScope,l=t.onCopyToClipboard,c=t.onNavigateToParentFolder,d=t.onPasteFromClipboard;u.setupFileJumpKeyboardShortcuts({scope:i,getIsFileJumping:s,onAddFileJumpKeyCode:a,onResetFileJump:n}),u.setupFilesViewListKeyboardShortcuts({getIsGlobalEvent:this.getIsGlobalEvent(),getIsItemEvent:this.getIsListEvent,getSelectedFiles:this.getSelectedFiles,isCurrentPathWriteable:this.props.getIsCurrentPathWriteable,enableContextMenu:this.enableContextMenu,selectAllAction:_,deselectAllAction:_,onCopyToClipboard:l,onDelete:r,onNavigateToFileOrFolder:this.handleNavigateToFileOrFolder,onNavigateToParentFolder:c,onPasteFromClipboard:d,onShowRename:o,openContextMenuAtPosition:_,scope:i,onShowHelpMenu:function(){return e.props.onOpenKeyboardShortcutModal()}})},t.prototype.setupExternalDragHandler=function(){s.setupExternalDragHandler(this.props.keyScope,this.getIsDraggingInternalFiles,this.getIsDraggingExternalFiles,this.props.onSetFileUploaderPath,".brws-file-row",this.getActiveDropTarget,this.props.onSetDropTarget)},t.prototype.getIsGlobalEvent=function(){return u.generateGetIsGlobalEvent(this)},t.prototype.render=function(){var e=this.props,t=e.scrollPositionOffset,r=e.viewportTopOffset;return o.createElement(n.CulledTableBodyWithScrollToRow,{items:d.getFilesViewListRowItems(this.props),listItemHeight:a.DEFAULT_ROW_HEIGHT,renderRow:this.renderRow,scrollPositionOffset:t,scrollToRow:this.state.scrollToRow,shouldUseWindowAsScrollContainer:!0,viewportTopOffset:r})},t.defaultProps={isFileViewerShown:function(){return!1}},t})(o.PureComponent);t.FilesViewList=S}),define("modules/clean/react/files_view/new_folder_row",["require","exports","spectrum/media_table","spectrum/table","external/react","spectrum/icon_content","modules/clean/react/files_view/name_input","modules/core/i18n"],function(e,t,r,o,s,a,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NewFolderRow=function(e){var a,l=e.createNewFolderState,c=e.isInsideTeamFolderTree,d=void 0!==c&&c,u=e.onCancel,p=e.onSubmit,h=e.rowIndex,m=e.topOffset,f=e.useNewCdmIconography;a="SAVING_INPUT"===l?s.createElement("p",{className:"brws-new-folder-row-status",role:"status","aria-live":"polite"},i._("Creating new folder…")):s.createElement(n.NameInput,{defaultValue:"",label:i._("Folder name"),onSubmit:p,onCancel:u});var _=s.createElement(t.NewFolderIcon,{isInsideTeamFolderTree:d,useNewCdmIconography:f});return s.createElement(r.CulledMediaRow,{"aria-rowindex":void 0!==h?h+1:void 0,className:"brws-new-folder-row",topOffset:m},s.createElement(o.TableCell,{className:"brws-checkbox-cell"}),s.createElement(r.MediaCell,{icon:_},s.createElement("div",{className:"brws-new-folder-row-content brws-vertically-center"},a)),s.createElement(o.TableCell,null),s.createElement(o.TableCell,null))},t.NewFolderIcon=function(e){var t=e.isInsideTeamFolderTree,r=e.useNewCdmIconography;return s.createElement(a.IconContent,{className:"brws-file-name-cell-icon",name:t?r?"folder_team-small":"folder_shared-small":"folder-small"})}}),define("modules/clean/react/files_view/paper_row",["require","exports","tslib","external/react","spectrum/media_table","modules/clean/react/files_view/star","modules/clean/react/files_view/types","modules/clean/search/paper_formatting_utils","modules/clean/search/search_results/log_helper","modules/clean/web_user_action_events","modules/core/i18n"],function(e,t,r,o,s,a,n,i,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){function t(t){var r=e.call(this,t)||this;return r.handleDocNameClick=function(e){r.props.isSearchMode&&l.recordSearchResultsAction({result:r.props.paper,user:r.props.user,action_type:c.WebUserActionLogEvent.PAPER_OPEN,view_type:n.ViewType.List}),e.stopPropagation()},r.handleRowClick=function(e){r.props.onOpenPaper(e,r.props.paper)},r.state=r.calcState(t),r}return r.__extends(t,e),t.prototype.componentWillReceiveProps=function(e){if(this.props.paper.title!==e.paper.title){var t=this.calcState(e);this.setState(t)}},t.prototype.calcState=function(e){return{titleParts:i.getPaperDocTitleParts(e.paper,"brws-file-name-cell-icon","brws-file-name-cell-icon-emoji")}},t.prototype.renderDocName=function(e){var t=this.props,r=t.paper,n=t.showHighlights,i=t.user,l=t.arePostTTIModulesLoaded,c=t.expShowPaperStars,u=this.state.titleParts,p=u.title,h=u.highlightedTitle,m=u.icon,f=o.createElement("a",{className:"brws-paper-doc-name-cell-title",href:r.url,onClick:this.handleDocNameClick},n?h:o.createElement("span",null,p)),_=l&&c?o.createElement(a.StarContainer,{item:r,user:i,key:"paperStar",className:"brws-file-name-cell-star brws-vertically-center"}):null;return o.createElement(s.MediaCell,{highlight:e,icon:m,key:"docName"},o.createElement("div",{className:"brws-paper-doc-name-cell-content brws-vertically-center"},o.createElement(s.MediaCellText,{highlight:e},f),o.createElement(s.MediaCellText,{highlight:e,variant:"subtitle"},d._("in Paper",{comment:"The Dropbox Paper page"}))),_)},t.prototype.renderDocInfo=function(){var e=this.props.paper,t=e.last_modified_date||"",r=d._("by %(modified_by)s",{comment:"name of the person that modified the file"}).format({modified_by:e.last_editor_name||e.creator_name});return o.createElement(s.MediaCell,{key:"docInfo",subtitle:r,title:t})},t.prototype.renderCell=function(e){var t=e.isHovered;switch(e.sortField){case n.SortField.FILENAME:return this.renderDocName(t);case n.SortField.MODIFIED:return this.renderDocInfo()}return null},
t.prototype.render=function(){var e=this,t=this.props,r=t.rowIndex,a=t.topOffset,n=t.visibleColumns;return o.createElement(s.CulledMediaRow,{"aria-rowindex":void 0!==r?r+1:void 0,className:"brws-paper-row",draggable:!1,onClick:this.handleRowClick,topOffset:a,variant:"default"},function(t){var r=t.isHovered;return[o.createElement(s.MediaCell,{key:"checkboxCell",className:"brws-checkbox-cell"})].concat(n.map(function(t){return e.renderCell({isHovered:r,sortField:t.sortField})}))})},t.defaultProps={showHighlights:!0,isSearchMode:!0},t})(o.PureComponent);t.PaperRow=u}),define("modules/clean/react/files_view/pinned_team_folder_view",["require","exports","tslib","external/classnames","spectrum/dimensions","spectrum/table","spectrum/vertically_fixed","modules/clean/react/browse/models","modules/clean/react/files_view/constants","modules/clean/react/files_view/file_list_utils","modules/clean/react/files_view/file_row","external/react","modules/clean/react/sprite","modules/constants/trademark","modules/core/i18n","modules/clean/react/tooltip","modules/clean/user_education/user_education_client","modules/clean/user_education/react/user_education_effect"],function(e,t,r,o,s,a,n,i,l,c,d,u,p,h,m,f,_,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.displayName="PinnedTeamFolderView",t.renderTeamFolderRow=function(e,r){var o=t.props,s=o.activeDropTarget,a=o.context,n=o.dropTargetHighlightMode,p=o.getOverflowMenuActions,h=o.isTabbing,m=o.onDragEnter,f=o.onNavigateToFileOrFolder,_=o.onRenameCancel,g=o.onRenameSubmit,w=o.user,v=o.arePostTTIModulesLoaded,b=o.thumbStore,T=o.onShowShare,F=c.shouldFileBeHighlightedDropTarget({dropTargetHighlightMode:n,file:e,isSelected:!1}),E=u.createElement(d.FileRow,{context:a,file:e,getOverflowMenuActions:p,key:encodeURI(e.fq_path),isAvailableDropTarget:F,isActiveDropTarget:e===s,isPinned:!0,arePostTTIModulesLoaded:v,isTabbing:h,onDragEnter:m,onNavigateToFileOrFolder:f,onRenameCancel:_,onRenameSubmit:g,showUserEducationEffects:0===r,showCDMUserEducationEffects:i.File.isTeamMemberFolder(e),user:w,visibleColumns:l.LIST_VIEW_COLUMNS.slice(0,1),canDisplayFolderSizes:!1,thumbStore:b,onShowShare:T});return r>0?E:u.createElement(S.UserEducationEffect,{containerName:"PinnedTeamFolder",name:"TeamFolder",key:encodeURI(e.fq_path)+"-UserEducationEffect"},E)},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){_.UEClient.sendEvent(this.displayName,"componentDidMount",JSON.stringify(this.props.context))},t.prototype.renderHeaderTitle=function(e,t){var r=t?u.createElement("span",{className:"brws-pinned-team-folder-info-button"},u.createElement(f.Tooltip,{position:f.TooltipPosition.RIGHT,tooltip_contents:u.createElement("div",null,t),tooltip_classname:"brws-pinned-team-folder-tooltip"},u.createElement(p.Sprite,{group:"web",name:"info",alt:m._("File section information")}))):null;return u.createElement("span",{className:"brws-pinned-team-folder-header-title"},u.createElement("span",null,e),r)},t.prototype.renderContent=function(e){var t=this.props,r=t.columnFlex,s=t.isCompactMode,n=t.teamFolders,i=m.ungettext("Team folder","Team folders",n.size),l=this.props.expSubgrowthBizTeamHomeContent?this.renderHeaderTitle(i,m._("Team folders are the hub of content for a team and contents are           automatically shared with team folder members. %(trademark_business)s           team admins own and manage team folders.").format({trademark_business:h.TRADEMARK_BUSINESS})):this.renderHeaderTitle(i,m._("Everything in a Team folder is automatically shared with your team.           Team folders can also contain shared folders for collaborating with           people outside your team.")),c=this.props.expSubgrowthBizTeamHomeContent?this.renderHeaderTitle(m._("Everything else")):this.renderHeaderTitle(m._("Other folders"),m._("These folders help you organize your private work files."));return u.createElement("div",{className:"brws-pinned-team-folder-view",style:e},u.createElement(a.Table,{columnFlex:r},u.createElement(a.TableHead,{className:o("brws-column-header","brws-pinned-team-folder-header",{"brws-column-header-compact brws-pinned-team-folder-header-compact ":s})},u.createElement(a.TableHeadCell,{className:"brws-checkbox-cell"}),u.createElement(a.TableHeadCell,{className:"brws-vertically-center"},l)),u.createElement(a.TableBody,null,n.map(this.renderTeamFolderRow))),u.createElement(a.Table,{columnFlex:r},u.createElement(a.TableHead,{className:o("brws-column-header","brws-pinned-team-folder-header","brws-pinned-team-folder-header-secondary",{"brws-column-header-compact brws-pinned-team-folder-header-compact ":s})},u.createElement(a.TableHeadCell,{className:"brws-checkbox-cell"}),u.createElement(a.TableHeadCell,{className:"brws-vertically-center"},c))))},t.prototype.render=function(){var e=this;return this.props.expSubgrowthBizTrialOnboarding?this.renderContent():u.createElement(s.Dimensions,{className:o("brws-pinned-team-folder-view-fixed",{"brws-pinned-team-folder-view-fixed-compact":this.props.isCompactMode})},function(t){var r=t.width,o=t.height;return u.createElement(n.VerticallyFixed,null,e.renderContent({width:r,height:o}))})},t})(u.Component);t.PinnedTeamFolderView=g}),define("modules/clean/react/files_view/selectable_list",["require","exports","tslib","external/immutable","external/keymaster","external/react","external/react-dom","modules/core/browser","modules/clean/react/files_view/constants"],function(e,t,r,o,s,a,n,i,l){"use strict";function c(e,t,r,o){switch(e){case u.PREV:return Math.max(0,t-1);case u.NEXT:return Math.min(r-1,t+1);case u.PREV_ROW:var s=t>=0?t-o:0;return s>=0?s:t;case u.NEXT_ROW:var a=t>=0?t+o:0;return a<r?a:t}}function d(e,t,r,o,s,a,n,i){switch(e){case u.PREV:if(0===t)return n;if(o===a)s-1>=0&&n.push(i[s-1]);else{var l=n.indexOf(i[a]);n.splice(l,1)}break;case u.NEXT:if(t===i.length)return n;if(o===s||o!==a)a+1<i.length&&n.push(i[a+1]);else{var l=n.indexOf(i[s]);n.splice(l,1)}break;case u.PREV_ROW:if(0===t)return n;if(o===a)for(var c=Math.min(r,t),d=t-1;d>=t-c;d--)n.push(i[d]);else if(o===s)for(var p=Math.min(r,t-s),d=a;d>a-p;d--){var l=n.indexOf(i[d]);n.splice(l,1)}break;case u.NEXT_ROW:if(t===i.length)return n;if(o===s)for(var c=Math.min(r,i.length-t-1),d=t+1;d<=t+c;d++)n.push(i[d]);else if(o===a)for(var p=Math.min(r,a-t),d=s;d<s+p;d++){var l=n.indexOf(i[d]);n.splice(l,1)}}return n}Object.defineProperty(t,"__esModule",{value:!0});var u,p="";(function(e){e[e.PREV=0]="PREV",e[e.NEXT=1]="NEXT",e[e.PREV_ROW=2]="PREV_ROW",e[e.NEXT_ROW=3]="NEXT_ROW"})(u=t.SelectDirection||(t.SelectDirection={})),t.findNeighboringItem=c,t.findSelectionRange=d;var h=(function(e){function t(t){var r=e.call(this,t)||this;return r.isFocused=!1,r.handleSelectPrevious=function(e){r.isGlobalEvent(e)&&(e.preventDefault(),r.selectNeighboringItem(u.PREV))},r.handleSelectPreviousRow=function(e){r.isGlobalEvent(e)&&(e.preventDefault(),r.selectNeighboringItem(u.PREV_ROW))},r.handleExtendSelectionToPrevious=function(e){r.isGlobalEvent(e)&&(e.preventDefault(),r.extendSelectionRange(u.PREV))},r.handleExtendSelectionToPreviousRow=function(e){r.isGlobalEvent(e)&&(e.preventDefault(),r.extendSelectionRange(u.PREV_ROW))},r.handleSelectNext=function(e){r.isGlobalEvent(e)&&(e.preventDefault(),r.selectNeighboringItem(u.NEXT))},r.handleSelectNextRow=function(e){r.isGlobalEvent(e)&&(e.preventDefault(),r.selectNeighboringItem(u.NEXT_ROW))},r.handleExtendSelectionToNext=function(e){r.isGlobalEvent(e)&&(e.preventDefault(),r.extendSelectionRange(u.NEXT))},r.handleExtendSelectionToNextRow=function(e){r.isGlobalEvent(e)&&(e.preventDefault(),r.extendSelectionRange(u.NEXT_ROW))},r.handleDeselectAll=function(e){var t=r.props.selection;if((!e||r.isGlobalEvent(e))&&t.selected.size&&(r.updateSelection([],!0),n.findDOMNode(r).contains(document.activeElement))){var o=document.activeElement;o.blur&&o.blur()}},r.handleSelectAll=function(e){var t=r.props,o=t.itemIds,s=t.selection;e&&!r.isGlobalEvent(e)||s.selected.size===o.length||r.updateSelection(r.props.itemIds,!0)},r.handleDeselect=function(e,t){if(t)return r.extendOrShrinkSelectionByFile(e);r.updateSelectionById(e,"delete")},r.handleSelect=function(e,t){if(t)return r.extendOrShrinkSelectionByFile(e);r.updateSelectionById(e,"add")},r.handleFocusFile=function(e){r.setState({focusedFileId:e})},r.isSelectableListEvent=function(){return r.isFocused},r.handleFocus=function(){r.isFocused=!0},r.handleBlur=function(){r.isFocused=!1},r.state={focusedFileId:null,selection:t.selection,keyScope:t.keyScope},r}return r.__extends(t,e),t.prototype.componentWillReceiveProps=function(e){this.props.keyScope!==e.keyScope&&(this.setState({keyScope:e.keyScope}),this.isFocused=!1)},t.prototype.componentDidMount=function(){this.setupKeyboardShortcuts(),this.setFocusedIdFromSelection(this.props.selection)},t.prototype.componentDidUpdate=function(e,t){e.selection&&this.props.selection&&e.selection.anchor!==this.props.selection.anchor&&this.setFocusedIdFromSelection(this.props.selection),this.state.keyScope!==t.keyScope&&this.setupKeyboardShortcuts()},t.prototype.componentWillUnmount=function(){this.cleanupKeyboardShortcuts()},t.prototype.setupKeyboardShortcuts=function(){var e=this,t=this.state.keyScope;p=s.getScope(),p!==t&&s.setScope(t);var r=s.filter||function(e){var t=e.target||e.srcElement,r=t.tagName;return!("INPUT"===r||"SELECT"===r||"TEXTAREA"===r)};s.filter=function(t){var o=t.target||t.srcElement,s=o.tagName;return(!e.isSelectableListEvent()||"BUTTON"!==s)&&(o instanceof HTMLInputElement&&"checkbox"===o.type||r.call(e,t))},t===l.SELECTABLE_LIST_KEY_SCOPE?(s("up",t,this.handleSelectPrevious),s("shift+up",t,this.handleExtendSelectionToPrevious),s("down",t,this.handleSelectNext),s("shift+down",t,this.handleExtendSelectionToNext)):t===l.TILE_GRID_SCOPE&&(s("left",t,this.handleSelectPrevious),s("shift+left",t,this.handleExtendSelectionToPrevious),s("right",t,this.handleSelectNext),s("shift+right",t,this.handleExtendSelectionToNext),s("up",t,this.handleSelectPreviousRow),s("shift+up",t,this.handleExtendSelectionToPreviousRow),s("down",t,this.handleSelectNextRow),s("shift+down",t,this.handleExtendSelectionToNextRow)),s("escape",t,this.handleDeselectAll),i.mac?s("command+a",t,this.handleSelectAll):s("ctrl+a",t,this.handleSelectAll)},t.prototype.cleanupKeyboardShortcuts=function(){s.clearScope(this.state.keyScope),p&&s.setScope(p),s.resetFilter()},t.prototype.setFocusedIdFromSelection=function(e){e.anchor&&0!==e.selected.size&&this.setState({focusedFileId:e.anchor})},t.prototype.handleTabbingStart=function(){document.body.classList.add("tabbing"),this.props.onTabbingStart()},t.prototype.updateSelection=function(e,t){void 0===t&&(t=!1);var r=this.props.selection,s=t?e.length?e[0]:this.props.itemIds[0]:r.anchor,a=r.merge({selected:o.OrderedSet(e),anchor:s});this.props.onSelectionChange(a)},t.prototype.selectNeighboringItem=function(e){var t=this.props,r=t.itemIds,o=t.selection,s=t.tilesPerRow,a=r.indexOf(o.selected.last()),n=c(e,a,r.length,s),i=r[n];this.setState({focusedFileId:i}),this.updateSelection([i],!0),this.handleTabbingStart()},t.prototype.extendSelectionRange=function(e){var t=this.props,r=t.itemIds,o=t.selection,s=t.tilesPerRow,a=o.anchor||r[0];if(a){var n=r.indexOf(o.selected.last()),i=o.selected.toArray(),l=r.indexOf(a),c=this.getRangeOfSelectedBlock(a);i=d(e,n,s,l,c.startIndex,c.endIndex,i,r),this.setState({focusedFileId:i[i.length-1]}),this.updateSelection(i),this.handleTabbingStart()}},t.prototype.getRangeOfSelectedBlock=function(e){for(var t=this.props,r=t.itemIds,o=t.selection,s=r.indexOf(e),a=0,n=0;a=s,s--,!(s<0)&&o.selected.has(r[s]););for(s=a;;){var i=r[s];if(!i||!o.selected.has(i))break;n=s,s++}return{startIndex:a,endIndex:n}},t.prototype.extendOrShrinkSelectionByFile=function(e){var t=this.props,r=t.itemIds,o=t.selection,s=o.anchor||r[0];if(s){var a=r.indexOf(s),n=r.indexOf(e),i=this.getRangeOfSelectedBlock(s),l=i.startIndex,c=i.endIndex;if(n!==c){var d=[],u=[];r.forEach(function(e,t){l<=t&&t<=c&&d.push(e),(n<=t&&t<=a||a<=t&&t<=n)&&u.push(e)}),n<a&&u.reverse();var p=o.update("selected",function(e){return e.subtract(d).union(u)});this.setState({focusedFileId:e}),this.props.onSelectionChange(p),this.handleTabbingStart()}}},t.prototype.updateSelectionById=function(e,t){var r=this.props.selection,o=r.selected[t](e),s=r.merge({selected:o,anchor:o.first()||null});this.props.onSelectionChange(s)},t.prototype.isGlobalEvent=function(e){var t=e.target instanceof HTMLInputElement,r=t&&"checkbox"===e.target.type;return!document.activeElement||document.activeElement===document.body||n.findDOMNode(this).contains(e.target)&&(!t||r)},t.prototype.render=function(){var e=this.props.children,t=this.state.focusedFileId;if(!e)return null;var r=e;return"function"==typeof e&&(r=e({focusedFileId:t,handleDeselect:this.handleDeselect,handleDeselectAll:this.handleDeselectAll,handleFocusFile:this.handleFocusFile,handleSelect:this.handleSelect,handleSelectAll:this.handleSelectAll,isSelectableListEvent:this.isSelectableListEvent})),this.state.keyScope===l.SELECTABLE_LIST_KEY_SCOPE?a.createElement("div",{onBlur:this.handleBlur,onFocus:this.handleFocus},r):a.createElement("div",null,r)},t})(a.PureComponent);t.SelectableList=h}),define("modules/clean/react/files_view/selectors",["require","exports","tslib","external/reselect","modules/clean/react/files_view/file_list_utils","modules/clean/react/browse/models"],function(e,t,r,o,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o.createSelector(function(e){return e.isCompactMode},function(e){return e.isSelectMode},function(e){return e.arePostTTIModulesLoaded},function(e){return e.isSearchMode},function(e){return e.isTabbing},function(e,t,r,o,s){return{isCompactMode:e,isSelectMode:t,arePostTTIModulesLoaded:r,isSearchMode:o,isTabbing:s}});t.getFilesViewListRowItems=o.createSelector(n,function(e){return e.activeDropTarget},function(e){return e.context},function(e){return e.createNewFolderState},function(e){return e.dropTargetHighlightMode},function(e){return e.items},function(e){return e.fileRename},function(e){return e.focusedFileId},function(e){return e.selection},function(e){return e.user},function(e){return e.visibleColumns},function(e){return e.canDisplayFolderSizes},function(e,t,o,n,i,l,c,d,u,p,h,m){var f=l.toArray().map(function(n){if(n instanceof a.Paper)return{type:"PaperRow",props:{isSearchMode:e.isSearchMode,paper:n,visibleColumns:h,arePostTTIModulesLoaded:e.arePostTTIModulesLoaded}};var l=u.selected.has(n.fq_path),f=s.shouldFileBeHighlightedDropTarget({file:n,isSelected:l,dropTargetHighlightMode:i});return{type:"FileRow",props:r.__assign({},e,{file:n,isActiveDropTarget:f&&t===n,isAvailableDropTarget:f,isFocused:n.fq_path===d,isSelected:l,isSharingDisabled:s.isSharingDisabledForFile({context:o,file:n,user:p}),renameState:c&&c.file.fq_path===n.fq_path?c.state:void 0,visibleColumns:h,canDisplayFolderSizes:m})}});return n&&"CREATE_FOLDER_INACTIVE"!==n&&f.unshift({type:"NewFolderRow",props:{createNewFolderState:n,isInsideTeamFolderTree:o.isInsideTeamFolderTree,useNewCdmIconography:!1}}),f}),t.getItemIds=o.createSelector(function(e){return e.items},function(e){return e.toArray().map(function(e){return e.fq_path})})}),define("modules/clean/react/files_view/share_button",["require","exports","tslib","spectrum/button","external/react","modules/clean/search/search_results/log_helper","modules/clean/react/files_view/types","modules/core/i18n","modules/clean/web_user_action_events"],function(e,t,r,o,s,a,n,i,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleClick=function(e){e.preventDefault();var r=t.props,o=r.file,s=r.user,i=r.onShowShare;t.props.isSearchMode&&a.recordSearchResultsAction({result:o,user:s,action_type:l.WebUserActionLogEvent.SHARE,view_type:n.ViewType.List}),i(o,"BROWSE_FILE_ROW"),e.stopPropagation()},t}return r.__extends(t,e),t.prototype.render=function(){var e=this.props.isVisible;return s.createElement(o.Button,{"aria-label":i._("Share"),className:"inline-share-button",onClick:this.handleClick,tabIndex:e?void 0:-1,variant:e?"secondary":"invisible"},i._("Share"))},t.defaultProps={isVisible:!0,isSearchMode:!1},t})(s.PureComponent);t.ShareButton=c}),define("modules/clean/react/files_view/sticky_table_head",["require","exports","tslib","spectrum/dimensions","spectrum/table","external/react","modules/clean/react/sticky/sticky","modules/clean/react/sticky/container"],function(e,t,r,o,s,a,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StickyTableHead=function(e){var t=e.children,l=e.columnFlex,c=e.offsetHeight,d=e.offsetTop,u=r.__rest(e,["children","columnFlex","offsetHeight","offsetTop"]);return a.createElement("thead",{className:"brws-sticky-table-head"},a.createElement(o.Dimensions,{tagName:"tr"},function(e){var o=e.width;return a.createElement("td",{className:"brws-sticky-table-cell"},a.createElement(i.StickyContainer,{offsetTop:d,useNativeSticky:!0,useWindowToDetermineBottom:!0},a.createElement(n.Sticky,{offsetHeight:c},a.createElement(s.Table,{columnFlex:l,style:{width:o}},a.createElement(s.TableHead,r.__assign({},u),t)))))}))}}),define("modules/clean/react/files_view/view_type_column_header_menu",["require","exports","tslib","external/react","spectrum/icon_form","spectrum/icon_mode","spectrum/popover","modules/clean/react/files_view/types","modules/core/i18n"],function(e,t,r,o,s,a,n,i,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleSelection=function(e){e!==t.props.viewType&&t.props.onSwitchViewType(e)},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.props.onTTI()},t.prototype.viewTypeTitle=function(e){switch(e){case i.ViewType.List:return l._("List");case i.ViewType.Grid:return l._("Grid");case i.ViewType.LargeGrid:return l._("Previews")}return""},t.prototype.viewTypeIcon=function(e){switch(e){case i.ViewType.List:return"list";case i.ViewType.Grid:return"tiles";case i.ViewType.LargeGrid:return"tiles"}return"list"},t.prototype.render=function(){var e=this,t=this.props,r=t.viewType,i=t.viewTypes;return o.createElement(n.Popover,{className:"brws-view-type-column-header-menu",onSelection:this.handleSelection},o.createElement(n.PopoverTrigger,{className:"brws-view-type-column-header-menu-trigger",title:this.viewTypeTitle(r)},o.createElement(a.IconMode,{name:this.viewTypeIcon(r)}),o.createElement(s.IconForm,{name:"caret-down"})),o.createElement(n.PopoverContent,{attachment:"right",className:"brws-view-type-column-header-menu-content"},o.createElement(n.PopoverItemGroup,null,o.createElement(n.PopoverItemGroupTitle,null,l._("View Mode")),i.map(function(t){return o.createElement(n.PopoverSelectableItem,{"data-viewtype":t,key:t,icon:o.createElement(a.IconMode,{name:e.viewTypeIcon(t)}),selected:r===t,value:t},e.viewTypeTitle(t))}))))},t})(o.PureComponent);t.ViewTypeColumnHeaderMenu=c}),define("modules/clean/react/partner_file_actions/app_selector_modal",["require","exports","tslib","external/react","modules/clean/react/css","modules/clean/react/image","modules/clean/react/modal","modules/core/uri","modules/core/i18n","spectrum/button","spectrum/tertiary_link","modules/clean/static_urls","modules/clean/react/partner_file_actions/feedback_modal","modules/clean/analytics"],function(e,t,r,o,s,a,n,i,l,c,d,u,p,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={showFeedbackModal:!1},t.handleClickHelloSign=function(){var e=t.getSignDocumentUri();n.Modal.close(),setTimeout(function(){window.open(e)},0)},t.showFeedbackModal=function(){h.UserActivityLogger.log("web","pfa_open_for_signature_show_feedback_clicked",{},t.props.user.id),t.setState({showFeedbackModal:!0})},t.showAppSelectorModal=function(){t.setState({showFeedbackModal:!1})},t.renderFeedbackModal=function(){return o.createElement(p.FeedbackModal,{user:t.props.user,file:t.props.file,onBack:t.showAppSelectorModal})},t.renderAppSelectorModal=function(){return o.createElement(n.Modal,{className:"app-selector-modal",ariaLabel:"App Selector Modal",acceptButtonText:null,style:"clean",width:432},o.createElement("div",{className:"app-selector-modal-body"},o.createElement("h1",{className:"app-selector-modal-header"},l._("Open for signature with")),o.createElement("div",{className:"app-selector-modal-buttons"},o.createElement(c.Button,{"aria-label":l._("Open for signature"),className:"app-selector-modal-button",onClick:t.handleClickHelloSign,variant:"secondary"},o.createElement(a.Image,{className:"app-selector-modal-button-logo",alt:l._("HelloSign"),src:u.static_url("/static/images/partner_file_actions/hellosign_logo-vflFhZ1ob.png"),srcHiRes:u.static_url("/static/images/partner_file_actions/hellosign_logo@2x-vflSsQV9w.png")})),o.createElement(d.TertiaryLink,{className:"app-selector-modal-more-link",onClick:t.showFeedbackModal},l._("I don’t see my app")))))},t}return r.__extends(t,e),t.prototype.getSignDocumentUri=function(){var e=new i.URI({path:"/pfa/sign_document"});return e.updateQuery({_subject_uid:this.props.user.id.toString(),path:this.props.file.fq_path}),e.toString()},t.prototype.render=function(){return this.state.showFeedbackModal?this.renderFeedbackModal():this.renderAppSelectorModal()},t})(o.Component);t.AppSelectorModal=s(m,["/static/css/partner_file_actions/index-vflHvuA0n.css"])}),define("modules/clean/react/partner_file_actions/feedback_modal",["require","exports","tslib","modules/clean/ajax","external/react","modules/clean/react/css","modules/clean/react/image","spectrum/button","modules/core/i18n","modules/clean/react/modal","spectrum/input","spectrum/checkbox","modules/clean/static_urls"],function(e,t,r,o,s,a,n,i,l,c,d,u,p){"use strict";function h(e){return"checked"===e?"unchecked":"checked"}Object.defineProperty(t,"__esModule",{value:!0});var m=((function(){function e(){}return e})(),(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return s.createElement("div",{className:"pfa-feedback-checkbox-and-label"},s.createElement(u.Checkbox,{id:this.props.title,className:"pfa-feedback-checkbox",checked:this.props.checked,onChange:this.props.onChange}),s.createElement("label",{htmlFor:this.props.title,className:"pfa-feedback-checkbox-label"},this.props.title))},t})(s.Component)),f=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={isDocuSignSelected:"unchecked",isPDFfillerSelected:"unchecked",isAdobeSignSelected:"unchecked",isNitroPDFSelected:"unchecked",isSmallPDFSelected:"unchecked",isPandaDocSelected:"unchecked",suggestionsText:"",commentsText:"",showThankYouModal:!1},t.submitFeedback=function(){var e=Array();"checked"===t.state.isDocuSignSelected&&e.push("DocuSign"),"checked"===t.state.isPDFfillerSelected&&e.push("PDFfiller"),"checked"===t.state.isAdobeSignSelected&&e.push("Adobe Sign"),"checked"===t.state.isNitroPDFSelected&&e.push("Nitro PDF"),"checked"===t.state.isSmallPDFSelected&&e.push("SmallPDF"),"checked"===t.state.isPandaDocSelected&&e.push("PandaDoc"),o.SilentBackgroundRequest({url:"/pfa/app_choice_feedback",subject_user:t.props.user.id,data:{category:"signature",selected_apps:e.join(", "),other_suggested_apps:t.state.suggestionsText,comments:t.state.commentsText}}),t.setState({showThankYouModal:!0})},t.onSuggestedAppsChanged=function(e){t.setState({suggestionsText:e.currentTarget.value.trim()})},t.onCommentChanged=function(e){t.setState({commentsText:e.currentTarget.value.trim()})},t.onDocuSignChanged=function(){t.setState({isDocuSignSelected:h(t.state.isDocuSignSelected)})},t.onPDFfillerChanged=function(){t.setState({isPDFfillerSelected:h(t.state.isPDFfillerSelected)})},t.onAdobeSignChanged=function(){t.setState({isAdobeSignSelected:h(t.state.isAdobeSignSelected)})},t.onNitroPDFChanged=function(){t.setState({isNitroPDFSelected:h(t.state.isNitroPDFSelected)})},t.onSmallPDFSelected=function(){t.setState({isSmallPDFSelected:h(t.state.isSmallPDFSelected)})},t.onPandaDocsSelected=function(){t.setState({isPandaDocSelected:h(t.state.isPandaDocSelected)})},t.isAnyFeedbackInput=function(){return"checked"===t.state.isDocuSignSelected||"checked"===t.state.isPDFfillerSelected||"checked"===t.state.isAdobeSignSelected||"checked"===t.state.isNitroPDFSelected||"checked"===t.state.isSmallPDFSelected||"checked"===t.state.isPandaDocSelected||t.state.suggestionsText.length>0||t.state.commentsText.length>0},t.renderFeedbackModel=function(){return s.createElement(c.Modal,{className:"pfa-feedback-modal",ariaLabel:"Feedback Modal",acceptButtonText:null,style:"clean",title:l._("Which app were you looking for?"),autoFocusPrimaryInput:!1,width:"560"},s.createElement("div",{className:"pfa-feedback-inputs"},s.createElement("div",{className:"pfa-feedback-title"},s.createElement("h1",{className:"pfa-feedback-modal-header"},l._("Which app were you looking for?"))),s.createElement("div",{className:"pfa-feedback-checkbox-container"},s.createElement(m,{checked:t.state.isDocuSignSelected,title:"DocuSign",onChange:t.onDocuSignChanged}),s.createElement(m,{checked:t.state.isAdobeSignSelected,title:"Adobe Sign",onChange:t.onAdobeSignChanged}),s.createElement(m,{checked:t.state.isPDFfillerSelected,title:"PDFfiller/SignNow",onChange:t.onPDFfillerChanged}),s.createElement(m,{checked:t.state.isNitroPDFSelected,title:"Nitro PDF",onChange:t.onNitroPDFChanged}),s.createElement(m,{checked:t.state.isSmallPDFSelected,title:"SmallPDF",onChange:t.onSmallPDFSelected}),s.createElement(m,{checked:t.state.isPandaDocSelected,title:"PandaDocs",onChange:t.onPandaDocsSelected})),s.createElement("div",{className:"pfa-feedback-suggestions"},s.createElement("label",{htmlFor:"pfa-app-suggestion-input",className:"pfa-app-feedback-label"},l._("Suggest a different app")),s.createElement(d.Input,{id:"pfa=app-suggestion-input",className:"pfa-app-suggestion-input",onChange:t.onSuggestedAppsChanged,"aria-label":l._("app suggestion input")}),s.createElement("label",{htmlFor:"pfa-feedback-comments",className:"pfa-app-feedback-label"},l._("Add comments (optional)")),s.createElement("textarea",{id:"pfa-feedback-comments",className:"pfa-feedback-comments textinput c-input",onChange:t.onCommentChanged,"aria-label":l._("feedback"),rows:4}))),s.createElement("div",{className:"pfa-feedback-action-bar"},s.createElement(i.Button,{variant:"secondary",className:"pfa-app-feedback-action-bar-button",onClick:t.props.onBack},l._("Back")),s.createElement("div",{className:"pfa-feedback-action-bar-space"}),s.createElement(i.Button,{variant:"primary",className:"pfa-app-feedback-action-bar-button",disabled:!t.isAnyFeedbackInput(),onClick:t.submitFeedback},l._("Send suggestion"))))},t.renderThankYouModal=function(){return s.createElement(c.Modal,{className:"pfa-feedback-thank-you-modal",ariaLabel:"Feedback Modal",acceptButtonText:null,style:"clean"},s.createElement(n.Image,{className:"pfa-feedback-thank-you-image",alt:l._("Thank you"),src:p.static_url("/static/images/partner_file_actions/feedback_comments-vfluWMAvS.png"),srcHiRes:p.static_url("/static/images/partner_file_actions/feedback_comments@2x-vflWa-9nT.png")}),s.createElement("h1",{className:"pfa-feedback-thank-you-header"},l._("Thanks for letting us know!")),s.createElement("h2",{className:"pfa-feedback-thank-you-subtext"},l._("Your feedback will help make Dropbox even better.")))},t}return r.__extends(t,e),t.prototype.render=function(){return this.state.showThankYouModal?this.renderThankYouModal():this.renderFeedbackModel()},t})(s.Component);t.FeedbackModal=a(f,["/static/css/partner_file_actions/index-vflHvuA0n.css"])}),define("modules/clean/react/partner_file_actions/partner_file_action_button",["require","exports","tslib","external/react","modules/clean/react/css","spectrum/button","modules/core/i18n","modules/clean/analytics","modules/clean/react/partner_file_actions/app_selector_modal","modules/clean/react/modal"],function(e,t,r,o,s,a,n,i,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleClick=function(e){e.preventDefault(),t.showAppSelectorModal(),i.UserActivityLogger.log("web","pfa_open_for_signature_clicked",{action_context:t.props.actionContext},t.props.user.id),e.stopPropagation()},t.showAppSelectorModal=function(){c.Modal.showInstance(o.createElement(l.AppSelectorModal,{user:t.props.user,file:t.props.file}))},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.props.logExposure&&this.props.logExposure()},t.prototype.buttonClass=function(){return"browse_list"===this.props.actionContext?"partner-file-action-button control__button":"partner-file-action-button-file-viewer control__button"},t.prototype.render=function(){switch(this.props.variant){case"NORMAL_BUTTON":return o.createElement(a.Button,{"aria-label":n._("Open for signature"),className:this.buttonClass(),onClick:this.handleClick,variant:"secondary"},this.props.text);default:return null}},t})(o.Component);t.PartnerFileActionButton=s(d,["/static/css/partner_file_actions/index-vflHvuA0n.css"])}),define("modules/clean/search/api",["require","exports","modules/clean/ajax","modules/clean/analytics","modules/clean/react/browse/models","modules/clean/search/search_helpers","modules/clean/search/constants","modules/clean/search/types","modules/clean/search/models","modules/clean/search/api_helpers"],function(e,t,r,o,s,a,n,i,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=(function(){function e(){this._activeRequest=null}return e.prototype.abortPreviousLoading=function(){null!=this._activeRequest&&this._activeRequest.abort()},e.prototype.loadResults=function(e){var t=e.user,r=e.path,o=e.query,s=e.start,i=e.maxResults,l=e.searchSessionId,d=e.nsid,u=e.fileNameOnly,p=e.loadDeleted,h=e.showPaperResults,m=e.isDropdown,f=e.isAdminConsole,_=e.showSymlinkIcon,S=e.webTimer,g=e.onSuccess,w=e.onError,v=c.getCurrentTimezoneOffset(),b={query:o,search_token:a.getSearchCsrfToken(),fq_path:r,ns_id:d,filename_only:!!u,max_results:i,deleted:!!p,start:s,show_paper_results:!!h,is_dropdown:!!m,is_admin_console:!!f,show_unmounted_results:!0,timezone_offset:v,show_symlink_icon:_,include_browse_context:!0};this._fetchResults({requestData:b,user:t,searchSessionId:l,url:n.FULLTEXT_SEARCH_ENDPOINT,onSuccess:g,onError:w,webTimer:S})},e.prototype._extractSearchResultsList=function(e){for(var t=[],r=0,o=e;r<o.length;r++){var a=o[r];switch(a.search_result_type){case i.SearchResultTypes.FILE:t.push(s.File.fromServerObject(a));break;case i.SearchResultTypes.PAPER:t.push(s.Paper.fromServerObject(a));break;case i.SearchResultTypes.PAPER_FOLDER:t.push(s.PaperFolder.fromServerObject(a))}}return t},e.prototype._getSearchType=function(e){return e.is_dropdown?"dropdown":e.deleted?"full_page_deleted":"full_page"},e.prototype.loadPartialResults=function(e){var t=e.user,r=e.endpoint,o=e.maxResults,s=e.start,n=e.path,i=e.query,l=e.searchSessionId,c=e.showSymlinkIcon,d=e.includeBrowseContext,u=e.showCDMIconography,p=e.webTimer,h=e.onSuccess,m=e.onError,f={query:i,search_token:a.getSearchCsrfToken(),fq_path:n,start:s,max_results:o,show_paper_results:!0,show_symlink_icon:c,include_browse_context:d,show_cdm_iconography:u};this._fetchResults({requestData:f,user:t,searchSessionId:l,url:r,onSuccess:h,onError:m,webTimer:p})},e.prototype._fetchResults=function(e){var t=this,s=e.requestData,a=e.user,n=e.searchSessionId,i=e.url,c=e.onSuccess,d=e.onError,u=e.webTimer;null!=this._activeRequest&&this._activeRequest.abort();var p={path_scoped:"/"!==s.fq_path,search_type:this._getSearchType(s),query_string:s.query,start:s.start,search_session_id:n,timezone_offset:s.timezone_offset};o.SearchClientActivityLogger.log("query_started",a.id,p);var h=(new Date).getTime();this._activeRequest=r.WebRequest({url:i,data:s,dataType:"json",
subject_user:a,success:function(e,r,i){var d;s.include_browse_context&&(d=l.extractBrowseContext(e));var m=e.search_results,f=i.getResponseHeader("x-dropbox-request-id");m.forEach(function(e){return e.request_id=f});var _=!!m.find(function(e){return e.used_spellcorrect}),S=t._extractSearchResultsList(m);c({context:d,searchResults:S,deleted:!!s.deleted});var g=o.SearchClientActivityLogger.create_search_log_dict(p,_,f,h,s.query,S.length,null,n);o.SearchClientActivityLogger.log("query_completed",a.id,g),u&&u.end(f?f:void 0)},error:function(e,t,r){"abort"!==t&&"function"==typeof d&&d(r);var i=e.getResponseHeader("x-dropbox-request-id"),l=o.SearchClientActivityLogger.create_search_log_dict(p,null,i,h,s.query,null,t,n);o.SearchClientActivityLogger.log("query_failed",a.id,l),u&&u.abort()},complete:function(){this._activeRequest=null}})},e.prototype.fetchAdditionalFileMetadata=function(e){var t=e.searchResults,o=e.user,a=e.onSuccess,i=e.onError,l=t.filter(function(e){return e instanceof s.File}),c=l.map(function(e){return[e.ns_id,e.sjid]});c.length>0?r.WebRequest({url:n.SEARCH_METADATA_ENDPOINT,data:{nsid_sjid_pairs:JSON.stringify(c)},dataType:"json",subject_user:o,success:function(e,t,r){for(var o=[],n=0,i=e.search_results;n<i.length;n++){var l=i[n];o.push(s.File.fromServerObject(l))}a(o)},error:function(e,t,r){"abort"!==t&&"function"==typeof i&&i(r)}}):a(t)},e})();t.SearchApiClient=d,t.searchApiClient=new d}),define("modules/clean/search/search_results/actions",["require","exports","tslib","modules/clean/search/constants","modules/core/i18n","modules/clean/search/search_results/dispatcher","modules/clean/search/api","modules/clean/search/search_results/store","modules/clean/search/types","modules/clean/search/constants"],function(e,t,r,o,s,a,n,i,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=(function(){function e(e,t){void 0===e&&(e=n.searchApiClient),void 0===t&&(t=i.getSearchResultsStore()),this._searchApi=e,this._searchResultsStore=t}return e.prototype.runSearch=function(e){var t=this,r=e.user,s=e.path,n=e.query,i=e.searchSessionId,d=e.webTimer,u=e.logOnceFetchedDataRequiredForTTI,p=e.fetchPartialResultVariant,h=e.deletedFiles,m=e.showSymlinkIcon,f=e.showCDMIconography;a.SearchResultsDispatcher.dispatch({type:o.START_SEARCH_ACTION,data:{query:n,searchSessionId:i}});var _=c.MaxResults.MAX_SEARCH_RESULTS;if(this._shouldFetchPartialSearchResult(p)&&h!==!0){var S=void 0;S=p===l.FetchPartialResultVariants.FRONTEND_SERVICE?o.PARTIAL_SEARCH_FRONTEND_SERVICE_ENDPOINT:o.PARTIAL_SEARCH_METASERVER_ENDPOINT,this._searchApi.loadPartialResults({user:r,endpoint:S,path:s,query:n,start:0,searchSessionId:i,showSymlinkIcon:m,includeBrowseContext:!0,showCDMIconography:f,webTimer:d,maxResults:_,onSuccess:function(e){var o=e.searchResults,a=e.context;u(),t._setSearchResults({searchResults:o,context:a}),void 0===h&&t._loadDeletedResults({path:s,user:r}),t._searchApi.fetchAdditionalFileMetadata({searchResults:o,user:r,onSuccess:function(e){t._setFullSearchResults({searchResults:e})}})}})}else this._searchApi.loadResults({user:r,path:s,query:n,start:0,maxResults:_,showPaperResults:!0,searchSessionId:i,showSymlinkIcon:m,webTimer:d,loadDeleted:h,onSuccess:function(e){var o=e.searchResults,a=e.context;u(),t._setSearchResults({searchResults:o,context:a}),void 0===h&&t._loadDeletedResults({path:s,user:r})}})},e.prototype.fetchCompleteSearchResultSRP=function(e){var t=this,r=e.searchApiClient,o=e.searchResult,a=e.user,n=e.onSuccess,l=e.onError,c=i.getSearchResultsStore().fullSearchResults().get(o.fq_path,null);if(c){n(this._mergePartialAndCompleteResult({partialResult:o,completeResult:c}))}else r.fetchAdditionalFileMetadata({searchResults:[o],user:a,onSuccess:function(e){if(e.length>0){n(t._mergePartialAndCompleteResult({partialResult:o,completeResult:e[0]}))}else if(l){var r=s._("There was a problem completing this request.");l(r)}},onError:l})},e.prototype._mergePartialAndCompleteResult=function(e){var t=e.partialResult,o=e.completeResult;return r.__assign({},o,{filename_highlights:t.filename_highlights,match_type:t.match_type,request_id:t.request_id,sort_key:t.sort_key,sort_rank:t.sort_rank})},e.prototype.loadMoreResults=function(e){var t=this,r=e.path,s=e.user,n=e.fetchPartialResultVariant,i=e.deletedFiles,d=e.showSymlinkIcon,u=e.showCDMIconography,p=!1;if(this._searchResultsStore.loadingState()===o.SearchLoadingState.LOADED){if(void 0===i)if(this._searchResultsStore.hasMoreResults())p=!1;else{if(!this._searchResultsStore.hasMoreResults(!0))return;p=!0}else p=i;a.SearchResultsDispatcher.dispatch({type:o.CONTINUE_SEARCH_ACTION,data:{didLoadDeletedResults:p}});var h=p?this._searchResultsStore.numDeletedResults():this._searchResultsStore.searchResults().size;if(this._shouldFetchPartialSearchResult(n)&&!p){var m=void 0;m=n===l.FetchPartialResultVariants.FRONTEND_SERVICE?o.PARTIAL_SEARCH_FRONTEND_SERVICE_ENDPOINT:o.PARTIAL_SEARCH_METASERVER_ENDPOINT,this._searchApi.loadPartialResults({user:s,endpoint:m,path:r,query:this._searchResultsStore.latestQuery(),start:h,showSymlinkIcon:d,includeBrowseContext:!1,showCDMIconography:u,searchSessionId:this._searchResultsStore.searchSessionId(),maxResults:c.MaxResults.MAX_SEARCH_RESULTS,onSuccess:function(e){var o=e.searchResults;e.context;t._appendSearchResults({searchResults:o,deleted:!1}),t._searchApi.fetchAdditionalFileMetadata({searchResults:o,user:s,onSuccess:function(e){t._setFullSearchResults({searchResults:e})}}),void 0===i&&t._loadDeletedResults({path:r,user:s})}})}else this._searchApi.loadResults({user:s,path:r,query:this._searchResultsStore.latestQuery(),fileNameOnly:!1,showPaperResults:!0,isDropdown:!1,isAdminConsole:!1,loadDeleted:p,start:h,maxResults:c.MaxResults.MAX_SEARCH_RESULTS,searchSessionId:this._searchResultsStore.searchSessionId(),showSymlinkIcon:d,onSuccess:function(e){var o=e.searchResults,a=(e.context,e.deleted);t._appendSearchResults({searchResults:o,deleted:a}),void 0===i&&t._loadDeletedResults({path:r,user:s})}})}},e.prototype._shouldFetchPartialSearchResult=function(e){return e===l.FetchPartialResultVariants.FRONTEND_SERVICE||e===l.FetchPartialResultVariants.METASERVER},e.prototype._setSearchResults=function(e){var t=e.searchResults,r=e.context;a.SearchResultsDispatcher.dispatch({type:o.SET_SEARCH_RESULTS_ACTION,data:{searchResults:t,context:r}})},e.prototype._setFullSearchResults=function(e){var t=e.searchResults;a.SearchResultsDispatcher.dispatch({type:o.SET_FULL_SEARCH_RESULTS_ACTION,data:{searchResults:t}})},e.prototype._appendSearchResults=function(e){var t=e.searchResults,r=e.deleted;a.SearchResultsDispatcher.dispatch({type:o.APPEND_SEARCH_RESULTS_ACTION,data:{searchResults:t,deleted:r}})},e.prototype._loadDeletedResults=function(e){var t=e.path,r=e.user;this._searchResultsStore.hasMoreResults()||this._searchResultsStore.didLoadDeletedResults()||this.loadMoreResults({path:t,user:r})},e.prototype.setSearchSelection=function(e){var t=e.selection;a.SearchResultsDispatcher.dispatch({type:o.SET_SEARCH_SELECTION_ACTION,data:{selection:t}})},e.prototype.removeSearchResults=function(e){var t=e.fq_paths,r=t.map(function(e){return{before:e,after:null}});a.SearchResultsDispatcher.dispatch({type:o.CHANGE_FILES_ACTION,data:{fileDeltas:r}})},e.prototype.clearSearch=function(){a.SearchResultsDispatcher.dispatch({type:o.CLEAR_SEARCH_ACTION})},e})();t.SearchResultsActions=d,t.searchResultsActions=new d}),define("modules/clean/search/search_results/controller",["require","exports","tslib","external/lodash","external/react","external/react-dom","modules/clean/react/async_file_modal_controller","modules/clean/react/browse/models","modules/clean/react/browse/store","modules/clean/react/css","modules/clean/search/api","modules/clean/search/search_results/actions","modules/clean/search/search_results/store","modules/clean/search/search_results/view","modules/clean/search/types"],function(e,t,r,o,s,a,n,i,l,c,d,u,p,h,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(t){function c(){var e=null!==t&&t.apply(this,arguments)||this;return e._onSearchResultsStoreChanged=function(){e.setState(e._getStateFromSearchResultsStore()),e.deferredCheckForMissingStarredData&&e.deferredCheckForMissingStarredData()},e._onBrowseStoreChanged=function(){e.setState(e._getStateFromBrowseStore())},e._handleScroll=function(){if(a.findDOMNode(e).getBoundingClientRect().bottom<=window.innerHeight){var t=e.props.searchResultsExperiments&&e.props.searchResultsExperiments.expFetchPartialSearchResultInFrontendService,r=e.props.searchResultsExperiments&&e.props.searchResultsExperiments.expShowSymlinkIcon,o=e.props.searchResultsExperiments&&e.props.searchResultsExperiments.expShowCDMIconography;u.searchResultsActions.loadMoreResults({path:e.props.path,user:e.props.user,fetchPartialResultVariant:t,showSymlinkIcon:!!r,showCDMIconography:!!o})}},e._handleSelectionChange=function(e){u.searchResultsActions.setSearchSelection({selection:e})},e._handlePermanentDelete=function(t){var r=function(){u.searchResultsActions.removeSearchResults({fq_paths:t.map(function(e){return e.fq_path})})};n.showPermanentlyDelete(e.props.user,t,r)},e._onNavigateToFileOrFolder=function(t){var r=e.props.searchResultsExperiments.expFetchPartialSearchResultInFrontendService;r===m.FetchPartialResultVariants.FRONTEND_SERVICE||r===m.FetchPartialResultVariants.METASERVER?u.searchResultsActions.fetchCompleteSearchResultSRP({searchApiClient:d.searchApiClient,searchResult:t,user:e.props.user,onSuccess:e.props.onNavigateToFileOrFolder}):e.props.onNavigateToFileOrFolder(t)},e}return r.__extends(c,t),c.prototype.componentWillMount=function(){this.state=this._getStateFromStores()},c.prototype.componentWillReceiveProps=function(e){e.arePostTTIModulesLoaded&&!this.props.arePostTTIModulesLoaded&&this.enableStarring()},c.prototype.componentDidMount=function(){p.getSearchResultsStore().add_change_listener(this._onSearchResultsStoreChanged),l.getBrowseStore().add_change_listener(this._onBrowseStoreChanged),this.props.arePostTTIModulesLoaded&&this.enableStarring(),this.setState(this._getStateFromStores()),window.scrollTo(0,0)},c.prototype.componentWillUnmount=function(){p.getSearchResultsStore().remove_change_listener(this._onSearchResultsStoreChanged),l.getBrowseStore().remove_change_listener(this._onBrowseStoreChanged)},c.prototype.enableStarring=function(){var t=this,r=e("modules/clean/react/starred/browse_exports").checkForMissingStarredData;this.deferredCheckForMissingStarredData=function(){o.defer(function(){var e=[],o=t.props.searchResultsExperiments.expFetchPartialSearchResultInFrontendService;p.getSearchResultsStore().searchResults().forEach(function(r){r instanceof i.File&&(o===m.FetchPartialResultVariants.FRONTEND_SERVICE||o===m.FetchPartialResultVariants.METASERVER?e.push({fq_path:r.fq_path}):e.push(r)),t.props.searchResultsExperiments&&t.props.searchResultsExperiments.expShowPaperStars&&(r instanceof i.Paper||r instanceof i.PaperFolder)&&e.push(r)}),r({items:e,user:t.props.user})})},this.deferredCheckForMissingStarredData()},c.prototype._getStateFromStores=function(){return r.__assign({},this._getStateFromBrowseStore(),this._getStateFromSearchResultsStore())},c.prototype._getStateFromBrowseStore=function(){var e=l.getBrowseStore();return{viewType:e.viewType(),tilesPerRow:e.tilesPerRow()}},c.prototype._getStateFromSearchResultsStore=function(){var e=p.getSearchResultsStore();return{context:e.browseContext(),hasMoreResults:e.hasMoreResults(),loadingState:e.loadingState(),latestQuery:e.latestQuery(),searchSessionId:e.searchSessionId(),fullSearchResults:e.fullSearchResults(),searchResults:e.searchResults(),selection:e.selection(),selectedFiles:e.selectedFiles()}},c.prototype.render=function(){var e=this.props,t=e.searchResultsExperiments,a=e.maestroSearchBarProps,n=e.onSearch,i=e.setFileUploaderPath,l=e.path,c=e.user,d=e.handleComponentTTI,u=e.ensureFileViewerClosedIfNotPreviewing,p=e.getIsFileJumping,m=e.isFileViewerShown,f=e.fileRename,_=e.arePostTTIModulesLoaded,S=e.getOverflowMenuActions,g=e.filesViewActionHandlers,w=e.onNavigateToParentFolder,v=e.onNavigateToPath,b=e.shouldShowDeletedFiles,T=e.browseExperiments,F=this.state,E=F.context,y=F.hasMoreResults,R=F.loadingState,C=F.latestQuery,A=F.searchSessionId,I=F.searchResults,P=F.selection,N=F.selectedFiles,D=F.viewType,x=F.tilesPerRow,L=r.__assign({},this.props.actionHandlers,{onPermanentDelete:this._handlePermanentDelete});return s.createElement(h.SearchResultsView,{filesViewActionHandlers:g,searchResultsExperiments:t,browseExperiments:T,maestroSearchBarProps:a,onSearch:n,onScroll:o.throttle(this._handleScroll,200),setFileUploaderPath:i,onSelectionChange:this._handleSelectionChange,path:l,user:c,actionHandlers:L,handleComponentTTI:d,ensureFileViewerClosedIfNotPreviewing:u,getIsFileJumping:p,isFileViewerShown:m,fileRename:f,arePostTTIModulesLoaded:_,getOverflowMenuActions:S,onNavigateToFileOrFolder:this._onNavigateToFileOrFolder,onNavigateToParentFolder:w,onNavigateToPath:v,context:E,hasMoreResults:y,loadingState:R,latestQuery:C,searchSessionId:A,searchResults:I,selection:P,selectedFiles:N,viewType:D,tilesPerRow:x,shouldShowDeletedFiles:b})},c})(s.Component);t.SearchResultsController=c(f,["/static/css/browse/browse-vfl4_qi6g.css","/static/css/search/search_results-vflNI3JLA.css","/static/css/scooter/scooter-scoped-vflhQ6850.css"])}),define("modules/clean/search/search_results/dispatcher",["require","exports","modules/core/exception","modules/clean/flux/dispatcher","modules/clean/search/search_results/store"],function(e,t,r,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SearchResultsDispatcher={dispatch:function(e){r.assert(s.searchResultsStoreInstantiated(),"Must call getSearchResultsStore() before a dispatch"),o.Dispatcher.dispatch(e)}}}),define("modules/clean/search/search_results/log_helper",["require","exports","modules/clean/search/logger","modules/clean/search/search_results/store","modules/clean/search/search_bar/data/store","modules/clean/search/search_bar/data/action_creators","modules/clean/search/search_bar/data/selectors","modules/clean/search/search_bar/experiments"],function(e,t,r,o,s,a,n,i){"use strict";function l(e){var t=e.result,l=e.user,c=e.action_type,d=e.view_type,u=o.getSearchResultsStore().searchSessionId();if(i.recentHistoryEnabled(n.experiments(s.getStoreForSearchBar().getState()))){var p=o.getSearchResultsStore().latestQuery(),h={rawQuery:p,normalizedQuery:p};s.getStoreForSearchBar().dispatch(a.addQueryToHistory({user:l,query:h,searchSessionId:u,requestId:t.request_id||""}))}r.logSearchAction({searchSessionId:u,result:t,user:l,action_type:c,search_type:"full_page",viewport:"full-view",view_type:d})}Object.defineProperty(t,"__esModule",{value:!0}),t.recordSearchResultsAction=l}),define("modules/clean/search/search_results/search_filter_sidebar",["require","exports","tslib","external/react","modules/core/i18n","spectrum/tertiary_link","spectrum/label","spectrum/radio_button","modules/clean/filepath","modules/clean/react/async_folder_selector_modal","modules/clean/react/path_filter_button","modules/clean/search/search_helpers"],function(e,t,r,o,s,a,n,i,l,c,d,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=(function(e){function t(t){var r=e.call(this,t)||this;return r.showFolderFilterModal=function(){var e=r.props,t=e.user,o=e.path,a=e.onFiltersChanged;c.show({primaryAction:s._("Select"),secondaryAction:s._("Cancel"),title:s._("Select a folder"),ariaLabel:s._("Folder selector"),user:t,initialFolderSelection:o,forceRootSelectable:!0,onFolderSelected:function(e){a({path:e})}})},r.resetFilters=function(){var e=r.props,t=e.searchResultsExperiments,o=e.onFiltersChanged,s={};u.isInDeletedFilterRightRailExperiment(t)&&(s.deletedFiles=!1),u.isInScopeFilterRightRailExperiment(t)&&(s.path="/"),o(s)},r.shouldRenderResetButton=function(){var e=r.props,t=e.path,o=e.deletedFiles;return!l.paths_are_equal(t,"/")||!!o},r.renderResetButton=function(){return o.createElement(a.TertiaryLink,{onClick:r.resetFilters,className:"search-filters__reset"},s._("Reset filters"))},r.renderPathFilter=function(){var e=r.props.path;return o.createElement("div",{className:"filter-item__row"},o.createElement("div",{className:"filter-item__column"},o.createElement("div",{className:"filter-item__desc"},s._("In folder")),o.createElement(d.PathFilterButton,{path:e,defaultText:s._("Any folder"),dropdownClasses:"filter-item__filter",onClick:r.showFolderFilterModal})))},r.handleDeletedFilesAll=function(){r.props.onFiltersChanged({deletedFiles:!1})},r.handleDeletedFilesDeleted=function(){r.props.onFiltersChanged({deletedFiles:!0})},r.renderDeletedFilter=function(){var e=r.props.deletedFiles;return o.createElement("div",{className:"filter-item__row"},o.createElement("div",{className:"filter-item__column"},o.createElement("div",{className:"filter-item__desc"},s._("By status")),o.createElement("div",null,o.createElement(n.Label,{htmlFor:"filter-type-all"},o.createElement(i.RadioButton,{"aria-checked":!0,checked:!e,id:"filter-type-all",value:"all",onChange:r.handleDeletedFilesAll}),s._("Available"))),o.createElement("div",null,o.createElement(n.Label,{htmlFor:"filter-type-deleted"},o.createElement(i.RadioButton,{"aria-checked":!0,checked:e,id:"filter-type-deleted",value:"deleted",onChange:r.handleDeletedFilesDeleted}),s._("Deleted")))))},r}return r.__extends(t,e),t.prototype.render=function(){var e=this.props.searchResultsExperiments;return o.createElement("div",null,o.createElement("div",{className:"filter-header"},o.createElement("h3",null,s._("Filter")),this.shouldRenderResetButton()&&this.renderResetButton()),o.createElement("div",{className:"filter-item"},u.isInScopeFilterRightRailExperiment(e)&&this.renderPathFilter()),o.createElement("div",{className:"filter-item"},u.isInDeletedFilterRightRailExperiment(e)&&this.renderDeletedFilter()))},t})(o.Component);t.SearchFilterSidebar=p}),define("modules/clean/search/search_results/store",["require","exports","tslib","external/immutable","modules/clean/filepath","modules/clean/flux/base_store","modules/clean/react/selection","modules/clean/search/constants","modules/clean/react/browse/constants","modules/clean/react/browse/models","modules/clean/search/store_helpers"],function(e,t,r,o,s,a,n,i,l,c,d){"use strict";function u(){return null===m&&(m=new h),m}function p(){return null!==m}Object.defineProperty(t,"__esModule",{value:!0});var h=(function(e){function t(t){var r=e.call(this,t)||this;return r._resetSearchResults(),r}return r.__extends(t,e),t.prototype._resetSearchResults=function(){this._browseContext=void 0,this._rawQuery="",this._latestQuery="",this._loadingState=i.SearchLoadingState.LOADED,this._fullSearchResults=o.OrderedMap(),this._searchResults=o.List(),this._selection=void 0,this._hasMoreLiveResults=!0,this._numDeletedResults=0,this._hasMoreDeletedResults=!0,this._didLoadDeletedResults=!1,this._tilesPerRow=1},t.prototype.rawQuery=function(){return this._rawQuery},t.prototype.searchSessionId=function(){return this._searchSessionId},t.prototype.browseContext=function(){return this._browseContext||(this._browseContext=new c.BrowseContext)},t.prototype.latestQuery=function(){return this._latestQuery},t.prototype.loadingState=function(){return this._loadingState},t.prototype.searchResults=function(){return this._searchResults},t.prototype.fullSearchResults=function(){return this._fullSearchResults},t.prototype.tilesPerRow=function(){return this._tilesPerRow},t.prototype.hasMoreResults=function(e){return void 0===e&&(e=!1),this._hasMoreLiveResults||e&&this._hasMoreDeletedResults},t.prototype.numDeletedResults=function(){return this._numDeletedResults},t.prototype.didLoadDeletedResults=function(){return this._didLoadDeletedResults},t.prototype.selection=function(){return this._selection||(this._selection=n.createSelection())},t.prototype.selectedFiles=function(){var e=this,t=this._searchResults.filter(function(t){return t instanceof c.File&&e.selection().selected.has(t.fq_path)});return o.OrderedMap(t.map(function(e){return[e.fq_path,e]}))},t.prototype._setRawQuery=function(e,t){t?this._searchSessionId=t:d.shouldStartNewSearchSession(this._rawQuery,e)&&(this._searchSessionId=d.generateRandomId()),this._rawQuery=e},t.prototype._setSearchQuery=function(e){var t=e.query;this._setRawQuery(t),this.emit_change()},t.prototype._startSearch=function(e){var t=e.query,r=e.searchSessionId;this._resetSearchResults(),this._setRawQuery(t,r),this._latestQuery=d.normalize(t),this._loadingState=i.SearchLoadingState.LOADING_FIRST_PAGE,this.emit_change()},t.prototype._setSearchResults=function(e){var t=e.searchResults,r=e.context;this._setSearchResultsInternal(t),this._loadingState=i.SearchLoadingState.LOADED,r&&(this._browseContext=r),this._updateMoreResults(t),this.emit_change()},t.prototype._setFullSearchResults=function(e){for(var t=e.searchResults,r=0,o=t;r<o.length;r++){var s=o[r];s instanceof c.File&&(this._fullSearchResults=this._fullSearchResults.set(s.fq_path,s))}this._loadingState=i.SearchLoadingState.LOADED,this.emit_change()},t.prototype._setSearchResultsInternal=function(e){this._searchResults=o.List(e)},t.prototype._continueSearch=function(e){e.didLoadDeletedResults&&(this._didLoadDeletedResults=!0),this._loadingState=i.SearchLoadingState.LOADING_ADDITIONAL_PAGE,this.emit_change()},t.prototype._appendSearchResults=function(e){var t=e.deleted,r=e.searchResults;t&&(this._numDeletedResults+=r.length),this._searchResults=this._searchResults.concat(r),this._loadingState=i.SearchLoadingState.LOADED,this._updateMoreResults(r),this.emit_change()},t.prototype._clearSearch=function(){this._resetSearchResults(),this.emit_change()},t.prototype._updateMoreResults=function(e){var t=e.length===i.MaxResults.MAX_SEARCH_RESULTS;this._hasMoreLiveResults?this._hasMoreLiveResults=t:this._hasMoreDeletedResults&&(this._hasMoreDeletedResults=t)},t.prototype._setSearchSelection=function(e){var t=e.selection;this._selection=t,this.emit_change()},t.prototype._setTilesPerRow=function(e){var t=e.tilesPerRow;this._tilesPerRow=t,this.emit_change()},t.prototype._applyFileDeltas=function(e){var t=e.fileDeltas;if(t){for(var r=function(e,t){var r=void 0;!e&&t?o._searchResults=o._searchResults.push(t):e&&!t?(r=o._searchResults.findIndex(function(t){return t instanceof c.File&&s.paths_are_equal(t.fq_path,e)}),o._searchResults=o._searchResults.delete(r)):e&&t&&(r=o._searchResults.findIndex(function(t){return t instanceof c.File&&s.paths_are_equal(t.fq_path,e)}),o._searchResults=r>-1?o._searchResults.set(r,t):o._searchResults.push(t))},o=this,a=0,n=t;a<n.length;a++){var i=n[a];r(i.before,i.after)}this.emit_change()}},t.prototype._updateContext=function(e){this._browseContext=e.context},t.prototype._new_payload=function(e){switch(e.action.type){case i.START_SEARCH_ACTION:this._startSearch(e.action.data);break;case i.SET_SEARCH_RESULTS_ACTION:this._setSearchResults(e.action.data);break;case i.CONTINUE_SEARCH_ACTION:this._continueSearch(e.action.data);break;case i.APPEND_SEARCH_RESULTS_ACTION:this._appendSearchResults(e.action.data);break;case i.SET_FULL_SEARCH_RESULTS_ACTION:this._setFullSearchResults(e.action.data);break;case i.SET_SEARCH_SELECTION_ACTION:this._setSearchSelection(e.action.data);break;case i.CHANGE_FILES_ACTION:this._applyFileDeltas(e.action.data);break;case i.CLEAR_SEARCH_ACTION:this._clearSearch();break;case l.BrowseActionType.SET_URL_PREFIX:this._clearSearch();break;case l.BrowseActionType.LOAD_PATH:this._updateContext(e.action.data);break;case l.BrowseActionType.SET_TILES_PER_ROW:this._setTilesPerRow(e.action.data)}},t})(a.Store);t.SearchResultsStore=h;var m=null;t.getSearchResultsStore=u,t.searchResultsStoreInstantiated=p}),define("modules/clean/search/search_results/view",["require","exports","tslib","external/lodash","external/react","modules/clean/browse_interface","modules/clean/history","modules/clean/react/browse/util","modules/clean/react/maestro/header","modules/clean/react/maestro/layout","modules/clean/filepath","modules/clean/react_format","modules/core/i18n","modules/core/uri","modules/clean/react/files_view/constants","modules/clean/react/files_view/types","modules/clean/react/files_view/controller","modules/clean/react/files_view/file_list_empty_folder_table","modules/clean/react/app_actions_view","modules/clean/search/constants","modules/clean/search/search_results/search_filter_sidebar","modules/clean/search/search_helpers","modules/clean/em_string","modules/clean/search/logger","modules/clean/search/search_bar/chips","modules/clean/illustration_helper","modules/clean/react/image","spectrum/table","modules/clean/react/files_view/fixed_table_head","modules/clean/search/types"],function(e,t,r,o,s,a,n,i,l,c,d,u,p,h,m,f,_,S,g,w,v,b,T,F,E,y,R,C,A,I){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var P=(function(t){function P(r){var o=t.call(this,r)||this;return o._handleScroll=function(){o.props.onScroll()},o._ensureFileViewerClosedIfNotPreviewing=function(){var e=n.deconstruct_url().qargs;o.props.ensureFileViewerClosedIfNotPreviewing(e)},o._handleFullSearchOnClick=function(e){e.preventDefault(),o.props.onSearch(o.props.latestQuery,"/")},o.handleSearchFiltersChanged=function(e){var t=e.path,r=e.deletedFiles;t&&t!==o.props.path&&F.logScopeChipChanged({searchSessionId:o.props.searchSessionId,user:o.props.user,chipAdded:!E.isScopeChipRoot(t),filePath:t,viewport:"right-rail",searchType:"full_page"});var s={};void 0!==r&&(s.d=r?"1":"0"),o.props.onSearch(o.props.latestQuery,void 0!==t?t:o.props.path,s)},o._handleEmptyFolderViewTTI=function(){o.props.handleComponentTTI("FilesViewController")},o._handleSearchAllFiles=function(e){e.preventDefault(),o.handleSearchFiltersChanged({deletedFiles:!1,path:o.props.path})},o._handleSearchDeletedFiles=function(e){e.preventDefault(),o.handleSearchFiltersChanged({deletedFiles:!0,path:o.props.path})},o._handleSearchAllFolders=function(e){e.preventDefault(),o.handleSearchFiltersChanged({path:"/",deletedFiles:o.props.shouldShowDeletedFiles})},o._getEmptyFolderViewUrl=function(e,t){var r=o.props,s=r.user,a=r.latestQuery,n=r.searchSessionId;return b.buildSearchURL({user:s,searchPath:e,normalizedQuery:a,searchSessionId:n,searchToken:b.getSearchCsrfToken(),qargs:{d:t?"1":void 0}}).toString()},o._renderEmptyFolderSubtitle=function(){var e=o.props,t=e.path,r=e.shouldShowDeletedFiles;return d.paths_are_equal(t,"/")?r?u.reactFormat(p._("Try different keywords or <Link>search files that aren’t deleted</Link>"),{Link:s.createElement("a",{href:o._getEmptyFolderViewUrl(t,!1),onClick:o._handleSearchAllFiles})}):u.reactFormat(p._("Try different keywords or <Link>search deleted files</Link>"),{Link:s.createElement("a",{href:o._getEmptyFolderViewUrl(t,!0),onClick:o._handleSearchDeletedFiles})}):r?u.reactFormat(p._("<LinkScope>Search all folders</LinkScope> or <LinkDeleted>files that aren’t deleted</LinkDeleted>"),{LinkScope:s.createElement("a",{href:o._getEmptyFolderViewUrl("/",r),onClick:o._handleSearchAllFolders}),LinkDeleted:s.createElement("a",{href:o._getEmptyFolderViewUrl(t,!1),onClick:o._handleSearchAllFiles})}):u.reactFormat("<LinkScope>Search all folders</LinkScope> or <LinkDeleted>deleted files</LinkDeleted>",{LinkScope:s.createElement("a",{href:o._getEmptyFolderViewUrl("/",r),onClick:o._handleSearchAllFolders}),LinkDeleted:s.createElement("a",{href:o._getEmptyFolderViewUrl(t,!0),onClick:o._handleSearchDeletedFiles})})},o._renderEmptyFolderView=function(e){var t=o.props,r=t.path,a=t.searchResultsExperiments,n=d.paths_are_equal(r,"/"),i=p._("No results found");if(b.isInDeletedFilterRightRailExperiment(a))return s.createElement("div",null,s.createElement(C.Table,{columnFlex:[m.CHECKBOX_CELL_FLEX,1]},s.createElement(A.FixedTableHead,{offsetHeight:m.DEFAULT_COLUMN_HEADER_HEIGHT},s.createElement(C.TableHeadCell,{className:"brws-column-header-table-cell brws-checkbox-cell",key:"checkbox-cell",role:"columnheader",scope:"col"},s.createElement("div",{className:"brws-vertically-center"})),s.createElement(C.TableHeadCell,{role:"columnheader",scope:"col",className:"brws-column-header-table-cell"},s.createElement("div",{className:"normal brws-column-header-menu"},s.createElement("span",{className:"brws-column-header-menu-trigger-disabled"},o._searchResultsTitle(e,o.props.searchResultsExperiments))))),s.createElement("tbody",null,s.createElement("tr",null,s.createElement("td",null),s.createElement("td",null)))),s.createElement("div",{className:"u-font-center u-pad-top-xl"},s.createElement(R.Image,{src:y.empty_state_url("search"),srcHiRes:y.empty_state_url("search@2x"),alt:""}),s.createElement("h2",{className:"u-font-strong empty-folder-table-title"},i),s.createElement("span",null,o._renderEmptyFolderSubtitle())));var l=n?p._("Please update your search and try again"):p._("Search all of my Dropbox instead"),c=n?void 0:o._getFullSearchLink(),u=n?void 0:o._handleFullSearchOnClick;return s.createElement(S.EmptyFolderTable,{title:i,subtitle:l,subtitleLink:c,subtitleOnClick:u,onTTI:o._handleEmptyFolderViewTTI})},o._maybeRenderMaestroActionMenu=function(t){var r=o.props,a=r.selectedFiles,n=r.arePostTTIModulesLoaded,l=r.user,c=r.path,d=r.context,u=r.actionHandlers,h=r.searchResultsExperiments,m=r.shouldShowDeletedFiles;if(a.size){var f=[];if(n){f=e("modules/clean/react/browse/file_actions").getActionsForFileCollection({files:a,context:d,user:l,actionHandlers:u,isSearchMode:!0,responsive:t})}if(f.length>0){var _={displayName:f[0].label,handleClick:f[0].performAction,iconName:f[0].iconName,className:f[0].className},S=f.slice(1).map(function(e){return{displayName:e.label,handleClick:e.performAction,iconName:e.iconName,className:e.className,disabled:e.disabled}}),w=i.getSelectedFilesText(a,d);return s.createElement(g.AppActionsView,{headerText:w,popoverTriggerLabel:p._("Actions"),primaryMenuItem:_,secondaryMenuItems:S,responsive:t})}}return b.isInRightRailExperiment(h)?s.createElement(v.SearchFilterSidebar,{user:l,searchResultsExperiments:h,path:c,onFiltersChanged:o.handleSearchFiltersChanged,deletedFiles:m}):s.createElement("div",null)},o._renderMaestroAppContent=function(e){return s.createElement("div",{className:"search-results"},o._renderSearchResultItems(e))},o._isInShowPaperStarsExperiment=function(){var e=o.props.searchResultsExperiments;return e&&e.expShowPaperStars},o._isInFetchPartialSearchResultInFrontendServiceExperiment=function(){var e=o.props.searchResultsExperiments.expFetchPartialSearchResultInFrontendService;return e===I.FetchPartialResultVariants.FRONTEND_SERVICE||e===I.FetchPartialResultVariants.METASERVER},o.state={},o}return r.__extends(P,t),P.prototype.componentWillMount=function(){n.add_callback("/search",this._ensureFileViewerClosedIfNotPreviewing)},P.prototype.componentDidMount=function(){window.addEventListener("scroll",this._handleScroll)},P.prototype.componentWillUnmount=function(){window.removeEventListener("scroll",this._handleScroll),n.remove_callback("/search",this._ensureFileViewerClosedIfNotPreviewing)},P.prototype._getFullSearchLink=function(){var e="work"===this.props.user.role?a.WORK_ROOT:a.PERSONAL_ROOT;return h.URI.parse("/search"+e).setQuery({path:"/",query:this.props.latestQuery,searchSessionId:this.props.searchSessionId}).toString()},P.prototype._searchResultsTitle=function(e,t){var r=this.props,o=r.searchResults,a=r.path,n=r.latestQuery,i=r.viewType,l=r.shouldShowDeletedFiles,c=o.size,h=d.paths_are_equal(a,"/");if(!b.isInDeletedFilterRightRailExperiment(t)&&0===c)return"";var m,_=e.isMatchedMedium?e.isMatchedLarge?30:20:10;i===f.ViewType.List&&(_/=2);if(h){var S=T.Emstring.em_snippet(n,_,.6);m=l?p.ungettext("%(size)d deleted result for “%(query)s”","%(size)d deleted results for “%(query)s”",c).format({size:c,query:S}):p.ungettext("%(size)d result for “%(query)s”","%(size)d results for “%(query)s”",c).format({size:c,query:S})}else{var g=T.Emstring.em_snippet(d.filename(a),_/2,.6),S=T.Emstring.em_snippet(n,_/2,.6)
;m=l?u.reactFormat(p.ungettext("%(size)d deleted result for “%(query)s” in <strong>%(path)s</strong>","%(size)d deleted results for “%(query)s” in <strong>%(path)s</strong>",c).format({size:c,query:S,path:g}),{strong:s.createElement("strong",null)}):u.reactFormat(p.ungettext("%(size)d result for “%(query)s” in <strong>%(path)s</strong>","%(size)d results for “%(query)s” in <strong>%(path)s</strong>",c).format({size:c,query:S,path:g}),{strong:s.createElement("strong",null)})}return m},P.prototype._getLoadingState=function(){return this.props.loadingState===w.SearchLoadingState.LOADING_FIRST_PAGE?f.LoadingState.LOADING_FIRST_PAGE:this.props.loadingState===w.SearchLoadingState.LOADING_ADDITIONAL_PAGE?f.LoadingState.LOADING_REMAINING_PAGES:f.LoadingState.LOADED},P.prototype._renderSearchResultItems=function(e){var t=this.props,a=t.getOverflowMenuActions,n=t.onNavigateToFileOrFolder,i=t.onNavigateToParentFolder,l=t.onNavigateToPath,c=t.context,d=t.fileRename,u=t.searchResults,p=t.getIsFileJumping,h=t.isFileViewerShown,S=t.arePostTTIModulesLoaded,g=t.handleComponentTTI,w=t.onSelectionChange,v=t.selectedFiles,b=t.selection,T=t.setFileUploaderPath,F=t.viewType,E=t.user,y=t.tilesPerRow,R=t.path,C=t.filesViewActionHandlers;return s.createElement(_.FilesViewController,r.__assign({},C,{getOverflowMenuActions:a,onNavigateToFileOrFolder:n,onNavigateToParentFolder:i,onNavigateToPath:l,context:c,customEmptyFolderView:this._renderEmptyFolderView,createNewFolderState:f.NewFolderCreationState.CREATE_FOLDER_INACTIVE,fileRename:d,items:u,getIsFileJumping:p,isFileViewerShown:h,isSearchMode:!0,arePostTTIModulesLoaded:S,isTextSelectable:!1,loadingState:this._getLoadingState(),onComponentTTI:g,onSelectionChange:w,onSortChange:o.noop,path:R,selectedFiles:v,selection:b,setFileUploaderPath:T,showFileUploaderModal:o.noop,user:E,viewType:F,totalNumFiles:u.size,responsive:e,columns:this._generateColumns(e),tilesPerRow:y,expShowPaperStars:this._isInShowPaperStarsExperiment(),viewTypes:"ON"===this.props.browseExperiments.expBrowseLargeGridView?m.AllViewTypesExperiment:m.AllViewTypes,expUseFqPathForStars:this._isInFetchPartialSearchResultInFrontendServiceExperiment()}))},P.prototype._generateColumns=function(e){var t=this;return(this.props.shouldShowDeletedFiles?m.SEARCH_LIST_VIEW_COLUMNS_DELETED:m.SEARCH_LIST_VIEW_COLUMNS).map(function(o,s){return r.__assign({},o,{label:0===s?t._searchResultsTitle(e,t.props.searchResultsExperiments):o.label})})},P.prototype.render=function(){var e=this.props,t=e.user,r=e.maestroSearchBarProps;return s.createElement(c.MaestroChrome,{user:t,titleRegion:s.createElement(l.MaestroHeaderTitle,null,p._("Search results")),embeddedAppRegion:this._renderMaestroAppContent,actionSidebarRegion:this._maybeRenderMaestroActionMenu,searchBarProps:r})},P})(s.Component);t.SearchResultsView=P}),define("modules/clean/web_upload_action_logger",["require","exports","modules/clean/ajax"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MAX_ERRORS=3;var o=(function(){function e(){this.errorCount=0,this.lastError=Date.now(),this.shouldReport=!0}return e.prototype.log=function(e,o,s){var a=this;return this.shouldReport&&(this.errorCount<t.MAX_ERRORS||Date.now()-this.lastError>6e5)?new Promise(function(n,i){r.SilentBackgroundRequest({url:"/log/web_upload_action",data:{_subject_uid:e,event_type:o,extra_params:JSON.stringify(s)},error:function(e){429===e.status?a.errorCount=t.MAX_ERRORS:a.errorCount++,a.lastError=Date.now(),i(e)},success:function(e){try{var t=JSON.parse(e);t&&!t.continue_sending&&(a.shouldReport=!1),a.errorCount=0,n(e)}catch(e){throw a.errorCount++,a.lastError=Date.now(),i(e),e}}})}):Promise.resolve({})},e})();t.WebUploadActionLog=new o,t.WebUploadActionLogClass=o}),define("spectrum/icon_mode",["require","exports","tslib","spectrum/icon_mode/index"],function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r.__exportStar(o,t)}),define("spectrum/icon_mode/index",["require","exports","tslib","react","spectrum/packages/spectrum-icons/templates/stateless/index","spectrum/packages/spectrum-icons/generated/bundles/mode"],function(e,t,r,o,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ICONS=a.ICONS,t.IconMode=function(e){var t=e.name,n=a.ICONS[t],i=n.attrs,l=n.innerHtml,c=o.createElement("svg",r.__assign({},i,{dangerouslySetInnerHTML:{__html:l}}));return o.createElement(s.Component,r.__assign({icon:c},e,{key:t}))},t.IconMode.displayName="IconMode"}),define("spectrum/icon_table",["require","exports","tslib","spectrum/icon_table/index"],function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r.__exportStar(o,t)}),define("spectrum/label",["require","exports","tslib","spectrum/label/index"],function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r.__exportStar(o,t)}),define("spectrum/label/index",["require","exports","tslib","spectrum/label/label"],function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r.__exportStar(o,t)}),define("spectrum/label/label",["require","exports","tslib","classnames","react"],function(e,t,r,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Label=function(e){var t=e.children,a=e.className,n=e.disabled,i=r.__rest(e,["children","className","disabled"]),l=o(a,{"mc-label":!0,"mc-label-disabled":n});return s.createElement("label",r.__assign({className:l},i),t)}}),define("spectrum/packages/spectrum-icons/generated/bundles/mode",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ICONS={grid:{attrs:{width:"24",height:"24",viewBox:"0 0 24 24"},innerHtml:'<title>mode-grid</title><g fill="#637282" fill-rule="evenodd"><path d="M7 7h2v2H7zM11 7h2v2h-2zM15 7h2v2h-2zM7 11h2v2H7zM11 11h2v2h-2zM15 11h2v2h-2zM7 15h2v2H7zM11 15h2v2h-2zM15 15h2v2h-2z"></path></g>'},list:{attrs:{width:"24",height:"24",viewBox:"0 0 24 24"},innerHtml:'<title>mode-list</title><g fill="#637282" fill-rule="evenodd"><path d="M6 15h2v2H6zM10 15h8v2h-8zM6 11h2v2H6zM10 11h8v2h-8zM6 7h2v2H6zM10 7h8v2h-8z"></path></g>'},tiles:{attrs:{width:"24",height:"24",viewBox:"0 0 24 24"},innerHtml:'<title>mode-tiles</title><g fill="#637282" fill-rule="evenodd"><path d="M7 7h4v4H7zM13 7h4v4h-4zM13 13h4v4h-4zM7 13h4v4H7z"></path></g>'}}}),define("spectrum/radio_button",["require","exports","tslib","spectrum/radio_button/index"],function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r.__exportStar(o,t)}),define("spectrum/radio_button/index",["require","exports","tslib","spectrum/radio_button/radio_button"],function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r.__exportStar(o,t)}),define("spectrum/radio_button/radio_button",["require","exports","tslib","classnames","react","spectrum/label/index"],function(e,t,r,o,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RadioButton=function(e){var t=e.className,n=e.children,i=r.__rest(e,["className","children"]),l=o(t,{"mc-radio":!0,"mc-radio-disabled":e.disabled}),c=s.createElement("input",r.__assign({type:"radio",className:l},i));return n?s.createElement(a.Label,null,c," ",n):c}});
//# sourceMappingURL=pkg-browse-uncommon.min.js-vflSJptr-.map