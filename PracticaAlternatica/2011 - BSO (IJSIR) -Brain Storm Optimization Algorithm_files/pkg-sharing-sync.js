define("modules/clean/avatar/triple_avatars",["require","exports","tslib","external/react","external/react-dom-factories","external/prop-types","modules/clean/avatar/avatar_with_default","modules/clean/avatar/initials_avatar","modules/clean/avatar/overflow_count_pill","modules/clean/avatar/size","modules/clean/react/css","modules/core/user_i18n","modules/clean/ajax","modules/core/i18n"],function(e,t,o,n,a,r,s,l,i,c,d,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=n.createElement,_=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.getPropTypes=function(){return{contacts:r.arrayOf(r.shape({email:r.string,display_name:r.string,photo_url:r.string})),count:r.number}},t.getAvatar=function(e){return m(s,{dimension:c.AVATAR_DIMENSION_BY_SIZE.XLARGE,photoUrl:e.photo_url,defaultAvatar:m(l.InitialsAvatarWithColorDerivedFromName,{dimension:c.AVATAR_DIMENSION_BY_SIZE.XLARGE,shape:"CIRCLE",initials:u.getInitials(e.display_name),name:e.display_name})})},t}return o.__extends(t,e),t.prototype.render=function(){var e=this;if(this.props.contacts&&0!==this.props.contacts.length){var t=this.props.contacts.length;return this.props.count&&this.props.count>this.props.contacts.length&&(t=this.props.count),a.div({className:"triple-avatars-section"},this.getAvatar(this.props.contacts[0]),this.props.contacts.length>1?this.getAvatar(this.props.contacts[1]):void 0,(function(){return 3===t?e.getAvatar(e.props.contacts[2]):t>3?m(i,{dimension:c.AVATAR_DIMENSION_BY_SIZE.XLARGE,count:t-2}):void 0})())}return a.div({})},t.displayName="TripleAvatars",t})(n.Component),p=d(_,["/static/css/scooter/scooter-scoped-vflhQ6850.css"]);t.TripleAvatars=p}),define("modules/clean/multiaccount_login",["require","exports","jquery","modules/clean/dbmodal","modules/clean/teams/team_assume_user_personal_locked_modal","modules/clean/viewer","modules/core/browser","modules/core/controller_helpers","modules/core/exception","modules/core/i18n","modules/core/notify"],function(e,t,o,n,a,r,s,l,i,c,d){"use strict";return(function(){function e(){}return e.$element=function(){return o("#db-modal-multiaccount-login-modal")},e.set_during_login_callback=function(e){return i.assert(!this._during_login_callback,"already have a during_login_callback"),this._during_login_callback=e},e.show_modal=function(e){var t=this;void 0===e&&(e={});var a,u;if(r.Viewer.get_viewer().is_team_assume_user_session)return this.show_personal_account_disabled_modal();this.$element=o.isFunction(this.$element)?this.$element():this.$element,i.assert(null!=this.$element&&!!this.$element.length,"MultiaccountLogin needs its @$element to be set"),i.assert(!(null!=e.on_success&&null!=e.success_href),"on_success and success_href are mutually exclusive"),null!=e.user?u=e.user:null!=e.user_id?u=r.Viewer.get_viewer().get_user_by_id(e.user_id,!0):null!=e.role&&(u=r.Viewer.get_viewer().get_user_by_role(e.role,!0)),i.assert(null!=u,"invalid user");var m=u.role;i.assert(!r.Viewer.get_viewer().is_user_signed_in(u),"called MultiaccountLogin for a user that's already signed in"),a="personal"===m?c._("Sign in to your personal Dropbox"):c._("Sign in to your %(team_name)s Dropbox").format({team_name:r.Viewer.get_viewer().team_name});var _=this.$element.find("form");return l.get_controller(_).reset(),l.get_controller(_).set_input_value("login_email",u.email),this.auth_success_callback=function(){r.Viewer.get_viewer()._sign_in_all_users();var o=function(o){return null!=o?(d.Notify.error(o),r.Viewer.get_viewer()._sign_out_user_by_id(u.id),void t.modal.hide()):null!=e.success_href?s.get_uri().toString()!==e.success_href?s.redirect(e.success_href):s.reload():(t.modal.hide(),"function"==typeof e.on_success?e.on_success():void 0)};return null!=t._during_login_callback&&null==e.success_href?t._during_login_callback(u,o):o(),!1},o(document).off("db:multilogin:success"),o(document).on("db:multilogin:success",this.auth_success_callback),this.modal=new n.DBModal({element_id:"multiaccount-login-modal"}),this.modal.show(),this.modal.set_title(a),this.$element.find('input[name="login_password"]').focus()},e.show_page_login_modal=function(e){for(var t=r.Viewer.get_viewer(),o=null,n=0,a=Array.from(t.get_users(!0));n<a.length;n++){var s=a[n];if(!t.is_user_signed_in(s)){o=s;break}}if(o){var l={user:o};return"string"==typeof e?l.success_href=e:"function"==typeof e&&(l.on_success=e),this.show_modal(l),!1}},e.show_personal_account_disabled_modal=function(){var e=r.Viewer.get_viewer();return a.AssumePersonalLockedModal.show({displayName:e.display_name,teamName:e.team_name}),!1},e})()}),define("modules/clean/react/growth/feedback_form",["require","exports","tslib","external/react","modules/clean/analytics","modules/clean/em_string","modules/clean/react/modal","modules/clean/sharing/constants","modules/core/notify","modules/clean/react/css"],function(e,t,o,n,a,r,s,l,i,c){"use strict";function d(e,t,o){o in _?_[o]++:_[o]=1,3===_[o]&&(a.MassiveBarracudaLogger.logEvent(e,{source_modal:t,lifecycle_event:"show_feedback_modal"}),s.Modal.showInstance(n.createElement(m,{oqa:e,folderName:o})))}Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){function t(t){var o=e.call(this,t)||this;return o.setFeedbackField=function(e){o.feedbackField=e},o.onSubmit=function(){a.MassiveBarracudaLogger.logEvent(o.props.oqa,{source_modal:"feedback_modal",lifecycle_event:"submit_feedback",feedback:o.feedbackField.value}),i.Notify.success("Thank you for the feedback.")},o.onDismiss=function(){a.MassiveBarracudaLogger.logEvent(o.props.oqa,{source_modal:"feedback_modal",lifecycle_event:"dismiss"})},o}return o.__extends(t,e),t.prototype.render=function(){return n.createElement(s.Modal,{autoClose:!0,clickOutToClose:!1,ref:"modal",showX:!0,title:"Shared folder issue",acceptButtonText:"Send",onAccept:this.onSubmit,onDismiss:this.onDismiss},"Weâ€™re having a problem adding the folder"," ",r.Emstring.em_snippet(this.props.folderName,l.SNIPPET_SIZES.OUT_OF_QUOTA_FOLDER_NAME)," to your account. Please describe the steps you took to add the folder to help us troubleshoot the issue.",n.createElement("br",null),n.createElement("textarea",{className:"feedback-form--textarea","aria-labelledby":"feedback text",ref:this.setFeedbackField,type:"text"}))},t})(n.Component),m=c(u,["/static/css/growth/feedback_form-vfl84uHNM.css"]),_={};t.feedbackModalTrigger=d}),define("modules/clean/sharing/api/mount_client",["require","exports","modules/clean/api_v2/root_aware_client"],function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(e){var t=e.userId;this.client=new o.UserActionsRootAwareClient,this.userId=t}return e.prototype.mount=function(e){var t=e.contentId;return this.client.ns("sharing").rpc("mount_folder",{shared_folder_id:String(t)},{subjectUserId:this.userId})},e})();t.MountFolderApiClient=n}),define("modules/clean/sharing/async_shared_content_link_sync_utils",["require","exports","tslib","modules/core/browser","modules/clean/sharing/shared_content_link_sync_utils","modules/clean/web_timing_logger"],function(e,t,o,n,a,r){"use strict";function s(){return!!window.__REGISTER_SYNC_VARS_PRELOAD}function l(){var e=window;return s()?new Promise(function(t,o){e.__REGISTER_SYNC_VARS_PRELOAD(function(e){t(e?JSON.parse(e):void 0)},o)}):Promise.resolve(void 0)}function i(e){return o.__awaiter(this,void 0,void 0,function(){var t,s;return o.__generator(this,function(o){switch(o.label){case 0:return r.log_js_modules_application_code_start(),[4,l()];case 1:return t=o.sent(),t&&t.redirect&&n.redirect(t.redirect_url),s=t||e.syncVars,a.showSharedContentSyncModal(e.activeUserId,s,null,e.expUjMassiveBarracuda),[2]}})})}Object.defineProperty(t,"__esModule",{value:!0}),t.asyncSharedContentLinkSyncUtilsInitialize=i}),define("modules/clean/sharing/role_selector_modal",["require","exports","tslib","jquery","modules/clean/dbmodal","modules/clean/multiaccount_login","modules/clean/viewer"],function(e,t,o,n,a,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){function t(t){var o=e.call(this,{element_id:"select-role-modal-sync"})||this;return o.onSelectRole=t,o}return o.__extends(t,e),t.prototype.on_show=function(){var e=this;return n(".role-options li").click(function(t){var o=n(t.target).closest("li").data("role");return e.hide(),s.Viewer.get_viewer().is_role_signed_in(o)?e.onSelectRole(o):r.show_modal({role:o,on_success:function(){return e.onSelectRole(o)}})})},t})(a.DBModal);t.RoleSelectorModal=l}),define("modules/clean/sharing/shared_content_link_sync_modal",["require","exports","tslib","external/classnames","external/react","modules/clean/analytics","modules/clean/avatar/triple_avatars","modules/clean/em_string","modules/clean/filepath","modules/clean/history","modules/clean/loggers/growth_features_events_logger","modules/clean/react/button","modules/clean/react/async/loadable","modules/clean/react/growth/feedback_form","modules/clean/react/modal","modules/clean/react/sprite","modules/clean/react_format","modules/clean/sharing/constants","modules/clean/sharing/views/hover_close_button","modules/clean/static_urls","modules/clean/viewer","modules/clean/web_timing_logger","modules/constants/payments","modules/core/browser","modules/core/exception","modules/core/i18n","modules/core/uri"],function(e,t,o,n,a,r,s,l,i,c,d,u,m,_,p,g,f,v,h,y,b,w,N,E,S,k,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var M=k.i18n_default_project("sharing")._,O=(function(t){function k(o){var n=t.call(this,o)||this;return n.ASK="ask",n.ASKING="asking",n._closeSyncModal=function(){var e=n.props.outOfQuotaQP;if(e){var t=void 0;n.props.canRequestToJoin?(t={is_limited:n.state.ownerTeam&&n.state.ownerTeam.is_limited,ns_id:n.props.syncNSId,requested_team_id:n.state.ownerTeam?n.state.ownerTeam.id:void 0},d.logMagnetEvent("request_modal_OQ_dismissed",t)):n.props.magnetControlLogging&&(t={ns_id:n.props.syncNSId},d.logMagnetEvent("modal_OQ_dismissed"));var o=n.props.folderName;"ON"===n.props.expUjMassiveBarracuda&&_.feedbackModalTrigger(e,"sync_modal",o),r.NQOQLogger.logCloseModal(e,{modal_type:"billboard"}),r.MassiveBarracudaLogger.logEvent(e,{source_modal:"sync_modal",lifecycle_event:"close"}),S.reportStack("Shared content link modal close",{severity:S.SEVERITY.NONCRITICAL,tags:["massive_barracuda"]})}c.remove_query_param("sm"),n.refs.modal.close()},n._renderTopPanelIcon=function(){return n.props.targetFile?a.createElement(g.Sprite,{alt:"",group:"web",name:n.props.targetFile.icon}):a.createElement(g.Sprite,{alt:"",group:"web",name:"folder_user_32"})},n._renderTopPanelTitle=function(){return n.props.targetFile?l.Emstring.em_snippet(i.filename(n.props.targetFile.fq_path),15):l.Emstring.em_snippet(n.props.folderName,15)},n._renderTopPanelSubtitle=function(){return n.props.targetFile?n.props.ownerName?M("Owned by %(name)s").format({name:n.props.ownerName}):M("Not currently owned"):n.props.folderSize},n._renderAccessText=function(){return n.props.outOfQuotaQP?n.props.canRequestToJoin?n.state.ownerTeam?a.createElement("div",null,a.createElement("div",{className:"content-link-sync-modal__access-text u-mar-top-m"},a.createElement(s.TripleAvatars,{contacts:n.state.ownerTeam.contacts,count:n.state.ownerTeam.count})),a.createElement("div",{className:"content-link-sync-modal__access-text"},M("Your Dropbox is fullâ€”join the %(team_name)s Dropbox?").format({team_name:n.state.ownerTeam.name}))):a.createElement("div",null):a.createElement("div",{className:"content-link-sync-modal__access-text"},M("Not enough space")):a.createElement("div",{className:"content-link-sync-modal__access-text"},n.props.senderName?"can_view"===n.props.accessLevel?n.user.is_cdm_member?M("%(name)s invited you to view this folder").format({name:n.props.senderName}):M("%(name)s gave you access to view this folder").format({name:n.props.senderName}):n.user.is_cdm_member?M("%(name)s invited you to edit this folder").format({name:n.props.senderName}):M("%(name)s gave you access to edit this folder").format({name:n.props.senderName}):M("can_view"===n.props.accessLevel?"You have access to view this folder":"You have access to edit this folder"))},n._renderSharedFolderInfo=function(){return a.createElement("div",{className:"content-link-sync-modal__shared-folder-info"},a.createElement("div",{className:"content-link-sync-modal__shared-folder-text"},M((n.props.targetFile?n.props.targetFile.is_dir:void 0)?"This folder is part of a shared folder:":"This file is part of a shared folder:")),a.createElement("div",null,a.createElement(g.Sprite,{alt:"",group:"web",name:"folder_user_32"})),a.createElement("p",{className:"u-font-meta"},n.props.folderName,a.createElement("br",null),n.props.folderSize))},n._renderTipBody=function(e){return n.props.outOfQuotaQP?n.props.canRequestToJoin?n.state.ownerTeam?n.state.ownerTeam.contacts.length>0?M("Join %(name)s and your coworkers and get more space to work together.").format({name:n.state.ownerTeam.contacts[0].display_name}):null:a.createElement("img",{className:"content-link-sync-modal__loader",src:y.static_url("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:M("Loading")}):"V1"===n.props.expSubgrowthProShareUpsellModalFileAttr?M("To add this folder, youâ€™ll need more space in your Dropbox."):n.props.usageRemaining?M("To add this folder, youâ€™ll need %(needed)s of space in your Dropbox. You currently have %(remaining)s of space left.").format({remaining:n.props.usageRemaining,needed:n.props.usageNeeded}):M("To add this folder, youâ€™ll need %(needed)s of space in your Dropbox. You currently have no space left.").format({needed:n.props.usageNeeded}):n.state.state===n.ASKING?a.createElement("img",{src:y.static_url("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:M("Loading")}):!n.props.targetFile&&n.user.is_cdm_member?f.reactFormat(M("To get started, add this to <strong>%(cdm_tmf_name)s</strong> (your member folder). <a>Learn more</a>"),{cdm_tmf_name:e,strong:a.createElement("span",{className:"u-font-strong"}),a:a.createElement("a",{href:"/help/business/team-space-overview#acceptfolder",target:"_blank",rel:"noopener noreferrer"})}):M("can_view"===n.props.accessLevel?n.props.targetFile?"For easy access to this file in the future, add the folder to your Dropbox.":"For easy access to this folder in the future, add it to your Dropbox.":n.props.targetFile?"To start working on this file, you need to add the folder to your Dropbox first.":"To start working on this folder, you need to add it to your Dropbox first.")},n._renderPreviewLink=function(){return"can_view"===n.props.accessLevel?a.createElement("div",null,a.createElement("span",{className:"content-link-sync-modal__or"},M("Or")),a.createElement("button",{className:"content-link-sync-modal__not-now-label button-as-link",onClick:n.onPreviewButtonClicked},M(!n.props.targetFile||n.props.targetFile.is_dir?"preview this folder":"preview this file"))):null},n.onDismiss=function(){var e=n.props.outOfQuotaQP;e&&(S.reportStack("Shared content link modal dismissed",{severity:S.SEVERITY.NONCRITICAL,tags:["massive_barracuda"]}),r.NQOQLogger.logCloseModal(e,{modal_type:"billboard"}),r.MassiveBarracudaLogger.logEvent(e,{source_modal:"sync_modal",lifecycle_event:"dismiss"}))},n.renderControl=function(e){return a.createElement("div",{className:"content-link-sync-modal__content u-mar-bottom-xs"},a.createElement("div",{className:"content-link-sync-modal__top-panel u-pad-s"},a.createElement("div",{className:"content-link-sync-modal__icon u-pad-top-xs"},n._renderTopPanelIcon()),a.createElement("div",{className:"content-link-sync-modal__name-size u-l-ib u-pad-left-xs u-pad-top-xs o-flag__flex"},a.createElement("h3",{className:"u-font-strong"},n._renderTopPanelTitle()),a.createElement("h4",{className:"u-trim-margin u-font-meta"},n._renderTopPanelSubtitle())),a.createElement("div",{className:"content-link-sync-modal__close u-pad-xs o-flag__fix"},n.props.hideX?a.createElement("div",{style:{opacity:0}},a.createElement(h,{onClick:n._closeSyncModal})):a.createElement(h,{onClick:n._closeSyncModal}))),a.createElement("div",{className:"content-link-sync-modal__tip-panel"},n.props.targetFile?n._renderSharedFolderInfo():n._renderAccessText(),a.createElement("div",{className:"content-link-sync-modal__tip-body"},n._renderTipBody(e))))},n.renderVariant=function(){var e;return e=n.props.usageRemaining&&n.props.usageRemaining>"0"?f.reactFormat(M("To add this folder, youâ€™ll need <strong>%(needed)s</strong> of space in your Dropbox. You currently have <span>%(remaining)s</span> of space left."),{strong:a.createElement("strong",null),span:a.createElement("span",{className:"content-link-sync-modal__alert"}),remaining:n.props.usageRemaining,needed:n.props.usageNeeded}):f.reactFormat(M("To add this folder, youâ€™ll need <strong>%(needed)s</strong> of space in your Dropbox. You currently have no space left."),{strong:a.createElement("strong",null),needed:n.props.usageNeeded}),a.createElement("div",{className:"content-link-sync-modal--pro-variant__content u-mar-bottom-xs"},a.createElement("div",{className:"content-link-sync-modal--pro-variant__close u-pad-xs u-font-right"},n.props.hideX?a.createElement("div",{style:{opacity:0}},a.createElement(h,{onClick:n._closeSyncModal})):a.createElement(h,{onClick:n._closeSyncModal})),a.createElement("div",{className:"content-link-sync-modal--pro-variant__container"},a.createElement("div",{className:"content-link-sync-modal--pro-variant__left-container"},a.createElement("div",{className:"content-link-sync-modal--pro-variant__content"},a.createElement("div",{className:"content-link-sync-modal--pro-variant__folder-name"},l.Emstring.em_snippet(n.props.folderName,v.SNIPPET_SIZES.OUT_OF_QUOTA_FOLDER_NAME)))),a.createElement("div",{className:"content-link-sync-modal--pro-variant__right-container"},a.createElement("div",{className:"content-link-sync-modal--pro-variant__tip-title"},M("Not enough space")),a.createElement("div",{className:"content-link-sync-modal--pro-variant__tip-body"},e))))},n.renderButtons=function(e){return n.props.canRequestToJoin&&n.props.outOfQuotaQP?n.state.ownerTeam?a.createElement("div",{className:"content-link-sync-modal__buttons u-mar-bottom-s"},n.props.outOfQuotaQP?a.createElement("div",null,n.state.ownerTeam.is_limited?void 0:a.createElement(u.button,{importance:"primary",className:"content-link-sync-modal__request-to-join-button",disabled:n.state.state===n.ASKING,onClick:n.onRequestButtonClicked},M("Request to join")),a.createElement(u.button,{importance:n.state.ownerTeam.is_limited?"primary":"tertiary",className:"content-link-sync-modal__add-to-dropbox-button",disabled:n.state.state===n.ASKING,onClick:n.onSyncButtonClicked},M("Upgrade to add folder")),"can_view"===n.props.accessLevel?n._renderPreviewLink():void 0):void 0):a.createElement("div",null):a.createElement("div",{className:"content-link-sync-modal__buttons u-mar-bottom-s"},a.createElement(u.button,{importance:"primary",className:"content-link-sync-modal__add-to-dropbox-button",disabled:n.state.state===n.ASKING,onClick:n.onSyncButtonClicked},n.props.outOfQuotaQP?M("Upgrade to add folder"):n.props.targetFile?n.user.is_cdm_member?n.getButtonTextForCDM(e):M("Add folder to Dropbox"):n.user.is_cdm_member?n.getButtonTextForCDM(e):M("Add to Dropbox")),"can_view"===n.props.accessLevel?n._renderPreviewLink():void 0)},n.getButtonTextForCDM=function(e){return n.props.targetFile?e.length>9?M("Add folder to my member folder"):f.reactFormat(M("Add folder to <strong>%(cdm_tmf_name)s</strong> folder"),{cdm_tmf_name:e,strong:a.createElement("strong",{style:{fontWeight:800}})}):e.length>12?M("Add to my member folder"):f.reactFormat(M("Add to <strong>%(cdm_tmf_name)s</strong> folder"),{cdm_tmf_name:e,strong:a.createElement("strong",{style:{fontWeight:800}})})},n.renderButtonsVariant=function(){return a.createElement("div",{className:"content-link-sync-modal--pro-variant__buttons"},a.createElement(u.button,{importance:"primary",className:"content-link-sync-modal--pro-variant__add-to-dropbox-button",disabled:n.state.state===n.ASKING,onClick:n.onSyncButtonClicked},M("Upgrade to add folder")))},n.requestCallback=function(){var e=n.props.outOfQuotaQP,t=v.SHARE_ACTION_ORIGIN_TYPE.SYNC_MODAL;if(e){r.ShareTibEventLogger.log(n.props.activeUserId,"OUT_OF_QUOTA_MODAL_UPGRADE",t,{ns_id:n.props.syncNSId,usage_remaining:n.props.usageRemaining,usage_needed:n.props.usageNeeded});var o=void 0;n.props.canRequestToJoin?(o={is_limited:n.state.ownerTeam?n.state.ownerTeam.is_limited:void 0,ns_id:n.props.syncNSId,requested_team_id:n.state.ownerTeam?n.state.ownerTeam.id:void 0},d.logMagnetEvent("request_modal_OQ_click_upgrade",o)):n.props.magnetControlLogging&&(o={ns_id:n.props.syncNSId},d.logMagnetEvent("modal_OQ_CTA_click",o));var a="wb_nq_shm_share_w"===e||"wb_nq_shm_share_ro"===e?N.LOW_SPACE_URL:N.OUT_OF_SPACE_URL,s=new T.URI({path:a}).updateQuery({oqa:e});E.redirect(s.toString())}else n.props.targetFile&&r.ShareTibEventLogger.log(n.props.activeUserId,"UNMOUNTED_SEARCH_SYNC",t,{ns_id:n.props.syncNSId}),n.props.onMountSharedFolder(),n.setState({state:n.ASK})},n.onSyncButtonClicked=function(){if(n.setState({state:n.ASKING}),n.props.canRequestToJoin&&!n.props.outOfQuotaQP)n.activateRequestModal();else{var e=n.props.outOfQuotaQP;e&&(r.NQOQLogger.logAcceptModal(e,{modal_type:"billboard",cta_text:"upgrade to add folder"}),r.MassiveBarracudaLogger.logEvent(e,{source_modal:"sync_modal",lifecycle_event:"accept"})),n.requestCallback()}},n.onPreviewButtonClicked=function(){if(n.props.previewCallback)r.ShareTibEventLogger.log(n.props.activeUserId,"UNMOUNTED_SEARCH_PREVIEW","SYNC_MODAL",{ns_id:n.props.syncNSId}),n.props.previewCallback();else{var e=n.props.previewUrl?T.URI.parse(n.props.previewUrl):E.get_uri().removeQuery("sm");e.updateQuery({from_sync_modal:!0}),E.redirect(e)}},n.onRequestButtonClicked=function(){n.setState({state:n.ASKING}),e(["modules/clean/teams/membership_discovery_util"],function(e){(0,e.sendTeamRequest)(n.state.ownerTeam.id,function(){return p.Modal.close()})});var t=b.Viewer.get_viewer().personal_user,o=t&&t.paid?"plus":"basic",a={folder_size:n.props.usageNeeded,is_limited:n.state.ownerTeam?n.state.ownerTeam.is_limited:void 0,ns_id:n.props.syncNSId,receiver_plan_type:o,receiver_quota_remaining:n.props.usageRemaining,requested_team_id:n.state.ownerTeam?n.state.ownerTeam.id:void 0};d.logMagnetEvent("request_modal_OQ_CTA_click",a)},n.activateRequestModal=function(){n.props.canRequestToJoin&&e(["modules/clean/teams/membership_request_modal"],function(e){var t=e.MembershipRequestModal;p.Modal.showInstance(a.createElement(t,{folderName:l.Emstring.em_snippet(n.props.folderName,15),nsId:n.props.syncNSId,overQuotaQP:null!=n.props.outOfQuotaQP,quotaNeeded:n.props.usageNeeded,quotaRemaining:n.props.usageRemaining,requestCallback:n.requestCallback,senderName:n.props.senderName,team:n.state.ownerTeam}))})},n.state={state:n.ASK},n}return o.__extends(k,t),k.showInstance=function(t){p.Modal.showInstance(t);var o=t.props.outOfQuotaQP;if(o){r.NQOQLogger.logViewModal(o,{modal_type:"billboard"}),r.MassiveBarracudaLogger.logEvent(o,{source_modal:"sync_modal",lifecycle_event:"show_instance"}),S.reportStack("Shared content link modal show instance",{severity:S.SEVERITY.NONCRITICAL,tags:["massive_barracuda"]});var n=t.props.expSubgrowthProShareUpsellModalFileAttr;n&&new Promise(function(t,o){e(["modules/clean/stormcrow/stormcrow_exposure_logger"],t,o)}).then(function(e){(new(0,e.StormcrowExposureLogger)).logExposuresOnce({subgrowth_pro_share_upsell_modal_file_attr:n})})}},k.prototype.componentWillMount=function(){var e=w.start_time(),t=(new Date).getTime();this.user=b.Viewer.get_viewer().get_user_by_id(this.props.activeUserId);var o=v.SHARE_ACTION_ORIGIN_TYPE.SYNC_MODAL;if(this.props.outOfQuotaQP)r.ShareTibEventLogger.log(this.props.activeUserId,"OUT_OF_QUOTA_MODAL_RENDER",o,{timing:t-e,ns_id:this.props.syncNSId});else{var n=this.props.targetFile?"UNMOUNTED_SEARCH_MODAL_RENDER":"SYNC_MODAL_RENDER";r.ShareTibEventLogger.log(this.props.activeUserId,n,o,{timing:t-e,ns_id:this.props.syncNSId})}var a=this.props.outOfQuotaQP;a&&r.MassiveBarracudaLogger.logEvent(a,{source_modal:"sync_modal",lifecycle_event:"component_will_mount"})},k.prototype.componentWillUnmount=function(){var e=this.props.outOfQuotaQP;e&&r.MassiveBarracudaLogger.logEvent(e,{source_modal:"sync_modal",lifecycle_event:"component_will_unmount"})},k.prototype.render=function(){var e,t,o,s=n({"content-link-sync-modal":!0,"can-request-to-join-team":this.props.canRequestToJoin});this.user.is_cdm_member&&(o=i.filename(this.user.cdm_tmf_path)),t=this.renderControl(o),e=this.renderButtons(o);var l=this.props,c=l.expSubgrowthProShareUpsellModalFileAttr,d=l.outOfQuotaQP;return d&&r.MassiveBarracudaLogger.logEvent(d,{source_modal:"sync_modal",lifecycle_event:"render"}),c&&d&&"V2"===c?this.renderOverquotaModal(d):a.createElement(p.Modal,{autoClose:!1,buttonComponent:e,className:s,clickOutToClose:!1,ref:"modal",showX:!1,title:"",onDismiss:this.onDismiss},t)},k.prototype.renderOverquotaModal=function(t){var o=m.Loadable({loader:function(){return new Promise(function(t,o){e(["modules/clean/react/overquota_modal"],t,o)}).then(function(e){return e.OverquotaModal})}});return a.createElement(o,{headline:M("Not enough space"),tagline:M("To add this folder, youâ€™ll need more space in your Dropbox."),oqa:t,ctaText:M("Upgrade to add folder"),ctaTextUntranslated:"Upgrade to add folder"})},k.prototype.componentDidMount=function(){var t,o=this;w.mark_time_to_interactive();var n=b.Viewer.get_viewer().personal_user,a=n&&n.paid?"plus":"basic";this.props.canRequestToJoin&&(e(["modules/clean/teams/membership_discovery_util"],function(e){var t=e.getDiscoverableTeamForFolder;o.setState({state:o.ASKING}),t(o.props.syncNSId,function(e){o.setState({state:o.ASK,ownerTeam:e})})}),this.props.outOfQuotaQP&&(t={folder_size:this.props.usageNeeded,is_limited:this.state.ownerTeam?this.state.ownerTeam.is_limited:void 0,ns_id:this.props.syncNSId,receiver_plan_type:a,receiver_quota_remaining:this.props.usageRemaining,requested_team_id:this.state.ownerTeam?this.state.ownerTeam.id:void 0},d.logMagnetEvent("request_modal_OQ_open",t))),this.props.magnetControlLogging&&this.props.outOfQuotaQP&&(t={folder_size:this.props.usageNeeded,ns_id:this.props.syncNSId,receiver_plan_type:a,receiver_quota_remaining:this.props.usageRemaining},d.logMagnetEvent("modal_OQ_open",t));var s=this.props.outOfQuotaQP;s&&r.MassiveBarracudaLogger.logEvent(s,{source_modal:"sync_modal",lifecycle_event:"component_did_mount"})},k.displayName="SharedContentLinkSyncModal",k.defaultProps={canRequestToJoin:!1,magnetControlLogging:!1},k})(a.Component);t.SharedContentLinkSyncModal=O}),define("modules/clean/sharing/shared_content_link_sync_utils",["require","exports","tslib","external/react","modules/clean/sharing/shared_content_link_sync_modal","modules/core/browser","modules/clean/web_timing_logger"],function(e,t,o,n,a,r,s){"use strict";function l(){return o.__awaiter(this,void 0,void 0,function(){var t;return o.__generator(this,function(o){switch(o.label){case 0:return[4,new Promise(function(t,o){e(["modules/clean/sharing/shared_content_link_mount_folder"],t,o)})];case 1:return t=o.sent().mountSharedFolder,[2,t]}})})}function i(e,t,i,c){if(void 0===i&&(i=null),t&&t.sync_ns_id){var d=t.sync_owner_name||t.ownerName,u=function(){return o.__awaiter(this,void 0,void 0,function(){var e;return o.__generator(this,function(o){switch(o.label){case 0:return[4,l()];case 1:return e=o.sent(),e(t.sync_ns_id,t.sync_role,"SYNC_MODAL",!0,i),[2]}})})};s.waitForTTI().then(l),a.SharedContentLinkSyncModal.showInstance(n.createElement(a.SharedContentLinkSyncModal,{activeUserId:e,accessLevel:t.access_level,canRequestToJoin:t.can_request_to_join,expSubgrowthProShareUpsellModalFileAttr:t.exp_subgrowth_pro_share_upsell_modal_file_attr,expUjMassiveBarracuda:c,folderName:t.sync_folder_name,folderSize:t.sync_folder_size,magnetControlLogging:t.magnet_control,outOfQuotaQP:t.sync_out_of_quota_qp,usageRemaining:t.sync_usage_remaining,usageNeeded:t.sync_usage_needed,senderName:t.sync_sender_name,ownerName:d,targetFile:i,previewCallback:null!=i?r.redirect.bind(r,t.sync_preview_url):void 0,previewUrl:t.sync_preview_url,onMountSharedFolder:u,syncNSId:t.sync_ns_id,ownerProfilePhotoUrl:t.ownerProfilePhotoUrl,hideX:"ON"===t.hide_x}))}}Object.defineProperty(t,"__esModule",{value:!0}),t.showSharedContentSyncModal=i}),define("modules/clean/teams/team_assume_user_personal_locked_modal",["require","exports","tslib","external/react","external/react-dom-factories","external/prop-types","modules/clean/react/modal","modules/core/i18n"],function(e,t,o,n,a,r,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n.createElement,c=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._close=function(e){return e.preventDefault(),s.Modal.close()},t._getModalProps=function(){return{title:l._("Personal account not accessible"),acceptButtonText:l._("Close"),dismissButtonText:null,onAccept:t._close}},t}return o.__extends(t,e),t.show=function(e){return s.Modal.showInstance(i(t,e))},t.prototype.render=function(){return i(s.Modal,this._getModalProps(),a.div({className:"team-assume-user-modal"},l._("%(display_name)sâ€™s personal account isnâ€™t managed by the %(team_name)s team, so its contents arenâ€™t accessible to admins.").format({display_name:this.props.displayName,team_name:this.props.teamName})))},t.displayName="AssumePersonalLockedModal",t.propTypes={displayName:r.string,teamName:r.string},t})(n.Component);t.AssumePersonalLockedModal=c});
//# sourceMappingURL=pkg-sharing-sync.min.js-vfl1JHxzo.map