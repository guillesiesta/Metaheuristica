define(["require","exports","modules/clean/ajax","modules/core/browser","modules/clean/sharing/api/client","modules/constants/file_viewer","modules/clean/react/file_viewer/file_utils","modules/clean/viewer","modules/clean/react/paper/paper_log","modules/core/i18n","modules/clean/react/bubble_dropdown_v2","modules/core/notify"],function(e,n,r,t,o,i,a,s,l,d,c,u){"use strict";function _(e){if(p(e)){var n=i.EMBED_TO_PAPER_VARIANT,r=a.getExtension(e.file);if("docx"===r&&"OFF"===n&&!e.sharedLink)return I.Dropdown;if("docx"===r&&e.sharedLink)return I.Button;if("BUTTON"===n)return I.Button;if("DROPDOWN"===n)return I.Dropdown;if("ELLIPSIS"===n)return I.Ellipsis;if("CONTROL"===n)return I.Control}return I.Off}function f(e){return e===I.Dropdown||e===I.Ellipsis?c.BubbleDropdownPositions.BOTTOM_LEFT:c.BubbleDropdownPositions.BOTTOM}function p(e){var n=e.file,r=e.user,o=e.sharedLink;if(!n)return!1;var l=a.getExtension(n);return!!l&&(!!o&&"docx"===l||!o&&g.includes(l))&&!s.Viewer.get_viewer().is_assume_user_session&&!t.is_mobile_or_tablet()&&t.is_supported_paper_browser()&&n.bytes<20971520&&O.includes(i.OPEN_IN_PAPER_VARIANT)&&(!r&&!!o||!!r&&!r.is_paper_disabled)}function A(e){var n=a.getExtension(e),r=d._("Copy to Paper");return"docx"!==n&&(r=d._("Add to Paper doc")),r}function h(e){return"docx"!==a.getExtension(e)}function P(e){if("docx"!==a.getExtension(e))return d._("Build on ideas");switch(i.OPEN_IN_PAPER_CALLOUT_VARIANT){case"VARIANT_1":return d._("Plan your next steps");case"VARIANT_2":return d._("Bring it all together")}return d._("Bring this doc to life")}function b(e){if("docx"!==a.getExtension(e))return d._("Add this file to a Paper doc to take notes and get organized.");switch(i.OPEN_IN_PAPER_CALLOUT_VARIANT){case"VARIANT_1":return d._("Copy to Paper for the ability to create and assign to-dos with due dates.");case"VARIANT_2":return d._("Copy to Paper to make this a doc where you can link other files and media.")}return d._("Copy to Paper and make changes or ask for feedback.")}function T(e){var n=e.file,t=e.sharedLink,o=e.contUrl,i=e.successCallback,a=e.errorCallback,s=e.extension;r.WebRequest({url:"/paper/sign_request_data",data:{path:n.file_id,sharedLink:t,cont_url:o,extension:s},success:i,error:a})}function x(e){var n=window.open("","_blank"),r=function(e){n?t.redirect(e,n):t.redirect(e)},i=function(){n&&n.close(),u.Notify.error(d._("Canâ€™t copy file to Paper"))},s=e.sharedLink?e.sharedLink:"",c=e.file,_=e.user,f=e.sharedLink?"shared_file_actions":"mounted_file_actions",p=a.getExtension(c);l.paperLog(l.PaperEventTypes.CTA_CLICK,{source:f,cta:"open_in_paper_button",extension:p});var A={file:c,sharedLink:s,contUrl:"/create-doc-from-dropbox-file",extension:p,successCallback:r,errorCallback:i};if("docx"===p)T(A);else if(!s&&_){var h=new o.FileShareApiClient({userId:_.id});h.sharedLinkInfo({fileIdOrPath:c.file_id}).then(function(e){e?(A.sharedLink=e.url,A.contUrl="/dropbox-file-embed",T(A)):h.createSharedLink({fileIdOrPath:c.file_id}).then(function(e){A.sharedLink=e.url,A.contUrl="/dropbox-file-embed",T(A)}).catch(function(e){i&&i()})}).catch(function(e){i&&i()})}else A.contUrl="/dropbox-file-embed",T(A)}Object.defineProperty(n,"__esModule",{value:!0});var I,O=["VARIANT_A","VARIANT_B1","VARIANT_B2","VARIANT_B3","VARIANT_B4","ON"],g=["docx"];(function(e){e[e.Off=1]="Off",e[e.Control=2]="Control",e[e.Button=3]="Button",e[e.Dropdown=4]="Dropdown",e[e.Ellipsis=5]="Ellipsis"})(I=n.OpenInPaperButtonVariant||(n.OpenInPaperButtonVariant={})),n.getOpenInPaperButtonVariant=_,n.getCalloutPosition=f,n.shouldShowOpenInPaper=p,n.getCTAText=A,n.shouldShowCTADescription=h,n.getCalloutTitle=P,n.getCalloutMessage=b,n.createPaperAccountAndRedirect=T,n.openFileInPaper=x});
//# sourceMappingURL=utils.min.js-vflWGsUmt.map