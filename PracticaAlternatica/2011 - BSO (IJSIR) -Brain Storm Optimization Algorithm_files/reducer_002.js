define(["require","exports","tslib","modules/constants/comments_panel","modules/clean/react/file_sidebar/store/sidebar/types","modules/clean/react/file_sidebar/store/sidebar/actions"],function(e,t,s,o,a,n){"use strict";function i(e,o){switch(o.type){case a.ActionType.SidebarReset:return s.__assign({},t.INITIAL_STATE,{open:e.open});case a.ActionType.SidebarOpen:return s.__assign({},e,{open:!0,openReason:o.payload.reason});case a.ActionType.SidebarClose:return s.__assign({},e,{open:!1,openReason:void 0});case a.ActionType.SidebarSelectTab:return s.__assign({},e,{activeTab:o.payload.tabName});case a.ActionType.SidebarOpenFile:var n=o.payload,i=n.file,m=n.isVersionHistoryMode,c=n.user;return s.__assign({},e,{openReason:void 0,context:{file:i,isVersionHistoryMode:m,user:c},tabs:{activity:{ready:!c,show:m===!1&&e.tabs.activity.show,count:0},comments:{ready:!1,show:!1,count:0,extra:{commentCount:0,comments2PermissionStatus:e.tabs.comments.extra.comments2PermissionStatus}}}});case"FILE_ACTIVITY|LOADING_END":return s.__assign({},e,{tabs:s.__assign({},e.tabs,{activity:{ready:!0,show:e.context.isVersionHistoryMode===!1&&o.state.enabled,count:0}})});case a.ActionType.SidebarSetCommentState:var r=o.payload,d=r.enabled,b=r.canEnable,u=r.commentCount,y=r.initialized,_=r.ready,p=r.unreadCommentCount,S=e.tabs.comments.ready,T=e.tabs.comments.show,v=S||y&&_,l=!v||!S&&v&&(d||b)||T;return s.__assign({},e,{tabs:s.__assign({},e.tabs,{comments:{ready:v,show:l,count:p,extra:{commentCount:u,comments2PermissionStatus:e.tabs.comments.extra.comments2PermissionStatus}}})});case a.ActionType.SidebarSetComments2State:var C=o.payload.shouldShow;return s.__assign({},e,{tabs:s.__assign({},e.tabs,{comments:{ready:C,show:C,count:0,extra:{commentCount:0,comments2PermissionStatus:e.tabs.comments.extra.comments2PermissionStatus}}})});case a.ActionType.SidebarSetComments2FetchStatus:var g=o.payload.status;return s.__assign({},e,{tabs:s.__assign({},e.tabs,{comments:s.__assign({},e.tabs.comments,{ready:!0,extra:{commentCount:0,comments2PermissionStatus:g}})})})}return e}function m(e,s){void 0===e&&(e=t.INITIAL_STATE);var o=i(e,s);return o.ready=e.ready||o.tabs.activity.ready&&o.tabs.comments.ready,!e.ready&&o.ready&&(o.tabs.comments.show&&!o.tabs.activity.show?o.activeTab="comments":!o.tabs.comments.show&&o.tabs.activity.show&&(o.activeTab="activity"),o.tabs.comments.show&&o.tabs.comments.count>0&&(o.open=!0,o.openReason=o.openReason||"unread_comments",o.activeTab="comments"),"comments"===o.activeTab?n.LegacyCommentsStoreAction.showComments():n.LegacyCommentsStoreAction.hideComments()),o.ready&&o.open&&!o.openReason&&(o.openReason="sticky_state"),!o.open||"comments"!==o.activeTab||"toggle_button"===o.openReason||e.open&&"toggle_button"!==e.openReason&&"comments"===e.activeTab?!e.open||"comments"!==e.activeTab||o.open&&"comments"===o.activeTab||n.LegacyCommentsStoreAction.hideComments():n.LegacyCommentsStoreAction.showComments(),o}Object.defineProperty(t,"__esModule",{value:!0});var c=o.SHOW_COMMENTS_PANEL||!1;t.INITIAL_STATE={activeTab:"comments",open:c,openReason:void 0,ready:!1,context:{file:void 0,isVersionHistoryMode:void 0,user:void 0},tabs:{activity:{ready:!1,show:!1,count:0},comments:{ready:!1,show:!1,count:0,extra:{commentCount:0,comments2PermissionStatus:a.PermissionStatus.NOT_YET_RECEIVED}}}},t.reducer=m});
//# sourceMappingURL=reducer.min.js-vfl7SFJ66.map